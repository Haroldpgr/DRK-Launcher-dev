class v{async getMinecraftVersions(){var e,r;if(!((r=(e=window.api)==null?void 0:e.versions)!=null&&r.list))throw new Error("API de versiones no disponible");return await window.api.versions.list()}async createInstance(e){var r,n;if(!((n=(r=window.api)==null?void 0:r.instance)!=null&&n.createFull))throw new Error("API de creación de instancias no disponible");return await window.api.instance.createFull(e)}async getIncompleteDownloads(){var e,r;return(r=(e=window.api)==null?void 0:e.instance)!=null&&r.getIncompleteDownloads?await window.api.instance.getIncompleteDownloads()||[]:[]}async resumeDownload(e){var r,n;if(!((n=(r=window.api)==null?void 0:r.instance)!=null&&n.resumeDownload))throw new Error("API de reanudación de descargas no disponible");return await window.api.instance.resumeDownload(e)}async getRecentLogs(e=50){var r;if(!window.api)throw new Error("API de Electron no disponible");return await((r=window.api.logs)==null?void 0:r.getRecent(e))||[]}async getLogsByType(e,r=50){var n;if(!window.api)throw new Error("API de Electron no disponible");return await((n=window.api.logs)==null?void 0:n.getByType({type:e,count:r}))||[]}async getLogStats(){var e;if(!window.api)throw new Error("API de Electron no disponible");return await((e=window.api.logs)==null?void 0:e.getStats())||{}}async getAllProgressStatuses(){var e;if(!window.api)throw new Error("API de Electron no disponible");return await((e=window.api.progress)==null?void 0:e.getAllStatuses())||[]}async getOverallProgress(){var e;if(!window.api)throw new Error("API de Electron no disponible");return await((e=window.api.progress)==null?void 0:e.getOverall())||{progress:0,statusText:"No disponible",activeOperations:0}}async getDownloadStatuses(){var e;if(!window.api)throw new Error("API de Electron no disponible");return await((e=window.api.progress)==null?void 0:e.getDownloadStatuses())||[]}async getJavaInstallations(){var e,r;return(e=window.api)!=null&&e.java?await((r=window.api.java)==null?void 0:r.getAll())||[]:[]}async detectJava(){var e,r;return(e=window.api)!=null&&e.java?await((r=window.api.java)==null?void 0:r.detect())||[]:[]}async getRecommendedJavaForVersion(e){return"17"}async getFabricVersions(e){try{const r=await fetch(`https://meta.fabricmc.net/v2/versions/loader/${e}`);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return await r.json()}catch(r){return console.error("Error al obtener versiones de Fabric:",r),[]}}async getForgeVersions(e){try{console.log(`[Forge] Obteniendo versiones para Minecraft ${e}`);const r=["https://maven.minecraftforge.net/net/minecraftforge/forge/maven-metadata.xml","https://files.minecraftforge.net/net/minecraftforge/forge/maven-metadata.xml"];let n=null,a=null;for(const t of r)try{console.log(`[Forge] Intentando URL: ${t}`);const o=await fetch(t,{headers:{"User-Agent":"DRK-Launcher/1.0"}});if(!o.ok){console.warn(`[Forge] URL ${t} devolvió ${o.status}`);continue}if((o.headers.get("content-type")||"").includes("xml")||t.includes(".xml")){const i=await o.text(),d=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("version"),w=[];for(let p=0;p<d.length;p++){const u=d[p].textContent;u&&w.push(u)}n={versioning:{versions:w}},console.log(`[Forge] Datos XML recibidos, ${w.length} versiones encontradas`);break}else{n=await o.json(),console.log("[Forge] Datos JSON recibidos:",n);break}}catch(o){console.warn(`[Forge] Error al obtener desde ${t}:`,o.message),a=o;continue}if(!n){console.log("[Forge] Intentando API alternativa de Forge (promociones)...");try{const t=await fetch("https://files.minecraftforge.net/net/minecraftforge/forge/promotions_slim.json",{headers:{"User-Agent":"DRK-Launcher/1.0"}});if(t.ok){const o=await t.json();console.log("[Forge] Datos de promociones recibidos:",o);const s=[];if(o.promos)for(const i in o.promos)i.startsWith(`${e}-`)&&s.push(i);n={versioning:{versions:s}},console.log(`[Forge] ${s.length} versiones extraídas de promociones`)}}catch(t){console.error("[Forge] Error al obtener promociones:",t)}}if(!n||!n.versioning||!n.versioning.versions||!Array.isArray(n.versioning.versions)){if(console.error("[Forge] No se pudieron obtener versiones de ninguna fuente"),a)throw a;return[]}const c=n.versioning.versions.filter(t=>t&&typeof t=="string"&&t.startsWith(`${e}-`));if(console.log(`[Forge] Versiones compatibles encontradas: ${c.length}`,c),c.length===0)return console.warn(`[Forge] No se encontraron versiones compatibles para Minecraft ${e}`),[];const g=c.sort((t,o)=>{const s=t.split("-")[1]||"";return(o.split("-")[1]||"").localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}).map(t=>({version:t,mcversion:e,type:"release"}));return console.log("[Forge] Versiones procesadas:",g),g}catch(r){return console.error("[Forge] Error al obtener versiones de Forge:",r),[]}}async getQuiltVersions(e){try{const r=await fetch(`https://meta.quiltmc.org/v3/versions/loader/${e}`);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return await r.json()}catch(r){return console.error("Error al obtener versiones de Quilt:",r),[]}}async getNeoForgeVersions(e){try{console.log(`[NeoForge] Obteniendo versiones para Minecraft ${e}`);const r=await fetch("https://maven.neoforged.net/api/maven/versions/releases/net/neoforged/neoforge",{headers:{"User-Agent":"DRK-Launcher/1.0"}});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const n=await r.json();console.log("[NeoForge] Datos recibidos:",n);let a=[];if(Array.isArray(n))a=n;else if(n&&n.versions&&Array.isArray(n.versions))a=n.versions,console.log(`[NeoForge] Versiones extraídas del objeto: ${a.length}`);else return console.error("[NeoForge] Estructura de datos inválida:",n),[];if(a.length>0){const o=a.slice(0,5).map(s=>typeof s=="string"?s:s.version||s.id||String(s));console.log("[NeoForge] Ejemplos de versiones (primeras 5):",o)}const c=a.filter(o=>{let s="";if(typeof o=="string"?s=o:o&&o.version?s=o.version:o&&typeof o=="object"&&(s=o.version||o.id||""),!s)return!1;if(s.startsWith(`${e}-`))return!0;const i=e.split(".");if(i.length>=2){const l=`${i[0]}.${i[1]}`;if(s.startsWith(`${l}.`)||s.startsWith(`${e}-`))return!0}if(i.length>=3){const l=`${i[1]}.${i[2]}`;if(s.startsWith(l))return!0}return!1});if(console.log(`[NeoForge] Versiones compatibles encontradas: ${c.length}`,c),c.length===0)return console.warn(`[NeoForge] No se encontraron versiones compatibles para Minecraft ${e}`),[];const t=c.map(o=>typeof o=="string"?{version:o}:o&&!o.version?{version:o.id||o.name||String(o)}:o).sort((o,s)=>{const i=o.version||"",l=s.version||"",f=i.split("-")[1]||"";return(l.split("-")[1]||"").localeCompare(f,void 0,{numeric:!0,sensitivity:"base"})}).map(o=>({version:o.version||"",mcversion:e,type:o.type||"release"}));return console.log("[NeoForge] Versiones procesadas:",t),t}catch(r){return console.error("[NeoForge] Error al obtener versiones de NeoForge:",r),[]}}}const y=new v;export{y as i};
