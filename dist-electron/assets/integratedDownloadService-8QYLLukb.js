class m{async getMinecraftVersions(){var e,r;if(!((r=(e=window.api)==null?void 0:e.versions)!=null&&r.list))throw new Error("API de versiones no disponible");return await window.api.versions.list()}async createInstance(e){var r,n;if(!((n=(r=window.api)==null?void 0:r.instance)!=null&&n.createFull))throw new Error("API de creación de instancias no disponible");return await window.api.instance.createFull(e)}async getRecentLogs(e=50){var r;if(!window.api)throw new Error("API de Electron no disponible");return await((r=window.api.logs)==null?void 0:r.getRecent(e))||[]}async getLogsByType(e,r=50){var n;if(!window.api)throw new Error("API de Electron no disponible");return await((n=window.api.logs)==null?void 0:n.getByType({type:e,count:r}))||[]}async getLogStats(){var e;if(!window.api)throw new Error("API de Electron no disponible");return await((e=window.api.logs)==null?void 0:e.getStats())||{}}async getAllProgressStatuses(){var e;if(!window.api)throw new Error("API de Electron no disponible");return await((e=window.api.progress)==null?void 0:e.getAllStatuses())||[]}async getOverallProgress(){var e;if(!window.api)throw new Error("API de Electron no disponible");return await((e=window.api.progress)==null?void 0:e.getOverall())||{progress:0,statusText:"No disponible",activeOperations:0}}async getDownloadStatuses(){var e;if(!window.api)throw new Error("API de Electron no disponible");return await((e=window.api.progress)==null?void 0:e.getDownloadStatuses())||[]}async getJavaInstallations(){var e,r;return(e=window.api)!=null&&e.java?await((r=window.api.java)==null?void 0:r.getAll())||[]:[]}async detectJava(){var e,r;return(e=window.api)!=null&&e.java?await((r=window.api.java)==null?void 0:r.detect())||[]:[]}async getRecommendedJavaForVersion(e){return"17"}async getFabricVersions(e){try{const r=await fetch(`https://meta.fabricmc.net/v2/versions/loader/${e}`);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return await r.json()}catch(r){return console.error("Error al obtener versiones de Fabric:",r),[]}}async getForgeVersions(e){try{console.log(`[Forge] Obteniendo versiones para Minecraft ${e}`);const r=["https://maven.minecraftforge.net/net/minecraftforge/forge/maven-metadata.xml","https://files.minecraftforge.net/net/minecraftforge/forge/maven-metadata.xml"];let n=null,i=null;for(const o of r)try{console.log(`[Forge] Intentando URL: ${o}`);const s=await fetch(o,{headers:{"User-Agent":"DRK-Launcher/1.0"}});if(!s.ok){console.warn(`[Forge] URL ${o} devolvió ${s.status}`);continue}if((s.headers.get("content-type")||"").includes("xml")||o.includes(".xml")){const a=await s.text(),w=new DOMParser().parseFromString(a,"text/xml").getElementsByTagName("version"),g=[];for(let d=0;d<w.length;d++){const f=w[d].textContent;f&&g.push(f)}n={versioning:{versions:g}},console.log(`[Forge] Datos XML recibidos, ${g.length} versiones encontradas`);break}else{n=await s.json(),console.log("[Forge] Datos JSON recibidos:",n);break}}catch(s){console.warn(`[Forge] Error al obtener desde ${o}:`,s.message),i=s;continue}if(!n){console.log("[Forge] Intentando API alternativa de Forge (promociones)...");try{const o=await fetch("https://files.minecraftforge.net/net/minecraftforge/forge/promotions_slim.json",{headers:{"User-Agent":"DRK-Launcher/1.0"}});if(o.ok){const s=await o.json();console.log("[Forge] Datos de promociones recibidos:",s);const t=[];if(s.promos)for(const a in s.promos)a.startsWith(`${e}-`)&&t.push(a);n={versioning:{versions:t}},console.log(`[Forge] ${t.length} versiones extraídas de promociones`)}}catch(o){console.error("[Forge] Error al obtener promociones:",o)}}if(!n||!n.versioning||!n.versioning.versions||!Array.isArray(n.versioning.versions)){if(console.error("[Forge] No se pudieron obtener versiones de ninguna fuente"),i)throw i;return[]}const c=n.versioning.versions.filter(o=>o&&typeof o=="string"&&o.startsWith(`${e}-`));if(console.log(`[Forge] Versiones compatibles encontradas: ${c.length}`,c),c.length===0)return console.warn(`[Forge] No se encontraron versiones compatibles para Minecraft ${e}`),[];const l=c.sort((o,s)=>{const t=o.split("-")[1]||"";return(s.split("-")[1]||"").localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})}).map(o=>({version:o,mcversion:e,type:"release"}));return console.log("[Forge] Versiones procesadas:",l),l}catch(r){return console.error("[Forge] Error al obtener versiones de Forge:",r),[]}}async getQuiltVersions(e){try{const r=await fetch(`https://meta.quiltmc.org/v3/versions/loader/${e}`);if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);return await r.json()}catch(r){return console.error("Error al obtener versiones de Quilt:",r),[]}}async getNeoForgeVersions(e){try{console.log(`[NeoForge] Obteniendo versiones para Minecraft ${e}`);const r=await fetch("https://maven.neoforged.net/api/maven/versions/releases/net/neoforged/neoforge",{headers:{"User-Agent":"DRK-Launcher/1.0"}});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const n=await r.json();if(console.log("[NeoForge] Datos recibidos:",n),!Array.isArray(n))return console.error("[NeoForge] Estructura de datos inválida: se esperaba un array",n),[];const i=n.filter(o=>typeof o=="string"?o.startsWith(`${e}-`):o&&o.version?o.version.startsWith(`${e}-`):!1);console.log(`[NeoForge] Versiones compatibles encontradas: ${i.length}`,i);const l=i.map(o=>typeof o=="string"?{version:o}:o).sort((o,s)=>{const t=typeof o=="string"?o:o.version||"",a=typeof s=="string"?s:s.version||"",p=t.split("-")[1]||"";return(a.split("-")[1]||"").localeCompare(p,void 0,{numeric:!0,sensitivity:"base"})}).map(o=>({version:typeof o=="string"?o:o.version||"",mcversion:e,type:o.type||"release"}));return console.log("[NeoForge] Versiones procesadas:",l),l}catch(r){return console.error("[NeoForge] Error al obtener versiones de NeoForge:",r),[]}}}const y=new m;export{y as i};
