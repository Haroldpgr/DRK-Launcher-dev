import{r as i,n as x,j as e,R as H}from"./index-DeqvPa_W.js";import{C as K}from"./Card-DyXnPl_c.js";import{B as b}from"./Button-BALWLHIm.js";class Z{async analyzeModpack(t){var o,c;if(t.startsWith("http")){if(!((o=window.api)!=null&&o.modpackImport))throw new Error("API de importación de modpacks no disponible");return await window.api.modpackImport.analyzeUrl(t)}else{if(!((c=window.api)!=null&&c.modpackImport))throw new Error("API de importación de modpacks no disponible");return await window.api.modpackImport.analyzeFile(t)}}checkCompatibility(t,o){const c=o.filter(s=>s.version===t.mcVersion&&s.loader===t.loader),p=o.filter(s=>s.version!==t.mcVersion||s.loader!==t.loader),u=c.length>0;return{compatible:u,message:u?"Compatible con algunas instancias existentes":"No compatible con ninguna instancia existente",compatibleInstances:c,incompatibleInstances:p}}async importModpack(t,o,c){var p,u;try{if(!((p=window.api)!=null&&p.modpackImport))throw new Error("API de importación de modpacks no disponible");if(!((u=window.api)!=null&&u.instances))throw new Error("API de instancias no disponible");const s=await window.api.instances.list().then(j=>j.find(n=>n.id===o));if(!s)throw new Error("Instancia de destino no encontrada");t.startsWith("http")?await window.api.modpackImport.downloadAndExtractFromUrl(t,s.path,c):await window.api.modpackImport.extractAndInstall(t,s.path)}catch(s){throw console.error("Error al importar modpack:",s),s}}async generateTemporaryUrl(t){var o;if(!((o=window.api)!=null&&o.modpack))throw new Error("API de modpacks no disponible");return await window.api.modpack.createTemporary(t)}async validateModpackUrl(t){try{return(await fetch(t,{method:"HEAD"})).ok}catch{return!1}}}const y=new Z;function _(){const[h,t]=i.useState(""),[o,c]=i.useState("file"),[p,u]=i.useState([]),[s,j]=i.useState(null),[n,C]=i.useState(null),[l,E]=i.useState(null),[X,L]=i.useState(!1),[M,S]=i.useState(!1),[w,$]=i.useState(""),[d,g]=i.useState("import"),[z,k]=i.useState(!1),[P,U]=i.useState(0),[f,B]=i.useState("mods"),[v,R]=i.useState("");i.useEffect(()=>{T()},[]);const T=async()=>{var a;try{if((a=window.api)!=null&&a.instances){const r=await window.api.instances.list();u(r)}}catch(r){console.error("Error al cargar instancias:",r),x.error("Error al cargar instancias")}},N=async a=>{try{const r=await y.analyzeModpack(a);C(r),g("select")}catch(r){console.error("Error al analizar modpack:",r),x.error("Error al analizar el modpack. Verifica que sea un archivo válido.")}},W=()=>{if(!n)return;const a=y.checkCompatibility(n,p);E(a),g("compatibility")},V=async()=>{var a;if(!s||!n){x.error("Por favor selecciona una instancia");return}L(!0),g("importing"),U(0);try{await y.importModpack(h,s,r=>U(r)),x.success(`Modpack importado exitosamente a ${(a=p.find(r=>r.id===s))==null?void 0:a.name}`),g("import"),t(""),C(null),j(null),E(null)}catch(r){console.error("Error al importar modpack:",r),x.error(`Error al importar modpack: ${r instanceof Error?r.message:"Error desconocido"}`)}finally{L(!1)}},O=async()=>{const a=v||h;if(!a){x.error("Por favor selecciona una carpeta o archivo para exportar");return}S(!0);try{const r=await y.generateTemporaryUrl(a);$(r),x.success("URL generada exitosamente")}catch(r){console.error("Error al generar URL:",r),x.error(`Error al generar URL: ${r instanceof Error?r.message:"Error desconocido"}`)}finally{S(!1)}},F=async a=>{var m;const r=(m=a.target.files)==null?void 0:m[0];if(r){const D=r.path||URL.createObjectURL(r);t(D),await N(D)}},I=a=>{a.preventDefault(),a.stopPropagation(),a.type==="dragenter"||a.type==="dragover"?k(!0):a.type==="dragleave"&&k(!1)},G=a=>{if(a.preventDefault(),a.stopPropagation(),k(!1),a.dataTransfer.files&&a.dataTransfer.files[0]){const r=a.dataTransfer.files[0],m=r.path||URL.createObjectURL(r);t(m),N(m)}},q=async()=>{var a,r;if((r=(a=window.api)==null?void 0:a.dialog)!=null&&r.showOpenDialog){const m=await window.api.dialog.showOpenDialog({properties:f==="mod"||f==="resourcepack"||f==="shaderpack"||f==="datapack"?["openFile"]:["openDirectory"],filters:f==="mod"?[{name:"Mods",extensions:["jar","zip"]}]:void 0});!m.canceled&&m.filePaths.length>0&&R(m.filePaths[0])}},A=()=>{d==="select"?g("import"):d==="compatibility"?g("select"):d==="importing"&&g("compatibility")};return e.jsxs(K,{className:"max-w-4xl mx-auto",children:[e.jsx("div",{className:"text-2xl font-bold text-white mb-6",children:"Importar o Exportar Modpack"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"flex items-center justify-center",children:["import","select","compatibility","importing"].map((a,r)=>e.jsxs(H.Fragment,{children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${d===a?"bg-blue-600 text-white":r<["import","select","compatibility","importing"].indexOf(d)?"bg-green-600 text-white":"bg-gray-700 text-gray-300"}`,children:r+1}),r<3&&e.jsx("div",{className:`h-0.5 w-16 ${r<["import","select","compatibility","importing"].indexOf(d)?"bg-green-600":"bg-gray-600"}`})]},a))}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-2",children:[e.jsx("span",{children:"Importar"}),e.jsx("span",{children:"Seleccionar"}),e.jsx("span",{children:"Compatibilidad"}),e.jsx("span",{children:"Importando"})]})]}),d==="import"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("button",{onClick:()=>c("file"),className:`p-6 rounded-xl border-2 transition-all duration-300 ${o==="file"?"border-blue-500 bg-blue-500/10 text-white":"border-gray-700 bg-gray-800/50 text-gray-300 hover:border-gray-600"}`,children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("svg",{className:"w-8 h-8 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsx("span",{className:"font-medium",children:"Desde archivo"}),e.jsx("span",{className:"text-xs text-gray-400 mt-1",children:"ZIP, MRPACK"})]})}),e.jsx("button",{onClick:()=>c("url"),className:`p-6 rounded-xl border-2 transition-all duration-300 ${o==="url"?"border-blue-500 bg-blue-500/10 text-white":"border-gray-700 bg-gray-800/50 text-gray-300 hover:border-gray-600"}`,children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("svg",{className:"w-8 h-8 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),e.jsx("span",{className:"font-medium",children:"Desde URL"}),e.jsx("span",{className:"text-xs text-gray-400 mt-1",children:"Compartido"})]})})]}),o==="file"?e.jsxs("div",{className:`border-2 border-dashed rounded-xl p-8 text-center transition-colors ${z?"border-blue-500 bg-blue-500/10":"border-gray-700 bg-gray-800/30"}`,onDragEnter:I,onDragLeave:I,onDragOver:I,onDrop:G,children:[e.jsx("input",{type:"file",id:"file-upload",className:"hidden",accept:".zip,.mrpack",onChange:F}),e.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[e.jsx("svg",{className:"w-12 h-12 mx-auto mb-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),e.jsx("div",{className:"text-lg font-medium text-white",children:"Arrastra un modpack aquí"}),e.jsx("div",{className:"text-gray-400 mt-2",children:"o haz clic para seleccionar un archivo"}),e.jsx("div",{className:"text-sm text-gray-500 mt-2",children:"ZIP, MRPACK (MAX. 500MB)"})]})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"URL del modpack"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{value:h,onChange:a=>t(a.target.value),placeholder:"https://ejemplo.com/modpack.mrpack",className:"flex-1 p-3 bg-gray-800 border border-gray-700 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx(b,{onClick:async()=>{h&&await N(h)},disabled:!h,children:"Importar"})]})]}),e.jsxs("div",{className:"mt-8 p-6 bg-gray-800/30 rounded-xl border border-gray-700",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Exportar contenido"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Selecciona mods, carpetas o archivos para compartir con otros"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tipo de contenido a exportar"}),e.jsxs("select",{value:f,onChange:a=>B(a.target.value),className:"w-full p-3 bg-gray-800 border border-gray-700 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"mod",children:"Mods individuales"}),e.jsx("option",{value:"mods",children:"Carpeta completa de mods"}),e.jsx("option",{value:"resourcepack",children:"Resourcepacks"}),e.jsx("option",{value:"shaderpack",children:"Shaderpacks"}),e.jsx("option",{value:"datapack",children:"Datapacks"}),e.jsx("option",{value:"instance",children:"Instancia completa"}),e.jsx("option",{value:"custom",children:"Carpeta personalizada"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx("input",{type:"text",value:v,onChange:a=>R(a.target.value),placeholder:"Ruta de la carpeta o archivo a exportar",className:"flex-1 p-3 bg-gray-800 border border-gray-700 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx(b,{onClick:q,variant:"secondary",children:"Explorar"})]}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-3",children:e.jsx(b,{onClick:O,disabled:M||!v,variant:"secondary",className:"w-full sm:w-auto",children:M?"Generando...":`Generar URL temporal (${v?"500MB+":"0MB"})`})})]}),w&&e.jsxs("div",{className:"mt-4 p-3 bg-gray-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm font-mono text-gray-300 truncate",children:w}),e.jsx("button",{onClick:()=>navigator.clipboard.writeText(w),className:"ml-2 px-3 py-1 bg-gray-600 hover:bg-gray-500 rounded text-sm",children:"Copiar"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Esta URL expirará en 24 horas • Soporta archivos de hasta 5GB"})]})]})]}),d==="select"&&n&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gray-800/50 rounded-xl p-4 border border-gray-700",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"bg-gray-700 rounded-lg w-16 h-16 flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:n.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:n.description}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsxs("span",{className:"px-2 py-1 bg-gray-700 text-gray-300 rounded-full text-xs",children:["v",n.version]}),e.jsx("span",{className:"px-2 py-1 bg-blue-900/50 text-blue-300 rounded-full text-xs",children:n.loader}),e.jsxs("span",{className:"px-2 py-1 bg-green-900/50 text-green-300 rounded-full text-xs",children:["MC ",n.mcVersion]}),n.modCount!==void 0&&e.jsxs("span",{className:"px-2 py-1 bg-purple-900/50 text-purple-300 rounded-full text-xs",children:[n.modCount," mods"]})]})]})]})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Seleccionar instancia de destino"}),e.jsx("div",{className:"grid gap-3",children:p.map(a=>e.jsx("div",{onClick:()=>j(a.id),className:`p-4 rounded-xl border cursor-pointer transition-all ${s===a.id?"border-blue-500 bg-blue-500/10":"border-gray-700 bg-gray-800/50 hover:bg-gray-800/70"}`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:a.name}),e.jsxs("div",{className:"text-sm text-gray-400",children:[a.version," ",a.loader&&`• ${a.loader}`]})]}),s===a.id&&e.jsx("svg",{className:"w-6 h-6 text-blue-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})]})},a.id))})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(b,{variant:"secondary",onClick:A,children:"Volver"}),e.jsx(b,{onClick:W,disabled:!s,children:"Verificar compatibilidad"})]})]}),d==="compatibility"&&l&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:`inline-flex items-center justify-center w-16 h-16 rounded-full ${l.compatible?"bg-green-900/20":"bg-red-900/20"}`,children:e.jsx("svg",{className:`w-8 h-8 ${l.compatible?"text-green-500":"text-red-500"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.compatible?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h3",{className:"text-xl font-bold text-white mt-4",children:l.compatible?"¡Compatible!":"Incompatible"}),e.jsx("p",{className:`text-lg ${l.compatible?"text-green-400":"text-red-400"}`,children:l.message})]}),l.compatibleInstances.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Instancias compatibles"}),e.jsx("div",{className:"space-y-3",children:l.compatibleInstances.map(a=>e.jsxs("div",{className:"p-4 rounded-xl border border-gray-700 bg-gray-800/50",children:[e.jsx("div",{className:"font-medium text-white",children:a.name}),e.jsxs("div",{className:"text-sm text-gray-400",children:[a.version," • ",a.loader]})]},a.id))})]}),l.incompatibleInstances.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Instancias incompatibles"}),e.jsx("div",{className:"space-y-3",children:l.incompatibleInstances.map(a=>e.jsxs("div",{className:"p-4 rounded-xl border border-gray-700 bg-gray-800/30",children:[e.jsx("div",{className:"font-medium text-white",children:a.name}),e.jsxs("div",{className:"text-sm text-gray-400",children:[a.version," • ",a.loader," • Incompatible"]})]},a.id))})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(b,{variant:"secondary",onClick:A,children:"Volver"}),e.jsx(b,{onClick:V,children:"Importar a la instancia seleccionada"})]})]}),d==="importing"&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500 mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-white",children:"Importando modpack..."}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Esto puede tardar varios minutos dependiendo del tamaño del modpack"}),e.jsx("div",{className:"mt-6 w-full bg-gray-700 rounded-full h-2.5",children:e.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300 ease-out",style:{width:`${P}%`}})}),e.jsxs("div",{className:"text-sm text-gray-400 mt-2",children:[P,"% completado"]})]})]})}export{_ as default};
