const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/javaDownloadService-GQk1IXeh.js","assets/downloadService-CBReJPPU.js","assets/index-BgiG4dtt.js","assets/index-DX95rM_K.css"])))=>i.map(i=>d[i]);
import{r as s,_ as pe,j as e,p as ce,n as de}from"./index-BgiG4dtt.js";import{instanceProfileService as M}from"./instanceProfileService-CpKmtc6b.js";import{C as ye}from"./CreateInstanceModal-Bq_ydlzI.js";import{A as me}from"./index-Dl_7XBXT.js";import{m as P}from"./proxy-DF74lFUx.js";import{C as ve}from"./ConfirmationModal-DpAY24Rl.js";import"./integratedDownloadService-Cr7ckuFJ.js";import"os";const je=({instance:r,isOpen:p,onClose:w,onSave:A,onDelete:$})=>{const[N,E]=s.useState(""),[d,h]=s.useState(""),[g,b]=s.useState("vanilla"),[ne,oe]=s.useState(""),[k,V]=s.useState(""),[X,Q]=s.useState(""),[I,u]=s.useState(4096),[J,K]=s.useState(1024),[f,Y]=s.useState(8192),[Z,ee]=s.useState(1280),[ae,te]=s.useState(720),[R,H]=s.useState(""),[_,G]=s.useState(null),[L,D]=s.useState(""),[T,re]=s.useState([]),[le,B]=s.useState([]),[y,v]=s.useState(null),[S,C]=s.useState("basic");s.useEffect(()=>{var t;p&&r&&(E(r.name),h(r.version),b(r.loader||"vanilla"),oe(r.loaderVersion||""),V(r.javaPath||""),Q(r.javaId||""),u(r.maxMemory||4096),ee(r.windowWidth||1280),te(r.windowHeight||720),H(((t=r.jvmArgs)==null?void 0:t.join(" "))||""),G(new Date(r.createdAt)),D(r.path),xe(),ue())},[p,r]),s.useEffect(()=>{p&&r&&d&&d!==r.version&&(async()=>{var o,m;try{if((m=(o=window.api)==null?void 0:o.java)!=null&&m.getJavaForMinecraftVersion){const l=await window.api.java.getJavaForMinecraftVersion(d);if(l!==k){V(l);const c=l.match(/java(\d+)/i);if(c&&c[1]){const U=`java${c[1]}`;Q(U)}}}}catch(l){console.error("Error al actualizar la ruta de Java para la nueva versión de Minecraft:",l)}})()},[d,p]);const xe=async()=>{var t,o;try{if((o=(t=window.api)==null?void 0:t.versions)!=null&&o.list){const l=(await window.api.versions.list()).filter(c=>c.type==="release");re(l)}}catch(m){console.error("Error al cargar versiones:",m)}},ue=async()=>{var t,o;try{if((o=(t=window.api)==null?void 0:t.java)!=null&&o.getAll){const m=await window.api.java.getAll();B(m)}else{const{javaDownloadService:m}=await pe(async()=>{const{javaDownloadService:c}=await import("./javaDownloadService-GQk1IXeh.js");return{javaDownloadService:c}},__vite__mapDeps([0,1,2,3])),l=await m.scanForJavaInstallations();B(l.map(c=>({id:c.id,path:c.executable,version:c.version})))}}catch(m){console.error("Error al cargar Java disponibles:",m)}},F=async t=>{var o,m;if(t.preventDefault(),v(null),!N.trim()){v("El nombre de la instancia es obligatorio");return}if(!d){v("Debes seleccionar una versión de Minecraft");return}try{let l=k||void 0,c=X||void 0;if(r&&r.version!==d&&!k)if((m=(o=window.api)==null?void 0:o.java)!=null&&m.getJavaForMinecraftVersion)l=await window.api.java.getJavaForMinecraftVersion(d);else{const{javaDownloadService:W}=await pe(async()=>{const{javaDownloadService:ie}=await import("./javaDownloadService-GQk1IXeh.js");return{javaDownloadService:ie}},__vite__mapDeps([0,1,2,3]));l=await W.getJavaForMinecraftVersion(d)}else l=k||void 0,c=X||void 0;const U={...r,name:N,version:d,loader:g,loaderVersion:ne||void 0,javaPath:l,javaId:c,maxMemory:I||void 0,minMemory:J||void 0,windowWidth:Z,windowHeight:ae,jvmArgs:R?R.split(" ").filter(W=>W.trim()!==""):void 0,path:L};A(U),w()}catch(l){v(`Error al guardar la instancia: ${l.message||"Error desconocido"}`)}},se=()=>{r&&window.confirm(`¿Estás seguro de que quieres eliminar la instancia "${r.name}"? Esta acción no se puede deshacer.`)&&($(r.id),w())};return!p||!r?null:e.jsx(me,{children:e.jsx(P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-gradient-to-br from-gray-900 via-gray-900 to-gray-800 z-50 flex items-center justify-center p-4",children:e.jsx(P.div,{initial:{scale:.95,y:20,opacity:0},animate:{scale:1,y:0,opacity:1},exit:{scale:.95,y:20,opacity:0},transition:{type:"spring",damping:25,stiffness:300},className:"bg-gray-900/95 backdrop-blur-xl border border-gray-700/50 rounded-2xl p-1 w-full max-w-4xl max-h-[90vh] overflow-hidden shadow-2xl shadow-blue-500/10",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-900/20 to-purple-900/20 p-1 rounded-2xl",children:e.jsxs("div",{className:"bg-gray-900 rounded-2xl p-6 max-h-[calc(90vh-1rem)] overflow-y-auto custom-scrollbar",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent",children:["Editar Instancia: ",r.name]}),e.jsx("button",{onClick:w,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded-full transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:F,children:[e.jsxs("div",{className:"inline-flex items-center bg-gray-800/80 border border-gray-700/70 rounded-2xl p-1 text-xs text-gray-300 mb-6",children:[e.jsx("button",{type:"button",onClick:()=>C("basic"),className:`px-4 py-2 rounded-xl transition-all ${S==="basic"?"bg-gradient-to-r from-blue-500 to-indigo-600 text-black shadow-sm":"text-gray-400 hover:text-gray-200"}`,children:"Básico"}),e.jsx("button",{type:"button",onClick:()=>C("java"),className:`ml-1 px-4 py-2 rounded-xl transition-all ${S==="java"?"bg-gradient-to-r from-green-500 to-emerald-600 text-black shadow-sm":"text-gray-400 hover:text-gray-200"}`,children:"Java"}),e.jsx("button",{type:"button",onClick:()=>C("advanced"),className:`ml-1 px-4 py-2 rounded-xl transition-all ${S==="advanced"?"bg-gradient-to-r from-purple-500 to-pink-600 text-black shadow-sm":"text-gray-400 hover:text-gray-200"}`,children:"Avanzado"})]}),y&&e.jsxs("div",{className:"mb-6 p-4 bg-gradient-to-r from-red-900/50 to-red-800/30 border border-red-700/50 rounded-xl text-red-200 flex items-start mb-6",children:[e.jsx("svg",{className:"w-6 h-6 mr-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:y})]}),e.jsxs("div",{className:"space-y-6",children:[S==="basic"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Nombre de la instancia"}),e.jsx("input",{type:"text",value:N,onChange:t=>E(t.target.value),className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Nombre de la instancia"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Versión de Minecraft"}),e.jsxs("select",{value:d,onChange:t=>h(t.target.value),className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:[e.jsx("option",{value:"",children:"Selecciona una versión"}),T.map(t=>e.jsxs("option",{value:t.id,children:[t.id," (",t.type,")"]},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tipo de Loader"}),e.jsxs("select",{value:g,onChange:t=>b(t.target.value),className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:[e.jsx("option",{value:"vanilla",children:"Vanilla"}),e.jsx("option",{value:"forge",children:"Forge"}),e.jsx("option",{value:"fabric",children:"Fabric"}),e.jsx("option",{value:"quilt",children:"Quilt"}),e.jsx("option",{value:"neoforge",children:"NeoForge"})]})]}),g!=="vanilla"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Versión del Loader"}),e.jsx("input",{type:"text",value:ne,onChange:t=>oe(t.target.value),className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"Versión del loader (por ejemplo: 47.2.0)"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Fecha de creación"}),e.jsx("div",{className:"px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-xl text-gray-300",children:(_==null?void 0:_.toLocaleString())||"Fecha desconocida"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Ruta de la instancia"}),e.jsx("div",{className:"px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-xl text-gray-300 font-mono text-sm break-all",children:L})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"ID de la instancia"}),e.jsx("div",{className:"px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-xl text-gray-300 font-mono text-sm",children:r.id})]})]})]}),S==="java"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Versión de Java"}),e.jsxs("select",{value:X,onChange:t=>Q(t.target.value),className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",children:[e.jsx("option",{value:"",children:"Selecciona una versión de Java"}),le.map(t=>e.jsxs("option",{value:t.id,children:["Java ",t.version," - ",t.path]},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Ruta personalizada de Java"}),e.jsx("input",{type:"text",value:k,onChange:t=>V(t.target.value),className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",placeholder:"C:/Program Files/Java/jdk/bin/java.exe"})]}),e.jsxs("div",{className:"bg-gray-800/30 p-4 rounded-xl border border-gray-700/50",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:[e.jsx("svg",{className:"w-5 h-5 inline mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Configuración de Memoria"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Memoria RAM máxima (MB)"}),e.jsxs("span",{className:"text-sm font-medium bg-gradient-to-r from-blue-600 to-purple-600 text-white px-3 py-1 rounded-full min-w-[70px] text-center",children:[I," MB"]})]}),e.jsx("input",{type:"range",min:"1024",max:Math.min(f,16384),value:I,onChange:t=>{const o=parseInt(t.target.value);u(o),K(Math.max(1024,Math.floor(o/4)))},className:"w-full h-2 bg-gradient-to-r from-gray-600 to-gray-700 rounded-lg appearance-none cursor-pointer"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[e.jsx("span",{children:"1GB"}),e.jsxs("span",{children:[Math.min(f,16384),"MB"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Memoria RAM mínima (MB)"}),e.jsxs("span",{className:"text-sm font-medium bg-gradient-to-r from-green-600 to-teal-600 text-white px-3 py-1 rounded-full min-w-[70px] text-center",children:[J," MB"]})]}),e.jsx("input",{type:"range",min:"512",max:I,value:J,onChange:t=>K(parseInt(t.target.value)),className:"w-full h-2 bg-gradient-to-r from-gray-600 to-gray-700 rounded-lg appearance-none cursor-pointer"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[e.jsx("span",{children:"512MB"}),e.jsxs("span",{children:[I,"MB"]})]})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-800/30 p-4 rounded-xl border border-gray-700/50",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Dimensiones de la ventana"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Ancho"}),e.jsx("input",{type:"number",value:Z,onChange:t=>ee(parseInt(t.target.value)||800),className:"w-full px-3 py-2 bg-gray-700/50 border border-gray-600 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",min:"800",max:"3840"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-400 mb-1",children:"Alto"}),e.jsx("input",{type:"number",value:ae,onChange:t=>te(parseInt(t.target.value)||600),className:"w-full px-3 py-2 bg-gray-700/50 border border-gray-600 rounded-lg text-white text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",min:"600",max:"2160"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Argumentos JVM Personalizados"}),e.jsx("textarea",{value:R,onChange:t=>H(t.target.value),className:"w-full px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all min-h-[100px]",placeholder:"-XX:+UseG1GC -Dfml.earlyprogresswindow=false"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:'Separa cada argumento con espacio (por ejemplo: "-XX:+UseG1GC -Xmx4G")'})]})]})]}),S==="advanced"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800/30 p-6 rounded-xl border border-gray-700/50",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-200 mb-4",children:"Configuración Avanzada"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Ruta de la instancia"}),e.jsx("input",{type:"text",value:L,onChange:t=>D(t.target.value),className:"w-full px-4 py-3 bg-gray-700/50 border border-gray-600 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",readOnly:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"ID de Instancia"}),e.jsx("input",{type:"text",value:r.id,className:"w-full px-4 py-3 bg-gray-700/50 border border-gray-600 rounded-xl text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",readOnly:!0})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Perfiles asociados"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ce.getAllProfiles().map(t=>{const o=M.isInstanceLinkedToProfile(r.id,t.username);return e.jsxs("button",{type:"button",onClick:()=>{o?M.unlinkInstanceFromProfile(r.id,t.username):M.linkInstanceToProfile(r.id,t.username)},className:`px-3 py-1 rounded-full text-sm transition-all ${o?"bg-gradient-to-r from-blue-600 to-purple-600 text-white":"bg-gray-700/50 text-gray-300 hover:bg-gray-600/50"}`,children:[t.username," ",o?"✓":""]},t.id)})})]})]}),e.jsxs("div",{className:"bg-red-900/20 p-6 rounded-xl border border-red-700/50",children:[e.jsx("h3",{className:"text-lg font-semibold text-red-200 mb-4",children:"Acciones Peligrosas"}),e.jsx("div",{className:"flex gap-4",children:e.jsxs("button",{type:"button",onClick:se,className:"px-6 py-3 bg-red-700 hover:bg-red-600 text-white rounded-xl transition-colors font-medium flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Eliminar Instancia"]})}),e.jsx("p",{className:"text-sm text-red-400 mt-2",children:"Esta acción eliminará permanentemente la instancia y todos sus archivos."})]})]})]}),e.jsxs("div",{className:"flex justify-between pt-8 border-t border-gray-700/50",children:[e.jsx("button",{type:"button",onClick:se,className:"px-6 py-3 bg-red-700 hover:bg-red-600 text-white rounded-xl transition-colors font-medium",children:"Eliminar"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:w,className:"px-6 py-3 bg-gray-700 hover:bg-gray-600 text-white rounded-xl transition-colors font-medium",children:"Cancelar"}),e.jsxs("button",{type:"submit",className:"px-8 py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 text-white rounded-xl transition-all font-medium flex items-center shadow-lg shadow-blue-500/20",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),"Guardar Cambios"]})]})]})]})]})})})})})};function Ae({onPlay:r}){const[p,w]=s.useState([]),[A,$]=s.useState([]),[N,E]=s.useState([]),[d,h]=s.useState([]),[g,b]=s.useState("all"),[ne,oe]=s.useState(null),[k,V]=s.useState(null),[X,Q]=s.useState(""),[I,u]=s.useState(null),[J,K]=s.useState(""),[f,Y]=s.useState(null),[Z,ee]=s.useState([]),[ae,te]=s.useState(null),[R,H]=s.useState(!1),[_,G]=s.useState(!1),[L,D]=s.useState(""),[T,re]=s.useState("link"),[le,B]=s.useState(!1),[y,v]=s.useState(null),[S,C]=s.useState(!1),[xe,ue]=s.useState({}),F=a=>a.path&&a.path.length>0;s.useEffect(()=>{try{const a=ce.getAllProfiles();if(ee(a),a.length>0){const n=ce.getCurrentProfile();Y(n||a[0].username)}}catch(a){console.error("Error al cargar perfiles:",a),u("Error al cargar perfiles")}},[]);const se=a=>{const n=a.filter(z=>z.type==="owned"),i=a.filter(z=>z.type==="imported"),j=a.filter(z=>z.type==="shared");$(n),E(i),h(j)},t=async()=>{var a;if(!(!((a=window.api)!=null&&a.instances)||!f))try{if(window.api.instances.scanAndRegister)try{const x=await window.api.instances.scanAndRegister();console.log(`Registro automático completado: ${x.count} instancias nuevas registradas`)}catch(x){console.error("Error al escanear y registrar instancias:",x)}const n=await window.api.instances.list();for(const x of n)M.getInstancesForProfile(f).includes(x.id)||M.getProfileForInstance(x.id)||M.linkInstanceToProfile(x.id,f);const i=await window.api.instances.list(),j=M.getInstancesForProfile(f),he=i.filter(x=>j.includes(x.id)).map(x=>{let O="owned";x.source?(x.source.startsWith("http")||x.source.includes("\\")||x.source.includes("/"))&&(O="imported"):O="owned";const ge=M.getPlayTime(x.id,f);return{...x,totalTimePlayed:ge,type:O}});w(he),se(he),u(null)}catch(n){console.error("Error en auto-detección de instancias:",n),u(`Error en auto-detección de instancias: ${n.message||"Error desconocido"}`)}};s.useEffect(()=>{if(!f){w([]),$([]),E([]),h([]);return}t()},[f]);const o=async a=>{const n=p.find(i=>i.id===a);n&&(v(n),C(!0))},m=async()=>{var a;if(y){if(!((a=window.api)!=null&&a.instances)){u("Servicio de instancias no disponible aún. Esperando inicialización..."),C(!1),v(null);return}try{M.unlinkInstance(y.id),await window.api.instances.delete(y.id),de.showNotification({type:"success",title:"Instancia eliminada",message:`La instancia "${y.name}" ha sido eliminada correctamente.`,duration:3e3}),t(),C(!1),v(null)}catch(n){console.error("Error al eliminar instancia:",n),u(`Error al eliminar instancia: ${n.message||"Error desconocido"}`),de.showNotification({type:"error",title:"Error al eliminar",message:`No se pudo eliminar la instancia "${y.name}".`,duration:4e3}),C(!1),v(null)}}},l=async a=>{var n;if(!((n=window.api)!=null&&n.instances)){u("Servicio de instancias no disponible aún. Esperando inicialización...");return}try{await window.api.instances.openFolder(a)}catch(i){console.error("Error al abrir carpeta de instancia:",i),u(`Error al abrir carpeta: ${i.message||"Error desconocido"}`)}},c=async a=>{r(a)},U=a=>{V(a)},W=()=>{V(null)},ie=async a=>{var n,i;try{(i=(n=window.api)==null?void 0:n.instances)!=null&&i.update&&await window.api.instances.update({id:a.id,patch:{name:a.name,version:a.version,loader:a.loader,ramMb:a.maxMemory,javaPath:a.javaPath,windowWidth:a.windowWidth,windowHeight:a.windowHeight,jvmArgs:a.jvmArgs}}),t(),W()}catch(j){console.error("Error al guardar edición:",j),u(`Error al guardar edición: ${j.message||"Error desconocido"}`)}},be=a=>{te(a),H(!0)},fe=async a=>{var n;if(!((n=window.api)!=null&&n.instances)){u("Servicio de instancias no disponible aún. Esperando inicialización...");return}try{let i;a.startsWith("http")?console.log("Importando desde URL:",a):console.log("Importando desde carpeta:",a),t()}catch(i){console.error("Error al importar instancia:",i),u(`Error al importar instancia: ${i.message||"Error desconocido"}`)}},q=(()=>{let a=[];switch(g){case"owned":a=A;break;case"imported":a=N;break;case"shared":a=d;break;case"all":default:a=p;break}return a.filter(n=>n.name.toLowerCase().includes(J.toLowerCase()))})();return I?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-red-900/30 border border-red-700/50 rounded-xl p-4 text-red-200",children:[e.jsx("h2",{className:"text-lg font-bold mb-2",children:"Error"}),e.jsx("p",{children:I})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Instancias de Minecraft"}),e.jsx("p",{className:"text-gray-400",children:"Gestiona tus instancias de juego y perfiles"})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex flex-wrap gap-2 border-b border-gray-700/50",children:[e.jsxs("button",{onClick:()=>b("all"),className:`px-4 py-2 rounded-t-lg text-sm font-medium transition-colors ${g==="all"?"bg-gray-700/50 text-white border-b-2 border-blue-500":"text-gray-400 hover:text-white hover:bg-gray-700/30"}`,children:["Mis Instancias ",e.jsx("span",{className:"bg-gray-600/50 px-2 py-0.5 rounded-full text-xs ml-1",children:p.length})]}),e.jsxs("button",{onClick:()=>b("owned"),className:`px-4 py-2 rounded-t-lg text-sm font-medium transition-colors ${g==="owned"?"bg-gray-700/50 text-white border-b-2 border-blue-500":"text-gray-400 hover:text-white hover:bg-gray-700/30"}`,children:["Creadas ",e.jsx("span",{className:"bg-gray-600/50 px-2 py-0.5 rounded-full text-xs ml-1",children:A.length})]}),e.jsxs("button",{onClick:()=>b("imported"),className:`px-4 py-2 rounded-t-lg text-sm font-medium transition-colors ${g==="imported"?"bg-gray-700/50 text-white border-b-2 border-blue-500":"text-gray-400 hover:text-white hover:bg-gray-700/30"}`,children:["Importadas ",e.jsx("span",{className:"bg-gray-600/50 px-2 py-0.5 rounded-full text-xs ml-1",children:N.length})]}),e.jsxs("button",{onClick:()=>b("shared"),className:`px-4 py-2 rounded-t-lg text-sm font-medium transition-colors ${g==="shared"?"bg-gray-700/50 text-white border-b-2 border-blue-500":"text-gray-400 hover:text-white hover:bg-gray-700/30"}`,children:["Compartidas ",e.jsx("span",{className:"bg-gray-600/50 px-2 py-0.5 rounded-full text-xs ml-1",children:d.length})]})]})}),e.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Perfil de usuario"}),e.jsx("select",{value:f||"",onChange:a=>Y(a.target.value),className:"w-full p-3 bg-gray-800/50 border border-gray-700/50 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500",children:Z.map(a=>e.jsxs("option",{value:a.username,children:[a.username," (",a.type==="microsoft"?"Premium":"No premium",")"]},a.id))})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Buscar instancia"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:J,onChange:a=>K(a.target.value),placeholder:"Buscar por nombre...",className:"w-full p-3 pl-10 bg-gray-800/50 border border-gray-700/50 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})]})]}),e.jsxs("div",{className:"mb-6 flex flex-wrap gap-3 justify-end",children:[e.jsxs("button",{onClick:()=>G(!0),className:"px-6 py-3 bg-gradient-to-r from-yellow-600 to-orange-600 hover:from-yellow-500 hover:to-orange-500 text-white rounded-xl transition-all duration-300 shadow-lg shadow-yellow-500/20 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Importar Instancia"]}),e.jsxs("button",{onClick:()=>B(!0),className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 text-white rounded-xl transition-all duration-300 shadow-lg shadow-blue-500/20 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Crear Instancia"]})]}),q.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"mx-auto w-24 h-24 bg-gray-800/50 rounded-full flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-12 h-12 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("h3",{className:"text-xl font-semibold text-gray-300 mb-2",children:"No hay instancias"}),e.jsx("p",{className:"text-gray-500",children:"Crea una nueva instancia para comenzar a jugar"}),e.jsx("button",{onClick:()=>B(!0),className:"mt-4 px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-500 hover:to-purple-500 text-white rounded-xl transition-all duration-300",children:"Crear Primera Instancia"})]}):e.jsx(P.div,{layout:!0,className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:q.map(a=>e.jsxs(P.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},whileHover:{y:-5},className:"bg-gray-800/50 backdrop-blur-sm border border-gray-700/50 rounded-xl p-4 transition-all duration-300 hover:bg-gray-800/70 hover:border-gray-600/50",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white truncate max-w-[70%]",children:a.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-xs bg-gray-700/50 text-gray-300 px-2 py-1 rounded-full",children:a.version}),a.loader&&e.jsx("span",{className:"text-xs bg-blue-900/50 text-blue-300 px-2 py-1 rounded-full",children:a.loader}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${a.type==="owned"?"bg-green-900/50 text-green-300":a.type==="imported"?"bg-yellow-900/50 text-yellow-300":"bg-purple-900/50 text-purple-300"}`,children:a.type==="owned"?"Creada":a.type==="imported"?"Importada":"Compartida"})]})]}),e.jsx("div",{className:"text-xs text-gray-400",children:new Date(a.createdAt).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"})})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:[e.jsxs("div",{children:["Jugado: ",a.lastPlayed?new Date(a.lastPlayed).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}):"Nunca"]}),e.jsxs("div",{children:["Tiempo total: ",a.totalTimePlayed?(()=>{const n=Math.floor(a.totalTimePlayed/6e4);if(n<60)return`${n} min`;if(n<1440){const i=Math.floor(n/60),j=n%60;return`${i}h ${j}min`}else{const i=Math.floor(n/1440),j=Math.floor(n%1440/60);return`${i}d ${j}h`}})():"0 min"]})]}),!F(a)&&e.jsx("div",{className:"text-xs bg-yellow-900/50 text-yellow-300 px-2 py-1 rounded-full",children:"Pendiente"})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>c(a.id),className:`flex-1 min-w-[70px] px-3 py-2 rounded-lg transition-colors text-sm ${F(a)?"bg-green-600 hover:bg-green-500 text-white":"bg-gray-700 hover:bg-gray-600 text-gray-400 cursor-not-allowed"}`,disabled:!F(a),children:F(a)?"Jugar":"Pendiente"}),e.jsx("button",{onClick:()=>l(a.id),className:"flex-1 min-w-[70px] px-3 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors text-sm",children:"Carpeta"}),e.jsx("button",{onClick:()=>U(a),className:"px-3 py-2 bg-blue-700 hover:bg-blue-600 text-white rounded-lg transition-colors text-sm",title:"Editar Instancia",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>be(a),className:"px-3 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors text-sm",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("button",{onClick:()=>o(a.id),className:"px-3 py-2 bg-red-700 hover:bg-red-600 text-white rounded-lg transition-colors text-sm",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},a.id))}),e.jsx("div",{className:"mt-8 text-center text-gray-500 text-sm",children:e.jsxs("p",{children:[q.length," instancia",q.length!==1?"s":""," encontrada",q.length!==1?"s":""]})})]}),e.jsx(we,{instance:ae,isOpen:R,onClose:()=>H(!1),onPlay:c,onOpenFolder:l}),e.jsx(me,{children:_&&e.jsx(P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs(P.div,{initial:{scale:.95,y:20},animate:{scale:1,y:0},exit:{scale:.95,y:20},className:"bg-gray-800/90 border border-gray-700/50 rounded-xl p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Importar Instancia"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tipo de importación"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{type:"button",onClick:()=>re("link"),className:`flex-1 py-2 rounded-lg border ${T==="link"?"bg-blue-600 border-blue-500 text-white":"bg-gray-700/50 border-gray-600 text-gray-300"}`,children:"Link"}),e.jsx("button",{type:"button",onClick:()=>re("folder"),className:`flex-1 py-2 rounded-lg border ${T==="folder"?"bg-blue-600 border-blue-500 text-white":"bg-gray-700/50 border-gray-600 text-gray-300"}`,children:"Carpeta"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:T==="link"?"URL de la instancia":"Ruta de la carpeta"}),e.jsx("input",{type:"text",value:L,onChange:a=>D(a.target.value),placeholder:T==="link"?"https://ejemplo.com/instancia.zip":"C:/ruta/a/la/carpeta",className:"w-full p-3 bg-gray-700/50 border border-gray-600/50 rounded-xl text-white"})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{onClick:()=>{G(!1),D("")},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded-lg transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:async()=>{if(!L.trim()){u("Por favor, introduce una URL o ruta válida");return}await fe(L),G(!1),D("")},className:"px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white rounded-lg transition-colors",children:"Importar"})]})]})})}),e.jsx(ye,{isOpen:le,onClose:()=>B(!1),onCreated:()=>{t(),de.showNotification({type:"success",title:"Instancia creada",message:"La instancia se está descargando. Aparecerá cuando termine la descarga.",duration:4e3})}}),e.jsx(ve,{isOpen:S,title:"Eliminar Instancia",message:`¿Estás seguro de que quieres eliminar la instancia "${y==null?void 0:y.name}"? Esta acción no se puede deshacer y eliminará permanentemente todos los archivos de la instancia.`,confirmText:"Eliminar",cancelText:"Cancelar",confirmColor:"danger",onConfirm:m,onCancel:()=>{C(!1),v(null)}}),k&&e.jsx(je,{instance:k,isOpen:!!k,onClose:W,onSave:ie,onDelete:o})]})}const we=({instance:r,isOpen:p,onClose:w,onPlay:A,onOpenFolder:$})=>{if(!p||!r)return null;const N=d=>new Date(d).toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),E=d=>{if(!d)return"0 min";const h=Math.floor(d/(1e3*60));if(h<60)return`${h} min`;if(h<1440){const g=Math.floor(h/60),b=h%60;return`${g}h ${b}min`}else{const g=Math.floor(h/1440),b=Math.floor(h%1440/60);return`${g}d ${b}h`}};return e.jsx(me,{children:p&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm",children:e.jsx(P.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"w-full max-w-2xl",children:e.jsx("div",{className:"bg-gray-800/95 border border-gray-700/50 rounded-xl shadow-2xl overflow-hidden backdrop-blur-sm",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:r.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-sm bg-gray-700/50 text-gray-300 px-3 py-1 rounded-full",children:r.version}),r.loader&&e.jsx("span",{className:"text-sm bg-blue-900/50 text-blue-300 px-3 py-1 rounded-full",children:r.loader}),e.jsx("span",{className:"text-sm bg-green-900/50 text-green-300 px-3 py-1 rounded-full",children:"Instancia"})]})]}),e.jsx("button",{onClick:w,className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700/50 rounded-full transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-xl",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Información General"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"ID:"}),e.jsxs("span",{className:"text-white font-mono text-sm",children:[r.id.substring(0,8),"..."]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Versión:"}),e.jsx("span",{className:"text-white",children:r.version})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Loader:"}),e.jsx("span",{className:"text-white",children:r.loader||"Vanilla"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Creada:"}),e.jsx("span",{className:"text-white",children:N(r.createdAt)})]})]})]}),e.jsxs("div",{className:"bg-gray-700/30 p-4 rounded-xl",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Estadísticas de Juego"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Última sesión:"}),e.jsx("span",{className:"text-white",children:r.lastPlayed?N(r.lastPlayed):"Nunca"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Tiempo total:"}),e.jsx("span",{className:"text-white",children:E(r.totalTimePlayed)})]})]})]})]}),e.jsxs("div",{className:"mt-6 bg-gray-700/30 p-4 rounded-xl",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Ubicación"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-gray-300 text-sm font-mono break-all",children:r.path}),e.jsx("button",{onClick:()=>$(r.id),className:"ml-4 px-4 py-2 bg-gray-600 hover:bg-gray-500 text-white rounded-lg transition-colors text-sm",children:"Abrir carpeta"})]})]}),e.jsx("div",{className:"mt-6 flex justify-end space-x-3",children:e.jsxs("button",{onClick:()=>A(r.id),className:"px-6 py-3 bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-500 hover:to-emerald-500 text-white rounded-lg transition-all flex items-center gap-2",children:[e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]}),"Jugar"]})})]})})})})})};export{Ae as default};
