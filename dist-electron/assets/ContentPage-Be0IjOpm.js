var ms=Object.defineProperty;var gs=(N,r,s)=>r in N?ms(N,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):N[r]=s;var ce=(N,r,s)=>gs(N,typeof r!="symbol"?r+"":r,s);import{j as e,r as l,u as ps,a as xs,b as fs,R as Pe,_ as bs}from"./index-DKBsq-gd.js";import{d as ne}from"./downloadService-Bpoq8vX2.js";import{s as te,a as be}from"./uiUtils-D6KspOfL.js";function Ge(N){const r=new Set,s=new Set;return Array.isArray(N)&&N.forEach(o=>{if(o.gameVersion&&(typeof o.gameVersion=="string"?r.add(o.gameVersion):Array.isArray(o.gameVersion)&&o.gameVersion.forEach(p=>{typeof p=="string"&&p.startsWith("1.")&&r.add(p)})),o.gameVersions&&Array.isArray(o.gameVersions)&&o.gameVersions.forEach(p=>{typeof p=="string"&&p.startsWith("1.")&&r.add(p)}),o.modLoader){if(typeof o.modLoader=="string"){const p=o.modLoader.toLowerCase();p.includes("forge")&&!p.includes("neo")?s.add("forge"):p.includes("fabric")?s.add("fabric"):p.includes("quilt")?s.add("quilt"):(p.includes("neoforge")||p.includes("neo-forge"))&&s.add("neoforge")}else if(typeof o.modLoader=="object"){const p=(o.modLoader.name||o.modLoader.type||"").toLowerCase();p.includes("forge")&&!p.includes("neo")?s.add("forge"):p.includes("fabric")?s.add("fabric"):p.includes("quilt")?s.add("quilt"):(p.includes("neoforge")||p.includes("neo-forge"))&&s.add("neoforge")}}o.loaders&&Array.isArray(o.loaders)&&o.loaders.forEach(p=>{const f=(typeof p=="string"?p:p.name||p.type||"").toLowerCase();f.includes("forge")&&!f.includes("neo")?s.add("forge"):f.includes("fabric")?s.add("fabric"):f.includes("quilt")?s.add("quilt"):(f.includes("neoforge")||f.includes("neo-forge"))&&s.add("neoforge")})}),{gameVersions:Array.from(r).sort((o,p)=>{const H=o.split(".").map(Number),f=p.split(".").map(Number);for(let G=0;G<Math.min(H.length,f.length);G++)if(H[G]!==f[G])return f[G]-H[G];return f.length-H.length}),modLoaders:Array.from(s)}}class qe{constructor(){ce(this,"baseUrl","https://api.modrinth.com/v2");ce(this,"userAgent","Drakkar-ModLauncher/1.0.0 (haroldmuller2015@gmail.com)")}async searchProjects(r){try{const s=new URLSearchParams;r.query&&s.append("query",r.query),r.limit&&s.append("limit",r.limit.toString()),r.offset&&s.append("offset",r.offset.toString()),r.version&&r.version.length>0&&s.append("game_versions",JSON.stringify(r.version)),r.loader&&r.loader.length>0&&s.append("loaders",JSON.stringify(r.loader)),r.environment&&s.append("environment",r.environment),r.project_type&&s.append("project_type",r.project_type),r.license&&s.append("license",r.license),r.downloads&&s.append("downloads",JSON.stringify(r.downloads)),r.follows&&s.append("follows",JSON.stringify(r.follows)),r.color&&s.append("color",r.color.toString()),r.show_beta!==void 0&&s.append("show_beta",r.show_beta.toString()),r.show_alpha!==void 0&&s.append("show_alpha",r.show_alpha.toString()),r.facets&&r.facets.length>0&&s.append("facets",JSON.stringify(r.facets)),r.sort&&(s.append("sort",r.sort.field),s.append("sort_direction",r.sort.direction));const o=await fetch(`${this.baseUrl}/search?${s.toString()}`,{headers:{"User-Agent":this.userAgent,Accept:"application/json"}});if(!o.ok)throw new Error(`Modrinth API error: ${o.status} ${o.statusText}`);return(await o.json()).hits}catch(s){throw console.error("Error searching Modrinth projects:",s),s}}async getProject(r){try{const s=await fetch(`${this.baseUrl}/project/${r}`,{headers:{"User-Agent":this.userAgent,Accept:"application/json"}});if(!s.ok)throw new Error(`Modrinth API error: ${s.status} ${s.statusText}`);return await s.json()}catch(s){throw console.error(`Error getting Modrinth project ${r}:`,s),s}}async getProjectVersions(r){try{const s=await fetch(`${this.baseUrl}/project/${r}/version`,{headers:{"User-Agent":this.userAgent,Accept:"application/json"}});if(!s.ok)throw new Error(`Modrinth API error: ${s.status} ${s.statusText}`);return await s.json()}catch(s){throw console.error(`Error getting Modrinth project versions ${r}:`,s),s}}async getCompatibleVersions(r){try{const s=await fetch(`${this.baseUrl}/project/${r.projectId}/version`,{headers:{"User-Agent":this.userAgent,Accept:"application/json"}});if(!s.ok)throw new Error(`Modrinth API error: ${s.status} ${s.statusText}`);return(await s.json()).filter(p=>{const H=!r.mcVersion||p.game_versions.includes(r.mcVersion),f=!r.loader||p.loaders.includes(r.loader);return H&&f})}catch(s){throw console.error(`Error getting compatible versions for project ${r.projectId}:`,s),s}}async getVersion(r){try{const s=await fetch(`${this.baseUrl}/version/${r}`,{headers:{"User-Agent":this.userAgent,Accept:"application/json"}});if(!s.ok)throw new Error(`Modrinth API error: ${s.status} ${s.statusText}`);return await s.json()}catch(s){throw console.error(`Error getting Modrinth version ${r}:`,s),s}}async downloadFile(r,s){try{console.log(`Prepared to download from: ${r} as ${s}`)}catch(o){throw console.error(`Error preparing download for ${s}:`,o),o}}async getFile(r){throw new Error("Modrinth does not have a direct file API endpoint. Get the version containing the file instead.")}}const ke=new qe;class Ue{constructor(){ce(this,"baseUrl","https://api.curseforge.com/v1");ce(this,"apiKey",null);ce(this,"userAgent","Drakkar-ModLauncher/1.0.0 (haroldmuller2015@gmail.com)");this.loadApiKey()}loadApiKey(){try{this.apiKey="$2a$10$8qrneNohy/pV0jJKZVbUuu.kXuDwlRmfhnf4o.7VGEN/bEjXTOPWC"}catch(r){console.warn("Could not load CurseForge API key:",r),this.apiKey=null}}getHeaders(){const r={"User-Agent":this.userAgent,Accept:"application/json","Content-Type":"application/json"};return this.apiKey&&(r["X-API-Key"]=this.apiKey),r}async searchMods(r){try{const s=new URLSearchParams;s.append("gameId",r.gameId.toString()),r.classId&&s.append("classId",r.classId.toString()),r.categoryId&&s.append("categoryId",r.categoryId.toString()),r.gameVersion&&s.append("gameVersion",r.gameVersion),r.searchFilter&&s.append("searchFilter",r.searchFilter),r.modLoaderType!==void 0&&s.append("modLoaderType",r.modLoaderType.toString()),r.gameVersionTypeId&&s.append("gameVersionTypeId",r.gameVersionTypeId.toString()),r.index&&s.append("index",r.index.toString()),r.pageSize&&s.append("pageSize",r.pageSize.toString()),r.sortField&&s.append("sortField",r.sortField.toString()),r.sortOrder&&s.append("sortOrder",r.sortOrder),r.modStatus&&s.append("modStatus",r.modStatus.toString());const o=await fetch(`${this.baseUrl}/mods/search?${s.toString()}`,{headers:this.getHeaders()});if(!o.ok)throw new Error(`CurseForge API error: ${o.status} ${o.statusText}`);return(await o.json()).data}catch(s){throw console.error("Error searching CurseForge mods:",s),s}}async getMod(r){try{const s=await fetch(`${this.baseUrl}/mods/${r}`,{headers:this.getHeaders()});if(!s.ok)throw new Error(`CurseForge API error: ${s.status} ${s.statusText}`);return(await s.json()).data}catch(s){throw console.error(`Error getting CurseForge mod ${r}:`,s),s}}async getModFiles(r){try{const s=await fetch(`${this.baseUrl}/mods/${r}/files`,{headers:this.getHeaders()});if(!s.ok)throw new Error(`CurseForge API error: ${s.status} ${s.statusText}`);return(await s.json()).data}catch(s){throw console.error(`Error getting CurseForge mod files for ${r}:`,s),s}}async getModFile(r,s){try{const o=await fetch(`${this.baseUrl}/mods/${r}/files/${s}`,{headers:this.getHeaders()});if(!o.ok)throw new Error(`CurseForge API error: ${o.status} ${o.statusText}`);return(await o.json()).data}catch(o){throw console.error(`Error getting CurseForge file ${s} for mod ${r}:`,o),o}}async getCompatibleVersions(r,s,o){try{return(await this.getModFiles(r)).filter(H=>{const f=H.gameVersions.includes(s);if(!o)return f;const T={forge:1,fabric:4,quilt:5,neoforge:6}[o.toLowerCase()];return f&&(!T||H.gameVersionTypIds.includes(T))})}catch(p){throw console.error(`Error getting compatible versions for mod ${r}:`,p),p}}async getModDependencies(r){try{const s=await this.getMod(r),o=await this.getModFiles(r),p=[];for(const f of o)f.fileDependencies&&f.fileDependencies.length>0&&p.push(...f.fileDependencies.map(G=>({...G,fileName:f.displayName,fileId:f.id})));const H=p.filter((f,G,T)=>G===T.findIndex(Y=>Y.modId===f.modId));return{modInfo:s,dependencies:H,files:o}}catch(s){throw console.error(`Error getting dependencies for CurseForge mod ${r}:`,s),s}}async getGameVersions(){try{const r=await fetch(`${this.baseUrl}/games/4471/versions`,{headers:this.getHeaders()});if(!r.ok)throw new Error(`CurseForge API error: ${r.status} ${r.statusText}`);return(await r.json()).data.map(p=>p.name)}catch(r){throw console.error("Error getting CurseForge game versions:",r),r}}async getModLoaders(){try{const r=await fetch(`${this.baseUrl}/games/4471/modloader-types`,{headers:this.getHeaders()});if(!r.ok)throw new Error(`CurseForge API error: ${r.status} ${r.statusText}`);return(await r.json()).data}catch(r){throw console.error("Error getting CurseForge mod loaders:",r),r}}async downloadFile(r,s,o){try{ne.downloadFile(r,s,o)}catch(p){throw console.error(`Error initiating download for ${s}:`,p),p}}}const fe=new Ue,ys=({id:N,title:r,description:s,author:o,downloads:p,lastUpdated:H,imageUrl:f,type:G,onDownload:T,onDetails:Y,isDownloading:Q=!1,downloadProgress:ee=0,platform:q})=>{const se=O=>O>=1e6?`${(O/1e6).toFixed(1)}M`:O>=1e3?`${(O/1e3).toFixed(1)}K`:O.toString(),X=O=>new Date(O).toLocaleDateString("es-ES",{year:"numeric",month:"short",day:"numeric"});return e.jsxs("div",{className:"bg-gray-700/50 backdrop-blur-sm rounded-xl overflow-hidden border border-gray-600 hover:bg-gray-700/70 transition-all duration-300 cursor-pointer group",onClick:()=>Y(N),children:[e.jsxs("div",{className:"relative h-40 overflow-hidden",children:[e.jsx("img",{src:f,alt:r,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105",loading:"lazy",onError:O=>{const g=O.target;g.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjMWYyOTM3Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIyNCIgZmlsbD0iIzljYTNhZiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk1pbmVjcmFmdDwvdGV4dD48L3N2Zz4="}}),e.jsx("div",{className:"absolute top-2 right-2 bg-black/70 text-white text-xs px-2 py-1 rounded",children:q==="modrinth"?"Modrinth":"CurseForge"}),e.jsx("div",{className:"absolute bottom-2 left-2 bg-black/70 text-white text-xs px-2 py-1 rounded",children:G})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-medium text-white text-lg mb-2 line-clamp-2 h-12",children:r}),e.jsx("p",{className:"text-sm text-gray-400 mb-3 line-clamp-3 h-12",children:s}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-4",children:[e.jsxs("span",{children:["por ",o]}),e.jsx("span",{children:X(H)})]}),e.jsx("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-4",children:e.jsxs("span",{children:[se(p)," descargas"]})}),Q&&e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"w-full bg-gray-600 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 h-2 rounded-full transition-all duration-300 ease-out",style:{width:`${ee}%`}})}),e.jsxs("div",{className:"text-right text-xs text-gray-400 mt-1",children:[Math.round(ee),"%"]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:O=>{O.stopPropagation(),Y(N)},className:"flex-1 py-2 px-3 bg-gray-600 hover:bg-gray-500 text-gray-200 rounded-lg text-sm font-medium transition-colors",children:"Detalles"}),e.jsx("button",{onClick:O=>{O.stopPropagation(),T()},disabled:Q,className:`flex-1 py-2 px-3 rounded-lg text-sm font-medium transition-all duration-200 ${Q?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white shadow-lg shadow-blue-500/20 hover:shadow-blue-500/30"}`,children:Q?"Descargando...":"Descargar"})]})]})]})};function Re({isOpen:N,onClose:r,title:s,children:o}){return N?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center",onClick:r,children:e.jsxs("div",{className:"bg-gray-900 rounded-lg shadow-xl p-6 w-full max-w-3xl max-h-[90vh] overflow-y-auto",onClick:p=>p.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:s}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-white",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{children:o})]})}):null}const ws=({isOpen:N,onClose:r,project:s,onDownloadComplete:o})=>{const[p,H]=l.useState(""),[f,G]=l.useState("fabric"),[T,Y]=l.useState(""),[Q,ee]=l.useState(!1),[q,se]=l.useState([]),[X,O]=l.useState([]),[g,x]=l.useState(null),[y,n]=l.useState(!0),[E,I]=l.useState(null),[F,D]=l.useState([]);l.useEffect(()=>{N&&s&&Z()},[N,s]);const Z=async()=>{var P;n(!0),I(null);try{if((P=window.api)!=null&&P.instances){const u=await window.api.instances.list();D(u)}const M=await new qe().getProjectVersions(s.id);se(M),O(M),M.length>0&&(H(M[0].version_number),x(M[0]))}catch(M){console.error("Error loading project data:",M),I("Error al cargar los datos del proyecto. Por favor, int√©ntalo de nuevo.")}finally{n(!1)}},_=P=>{H(P);const M=q.find(u=>u.version_number===P);M&&x(M)},oe=async()=>{var P,M;try{if((M=(P=window.api)==null?void 0:P.dialog)!=null&&M.showOpenDialog){const u=await window.api.dialog.showOpenDialog({properties:["openDirectory"],title:"Seleccionar carpeta de destino",buttonLabel:"Seleccionar"});!u.canceled&&u.filePaths.length>0&&(Y(u.filePaths[0]),ee(!0))}}catch(u){console.error("Error selecting custom path:",u),I("Error al seleccionar la carpeta personalizada.")}},U=async()=>{var P;if(!g){I("Por favor, selecciona una versi√≥n para descargar.");return}try{const M=g.files.find($=>$.primary)||g.files[0];if(!M){I("No se encontr√≥ un archivo para descargar.");return}let u="";if(Q&&T)u=T;else{const $=(P=document.querySelector('select[name="instance-select"]'))==null?void 0:P.value;if($&&$!=="custom"){const W=F.find(w=>w.id===$);W&&(u=W.path)}}if(!u){I("Por favor, selecciona una instancia o carpeta personalizada para la descarga.");return}ne.downloadFile(M.url,M.filename,`${s.title} ${g.version_number}`),r(),o&&o()}catch(M){console.error("Error starting download:",M),I("Error al iniciar la descarga. Por favor, int√©ntalo de nuevo.")}};return l.useEffect(()=>{if(q.length>0){const P=q.filter(M=>!f||M.loaders.includes(f));if(O(P),g&&!P.some(M=>M.id===g.id)){const M=P[0]||null;x(M),M&&H(M.version_number)}}},[q,f,g]),e.jsx(Re,{isOpen:N,onClose:r,children:e.jsxs("div",{className:"w-full max-w-2xl bg-gray-800 rounded-xl border border-gray-700 shadow-2xl overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-700",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[s.icon_url&&e.jsx("img",{src:s.icon_url,alt:s.title,className:"w-16 h-16 rounded-lg object-cover border border-gray-600",onError:P=>{const M=P.target;M.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iIzFmMjkzNyIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGZpbGw9IiM5Y2EzYWYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5NPC90ZXh0Pjwvc3ZnPg=="}}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:s.title}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Descargar contenido"})]})]}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx("div",{className:"p-6 max-h-[60vh] overflow-y-auto",children:y?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-blue-500"})}):E?e.jsx("div",{className:"text-red-500 text-center py-8",children:E}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Versi√≥n del Juego:"}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:p,onChange:P=>_(P.target.value),className:"w-full bg-gray-700/80 backdrop-blur-sm border border-gray-600 rounded-xl py-3 px-4 pr-10 text-white focus:outline-none focus:ring-2 focus:ring-primary/50 transition-all duration-200 appearance-none",children:X.map(P=>e.jsxs("option",{value:P.version_number,children:[P.game_versions.join(", ")," - ",P.version_number," (",P.version_type,")"]},P.id))}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-gray-300",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Plataforma (Loader):"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["fabric","forge","quilt","neoforge"].map(P=>e.jsx("button",{onClick:()=>G(P),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${f===P?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-md":"bg-gray-700/70 text-gray-300 hover:bg-gray-600/80"}`,children:P.charAt(0).toUpperCase()+P.slice(1)},P))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Destino de Instalaci√≥n:"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{name:"instance-select",className:"w-full bg-gray-700/80 backdrop-blur-sm border border-gray-600 rounded-xl py-3 px-4 pr-10 text-white focus:outline-none focus:ring-2 focus:ring-primary/50 transition-all duration-200 appearance-none",children:[e.jsx("option",{value:"",children:"Seleccionar instancia..."}),F.map(P=>e.jsxs("option",{value:P.id,children:[P.name," (",P.version,") ",P.loader&&` - ${P.loader}`]},P.id)),e.jsx("option",{value:"custom",children:"Carpeta personalizada..."})]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-gray-300",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]}),Q||e.jsx("button",{onClick:oe,className:"mt-2 w-full bg-gray-700/70 hover:bg-gray-600/80 text-gray-300 py-2.5 px-4 rounded-lg text-sm font-medium transition-colors",children:"Carpeta personalizada..."}),Q&&e.jsx("div",{className:"mt-2 p-3 bg-gray-700/50 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-300 truncate",children:T}),e.jsx("button",{onClick:()=>ee(!1),className:"text-red-500 hover:text-red-400 ml-2",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})})]}),g&&e.jsxs("div",{className:"bg-gray-700/50 p-4 rounded-xl border border-gray-600",children:[e.jsx("h4",{className:"font-medium text-gray-200 mb-2",children:"Detalles del Archivo Seleccionado:"}),e.jsxs("div",{className:"flex items-start space-x-3",children:[s.icon_url&&e.jsx("img",{src:s.icon_url,alt:s.title,className:"w-10 h-10 rounded object-cover border border-gray-500",onError:P=>{const M=P.target;M.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iIzFmMjkzNyIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTAiIGZpbGw9IiM5Y2EzYWYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5GPC90ZXh0Pjwvc3ZnPg=="}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium text-white truncate",children:g.name}),e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["Versi√≥n: ",g.version_number]}),e.jsxs("div",{className:"text-xs text-gray-400",children:[g.loaders.join(", ")," - ",g.game_versions.join(", ")]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[g.downloads," descargas"]})]})]})]})]})}),e.jsxs("div",{className:"p-6 border-t border-gray-700 bg-gray-800/80",children:[E&&e.jsx("div",{className:"text-red-500 text-sm mb-4",children:E}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:r,className:"px-5 py-2.5 rounded-xl bg-gray-700 hover:bg-gray-600 text-gray-200 font-medium transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:U,disabled:y||!g,className:"px-5 py-2.5 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-medium transition-all duration-200 shadow-lg shadow-blue-500/20 disabled:opacity-50",children:"Descargar Contenido"})]})]})]})})},js=({isOpen:N,onClose:r,mod:s,onDownloadComplete:o})=>{const[p,H]=l.useState(""),[f,G]=l.useState(""),[T,Y]=l.useState(""),[Q,ee]=l.useState(!1),[q,se]=l.useState([]),[X,O]=l.useState([]),[g,x]=l.useState(null),[y,n]=l.useState(!0),[E,I]=l.useState(null),[F,D]=l.useState([]),[Z,_]=l.useState("");l.useEffect(()=>{N&&s&&oe()},[N,s]);const oe=async()=>{var h;n(!0),I(null);try{if((h=window.api)!=null&&h.instances){const L=await window.api.instances.list();D(L)}const j=await new Ue().getModFiles(s.id);se(j),O(j),j.length>0&&(x(j[0]),_(j[0].downloadUrl))}catch(j){console.error("Error loading mod data:",j),I("Error al cargar los datos del mod. Por favor, int√©ntalo de nuevo.")}finally{n(!1)}},U=h=>{H(h);const j=q.filter(L=>L.gameVersions.includes(h)&&(!f||f==="forge"&&L.gameVersionTypIds.includes(1)||f==="fabric"&&L.gameVersionTypIds.includes(4)||f==="quilt"&&L.gameVersionTypIds.includes(5)||f==="neoforge"&&L.gameVersionTypIds.includes(6)));O(j),j.length>0&&(x(j[0]),_(j[0].downloadUrl))},P=h=>{G(h);const L={forge:1,fabric:4,quilt:5,neoforge:6}[h],ie=q.filter(R=>!L||R.gameVersionTypIds.includes(L));O(ie),ie.length>0&&(x(ie[0]),_(ie[0].downloadUrl))},M=async()=>{var h,j;try{if((j=(h=window.api)==null?void 0:h.dialog)!=null&&j.showOpenDialog){const L=await window.api.dialog.showOpenDialog({properties:["openDirectory"],title:"Seleccionar carpeta de destino",buttonLabel:"Seleccionar"});!L.canceled&&L.filePaths.length>0&&(Y(L.filePaths[0]),ee(!0))}}catch(L){console.error("Error selecting custom path:",L),I("Error al seleccionar la carpeta personalizada.")}},u=async()=>{var h;if(!g){I("Por favor, selecciona un archivo para descargar.");return}try{let j="";if(Q&&T)j=T;else{const L=(h=document.querySelector('select[name="instance-select"]'))==null?void 0:h.value;if(L&&L!=="custom"){const ie=F.find(R=>R.id===L);ie&&(j=ie.path)}}if(!j){I("Por favor, selecciona una instancia o carpeta personalizada para la descarga.");return}ne.downloadFile(g.downloadUrl,g.fileName,`${s.name} ${g.displayName}`),r(),o&&o()}catch(j){console.error("Error starting download:",j),I("Error al iniciar la descarga. Por favor, int√©ntalo de nuevo.")}},$=()=>{Z&&window.open(Z,"_blank")},W=Array.from(new Set(q.flatMap(h=>h.gameVersions))).sort((h,j)=>j.localeCompare(h)),w=[{id:1,name:"Forge",value:"forge"},{id:4,name:"Fabric",value:"fabric"},{id:5,name:"Quilt",value:"quilt"},{id:6,name:"NeoForge",value:"neoforge"}];return e.jsx(Re,{isOpen:N,onClose:r,children:e.jsxs("div",{className:"w-full max-w-2xl bg-gray-800 rounded-xl border border-gray-700 shadow-2xl overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-700",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[s.logo&&s.logo.url?e.jsx("img",{src:s.logo.url,alt:s.name,className:"w-16 h-16 rounded-lg object-cover border border-gray-600",onError:h=>{const j=h.target;j.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iIzFmMjkzNyIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGZpbGw9IiM5Y2EzYWYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5NPC90ZXh0Pjwvc3ZnPg=="}}):e.jsx("div",{className:"w-16 h-16 rounded-lg bg-gray-700 flex items-center justify-center border border-gray-600",children:e.jsx("span",{className:"text-gray-400 text-xs font-bold",children:"CF"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white",children:s.name}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Descargar contenido"})]})]}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx("div",{className:"p-6 max-h-[60vh] overflow-y-auto",children:y?e.jsx("div",{className:"flex items-center justify-center h-32",children:e.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-blue-500"})}):E?e.jsx("div",{className:"text-red-500 text-center py-8",children:E}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-700/50 p-4 rounded-xl border border-gray-600",children:[e.jsx("h3",{className:"font-medium text-gray-200 mb-2",children:"Opci√≥n Manual:"}),e.jsx("button",{onClick:$,className:"w-full bg-gradient-to-r from-amber-600 to-orange-600 hover:from-amber-700 hover:to-orange-700 text-white py-2.5 px-4 rounded-lg text-sm font-medium transition-all duration-200",children:"Descargar el archivo manualmente"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Versi√≥n del Juego:"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:p,onChange:h=>U(h.target.value),className:"w-full bg-gray-700/80 backdrop-blur-sm border border-gray-600 rounded-xl py-3 px-4 pr-10 text-white focus:outline-none focus:ring-2 focus:ring-primary/50 transition-all duration-200 appearance-none",children:[e.jsx("option",{value:"",children:"Seleccionar versi√≥n..."}),W.map(h=>e.jsx("option",{value:h,children:h},h))]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-gray-300",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Selector de Loader:"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:f,onChange:h=>P(h.target.value),className:"w-full bg-gray-700/80 backdrop-blur-sm border border-gray-600 rounded-xl py-3 px-4 pr-10 text-white focus:outline-none focus:ring-2 focus:ring-primary/50 transition-all duration-200 appearance-none",children:[e.jsx("option",{value:"",children:"Seleccionar loader..."}),w.map(h=>e.jsx("option",{value:h.value,children:h.name},h.id))]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-gray-300",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Destino de Instalaci√≥n:"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{name:"instance-select",className:"w-full bg-gray-700/80 backdrop-blur-sm border border-gray-600 rounded-xl py-3 px-4 pr-10 text-white focus:outline-none focus:ring-2 focus:ring-primary/50 transition-all duration-200 appearance-none",children:[e.jsx("option",{value:"",children:"Seleccionar instancia..."}),F.map(h=>e.jsxs("option",{value:h.id,children:[h.name," (",h.version,") ",h.loader&&` - ${h.loader}`]},h.id)),e.jsx("option",{value:"custom",children:"Carpeta personalizada..."})]}),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-3 text-gray-300",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]}),Q||e.jsx("button",{onClick:M,className:"mt-2 w-full bg-gray-700/70 hover:bg-gray-600/80 text-gray-300 py-2.5 px-4 rounded-lg text-sm font-medium transition-colors",children:"Carpeta personalizada..."}),Q&&e.jsx("div",{className:"mt-2 p-3 bg-gray-700/50 rounded-lg",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-300 truncate",children:T}),e.jsx("button",{onClick:()=>ee(!1),className:"text-red-500 hover:text-red-400 ml-2",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})})]}),g&&e.jsxs("div",{className:"bg-gray-700/50 p-4 rounded-xl border border-gray-600",children:[e.jsx("h4",{className:"font-medium text-gray-200 mb-2",children:"Detalles del Archivo Seleccionado:"}),e.jsxs("div",{className:"flex items-start space-x-3",children:[s.logo&&s.logo.url?e.jsx("img",{src:s.logo.url,alt:s.name,className:"w-10 h-10 rounded object-cover border border-gray-500",onError:h=>{const j=h.target;j.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iIzFmMjkzNyIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTAiIGZpbGw9IiM5Y2EzYWYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5GPC90ZXh0Pjwvc3ZnPg=="}}):e.jsx("div",{className:"w-10 h-10 rounded bg-gray-600 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-400 text-xs",children:"CF"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-sm font-medium text-white truncate",children:g.displayName}),e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["Versi√≥n: ",g.displayName," - ID: ",g.id]}),e.jsx("div",{className:"text-xs text-gray-400",children:g.gameVersions.join(", ")}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[g.downloadCount," descargas ‚Ä¢ ",Math.round(g.fileLength/1024/1024)," MB"]})]})]})]})]})}),e.jsxs("div",{className:"p-6 border-t border-gray-700 bg-gray-800/80",children:[E&&e.jsx("div",{className:"text-red-500 text-sm mb-4",children:E}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:r,className:"px-5 py-2.5 rounded-xl bg-gray-700 hover:bg-gray-600 text-gray-200 font-medium transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:u,disabled:y||!g,className:"px-5 py-2.5 rounded-xl bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white font-medium transition-all duration-200 shadow-lg shadow-blue-500/20 disabled:opacity-50",children:"Descargar"})]})]})]})})};class vs{constructor(){ce(this,"queue",[]);ce(this,"observers",[]);ce(this,"STORAGE_KEY","multipleDownloadQueue_v2");ce(this,"idCounter",0);this.loadFromStorage()}loadFromStorage(){try{const r=localStorage.getItem(this.STORAGE_KEY);if(r){const s=JSON.parse(r);this.queue=s,this.notifyObservers()}}catch(r){console.error("Error cargando cola de descargas m√∫ltiples:",r)}}persistQueue(){try{localStorage.setItem(this.STORAGE_KEY,JSON.stringify(this.queue))}catch(r){console.error("Error guardando cola de descargas m√∫ltiples:",r)}}notifyObservers(){this.observers.forEach(r=>r([...this.queue]))}subscribe(r){return this.observers.push(r),r([...this.queue]),()=>{this.observers=this.observers.filter(s=>s!==r)}}addToQueue(r){const s=r.map(o=>(this.idCounter++,{...o,id:`${o.originalId}-${Date.now()}-${this.idCounter}-${Math.random().toString(36).substr(2,9)}`,originalId:o.originalId,status:"pending",enabled:!0}));return this.queue=[...this.queue,...s],this.persistQueue(),this.notifyObservers(),s}removeFromQueue(r){this.queue=this.queue.filter(s=>s.id!==r),this.persistQueue(),this.notifyObservers()}toggleItemEnabled(r){this.queue=this.queue.map(s=>s.id===r?{...s,enabled:!s.enabled}:s),this.persistQueue(),this.notifyObservers()}clearCompleted(){this.queue=this.queue.filter(r=>r.status!=="completed"),this.persistQueue(),this.notifyObservers()}clearErrors(){this.queue=this.queue.filter(r=>r.status!=="error"),this.persistQueue(),this.notifyObservers()}clearCompletedAndErrors(){this.queue=this.queue.filter(r=>r.status!=="completed"&&r.status!=="error"),this.persistQueue(),this.notifyObservers()}getQueue(){return[...this.queue]}getEnabledItems(){return this.queue.filter(r=>r.enabled&&r.status==="pending")}updateItemStatus(r,s,o,p){this.queue=this.queue.map(H=>H.id===r?{...H,status:s,progress:o,error:p}:H),this.persistQueue(),this.notifyObservers()}}const le=new vs,Ns=Object.freeze(Object.defineProperty({__proto__:null,multipleDownloadQueueService:le},Symbol.toStringTag,{value:"Module"})),ks=({position:N="top-left",onShowHistory:r})=>{const[s,o]=l.useState([]),[p,H]=l.useState([]),[f,G]=l.useState(!1),[T,Y]=l.useState("single"),[Q,ee]=l.useState([]);l.useEffect(()=>{const g=ne.subscribe(x=>{setTimeout(()=>{console.log("Total descargas recibidas:",x.length);const y=x.filter(F=>{var M,u;const D=F.name.toLowerCase(),Z=((M=F.url)==null?void 0:M.toLowerCase())||"",_=((u=F.id)==null?void 0:u.toLowerCase())||"",oe=_.startsWith("content-")||_.startsWith("multiple-"),U=Z.startsWith("content://"),P=D.includes(".jar")&&(D.includes("mod")||D.includes("fabric")||D.includes("forge")||D.includes("quilt")||D.includes("neoforge"))||D.includes("resourcepack")||D.includes("resource-pack")||D.includes("texture")||D.includes("shader")||D.includes("datapack")||D.includes("data-pack")||Z.includes("/mod/")||Z.includes("/resourcepack/")||Z.includes("/shader/")||Z.includes("/datapack/")||Z.includes("modrinth.com")||Z.includes("curseforge.com");return oe||U||P});console.log("Descargas de contenido filtradas:",y.length,y.map(F=>({id:F.id,name:F.name,status:F.status})));const n=y.filter(F=>F.status==="downloading"||F.status==="pending"||F.status==="paused"),E=Date.now()-24*60*60*1e3,I=y.filter(F=>F.status==="completed"&&F.endTime&&F.endTime>E);o(n),H(I)},0)});return()=>{g()}},[]),l.useEffect(()=>{const g=le.subscribe(x=>{ee(x)});return()=>{g()}},[]);const q={"top-right":"top-4 right-4","top-left":"top-4 left-4","bottom-right":"bottom-4 right-4","bottom-left":"bottom-4 left-4"}[N],se=g=>{if(g===0)return"0 Bytes";const x=1024,y=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(g)/Math.log(x));return parseFloat((g/Math.pow(x,n)).toFixed(2))+" "+y[n]},X=g=>{if(g===0)return"0 B/s";const x=1024,y=["B/s","KB/s","MB/s","GB/s"],n=Math.floor(Math.log(g)/Math.log(x));return parseFloat((g/Math.pow(x,n)).toFixed(2))+" "+y[n]},O=async g=>{var x,y,n,E;if(g.path)try{if((y=(x=window.api)==null?void 0:x.shell)!=null&&y.showItemInFolder)await window.api.shell.showItemInFolder(g.path);else if((E=(n=window.api)==null?void 0:n.shell)!=null&&E.openPath){const I=g.path.substring(0,g.path.lastIndexOf("\\")||g.path.lastIndexOf("/"));await window.api.shell.openPath(I)}else console.warn("Shell API not available to open folder")}catch(I){console.error("Error opening folder:",I)}};return e.jsxs("div",{className:`fixed z-[100] ${q} transition-all duration-300`,children:[e.jsx("div",{className:"relative",onClick:()=>G(!f),children:e.jsxs("button",{className:"relative w-14 h-14 rounded-full bg-gradient-to-r from-blue-600 to-indigo-600 shadow-lg flex items-center justify-center hover:from-blue-700 hover:to-indigo-700 transition-all duration-300 group",children:[e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),s.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:s.length})]})}),f&&e.jsxs("div",{className:`absolute mt-2 ${N==="top-left"?"left-0":"-left-96"} w-96 bg-gray-800/90 backdrop-blur-sm rounded-xl shadow-2xl border border-gray-700/80 overflow-hidden z-50`,children:[e.jsxs("div",{className:"p-4 border-b border-gray-700/50",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Progreso de Descargas"}),e.jsxs("div",{className:"flex items-center gap-2",children:[r&&e.jsx("button",{onClick:()=>{G(!1),r()},className:"p-1.5 text-gray-400 hover:text-white transition-colors",title:"Ver historial",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("button",{onClick:()=>G(!1),className:"text-gray-400 hover:text-white",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})]}),e.jsxs("div",{className:"mt-3 flex space-x-1",children:[e.jsx("button",{className:`flex-1 py-1.5 rounded-lg text-sm font-medium transition-all ${T==="single"?"bg-gradient-to-r from-blue-600 to-indigo-600 text-black shadow-sm":"bg-gray-700/70 text-gray-300"}`,onClick:()=>Y("single"),children:"Descargas Complemento"}),e.jsx("button",{className:`flex-1 py-1.5 rounded-lg text-sm font-medium transition-all ${T==="multiple"?"bg-gradient-to-r from-purple-600 to-pink-600 text-black shadow-sm":"bg-gray-700/70 text-gray-300"}`,onClick:()=>Y("multiple"),children:"Descargas M√∫ltiples"})]})]}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto",children:T==="single"?e.jsx("div",{className:"divide-y divide-gray-700/50",children:s.length===0&&p.length===0?e.jsx("div",{className:"p-6 text-center text-gray-400",children:"No hay descargas activas o completadas"}):e.jsxs(e.Fragment,{children:[s.map((g,x)=>e.jsx("div",{className:"p-3 hover:bg-gray-700/50 transition-colors",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-white text-sm truncate",children:g.name}),e.jsxs("div",{className:"mt-1",children:[e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 h-2 rounded-full transition-all duration-300 ease-out",style:{width:`${g.progress}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[e.jsxs("span",{children:[Math.round(g.progress),"%"]}),e.jsx("span",{children:g.downloadedBytes>0&&g.totalBytes>0?`${se(g.downloadedBytes)} / ${se(g.totalBytes)}`:`${se(g.downloadedBytes)}`})]})]}),g.speed>0&&e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:X(g.speed)})]})})},`active-${g.id}-${x}`)),p.map((g,x)=>e.jsx("div",{className:"p-3 hover:bg-gray-700/50 transition-colors border-t border-gray-700/50",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("svg",{className:"w-5 h-5 text-green-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 13l4 4L19 7"})}),e.jsx("h4",{className:"font-medium text-green-400 text-sm truncate",children:g.name})]}),e.jsxs("div",{className:"mt-1",children:[e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-green-500 to-emerald-600 h-2 rounded-full transition-all duration-300 ease-out",style:{width:"100%"}})}),e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"Completado"})]})]}),g.path&&e.jsx("button",{onClick:()=>O(g),className:"ml-2 p-2 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-lg text-white hover:from-blue-700 hover:to-indigo-700 transition-all duration-200 flex-shrink-0",title:"Abrir carpeta",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})})]})},`completed-${g.id}-${x}`))]})}):e.jsx("div",{className:"divide-y divide-gray-700/50",children:Q.length===0?e.jsxs("div",{className:"p-6 text-center text-gray-400",children:[e.jsx("div",{className:"text-4xl mb-3",children:"üì¶"}),e.jsx("h3",{className:"font-medium text-white mb-2",children:"Descargas M√∫ltiples"}),e.jsxs("p",{className:"text-sm",children:["No hay descargas en cola.",e.jsx("br",{}),"Agrega elementos desde la vista de contenido."]})]}):e.jsx(e.Fragment,{children:Q.map((g,x)=>e.jsx("div",{className:`p-3 hover:bg-gray-700/50 transition-colors ${g.enabled?"":"opacity-50"}`,children:e.jsx("div",{className:"flex items-start justify-between gap-2",children:e.jsxs("div",{className:"flex items-start gap-2 flex-1 min-w-0",children:[e.jsx("div",{className:`mt-0.5 w-4 h-4 rounded border-2 flex items-center justify-center flex-shrink-0 ${g.enabled?"bg-gradient-to-r from-green-500 to-emerald-500 border-green-400":"bg-gray-600 border-gray-500"}`,children:g.enabled&&e.jsx("svg",{className:"w-2.5 h-2.5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:`font-medium text-sm truncate ${g.status==="completed"?"text-green-400":g.status==="downloading"?"text-blue-400":g.status==="error"?"text-red-400":g.enabled?"text-white":"text-gray-500"}`,children:g.name}),g.status==="completed"&&e.jsx("svg",{className:"w-4 h-4 text-green-400 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 13l4 4L19 7"})})]}),e.jsxs("div",{className:"flex flex-wrap gap-1.5 mt-1 text-xs text-gray-400",children:[e.jsx("span",{children:g.version}),g.loader&&e.jsxs("span",{children:["‚Ä¢ ",g.loader]}),e.jsxs("span",{children:["‚Ä¢ ",g.platform]})]}),g.status==="downloading"&&g.progress!==void 0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-1.5",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 h-1.5 rounded-full transition-all duration-300 ease-out",style:{width:`${g.progress}%`}})}),e.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[Math.round(g.progress),"%"]})]})]})]})})},`multiple-${g.id}-${x}`))})})}),e.jsx("div",{className:"p-3 bg-gray-900/50 border-t border-gray-700/50 text-xs text-gray-400",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[s.length," activas"]}),e.jsxs("span",{children:[p.length," completadas"]})]})})]})]})},Cs=({selectedContent:N})=>{var q,se,X,O,g,x;const[r,s]=l.useState("description"),[o,p]=l.useState(null),[H,f]=l.useState(!0),[G,T]=l.useState(null);l.useEffect(()=>{(async()=>{var n,E;f(!0),T(null);try{if(N.platform==="modrinth"){const I=await ke.getProject(N.id),F=await ke.getProjectVersions(N.id);p({description:I.description||I.body||N.description,screenshots:((n=I.gallery)==null?void 0:n.map(D=>({url:D.url,title:D.title||`Screenshot ${D.id}`})))||[],changelog:I.changelog||"",versions:F.map(D=>({id:D.id,name:D.version_number||D.name,date:D.date_published||D.updated,type:D.version_type||"release",files:D.files||[],game_versions:D.game_versions||[],loaders:D.loaders||[]}))})}else if(N.platform==="curseforge"){const I=parseInt(N.id,10);if(isNaN(I))throw new Error("ID de mod inv√°lido para CurseForge");const F=await fe.getMod(I),D=await fe.getModFiles(I),Z=new Set;D.forEach(M=>{M.gameVersions&&Array.isArray(M.gameVersions)&&M.gameVersions.forEach(u=>Z.add(u))});const _=Array.from(Z),P=((await fe.getModDependencies(I)).dependencies||[]).map(M=>({id:M.modId,name:M.name||`Dependencia ${M.modId}`,type:M.type,addonId:M.modId,mandatory:M.mandatory||!1}));p({description:F.summary||N.description,screenshots:((E=F.screenshots)==null?void 0:E.map(M=>({url:M.url,title:M.title||`Imagen ${M.id}`})))||[],minecraftVersions:_,comments:[],files:(D==null?void 0:D.map(M=>{var u;return{id:M.id,name:M.displayName||M.fileName,version:((u=M.gameVersions)==null?void 0:u.join(", "))||"N/A",size:`${(M.fileLength/1048576).toFixed(2)} MB`,releaseType:M.releaseType}}))||[],relations:P})}}catch(I){T("Error al cargar los detalles del contenido"),console.error("Error fetching content details:",I)}finally{f(!1)}})()},[N.id,N.platform]);const Y=[{id:"description",label:"Descripci√≥n"},{id:"gallery",label:"Galer√≠a"},{id:"changelog",label:"Registro de cambios"},{id:"versions",label:"Versiones"}],Q=[{id:"description",label:"Descripci√≥n"},{id:"comments",label:"Comentarios"},{id:"files",label:"Archivos"},{id:"gallery",label:"Galer√≠a"},{id:"relations",label:"Relaciones"}],ee=N.platform==="modrinth"?Y:Q;return H?e.jsx("div",{className:"bg-gray-800/50 backdrop-blur-sm rounded-2xl border border-gray-700/50 p-6",children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})})}):G?e.jsx("div",{className:"bg-gray-800/50 backdrop-blur-sm rounded-2xl border border-gray-700/50 p-6",children:e.jsx("div",{className:"text-red-500 text-center py-8",children:G})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex flex-wrap gap-2 border-b border-gray-700/50 pb-4",children:ee.map(y=>e.jsx("button",{className:`px-4 py-2 rounded-lg text-sm font-medium transition-all duration-300 relative ${r===y.id?"text-blue-400 after:absolute after:bottom-0 after:left-0 after:right-0 after:h-0.5 after:bg-blue-400":"text-gray-400 hover:text-gray-200"}`,onClick:()=>s(y.id),children:y.label},y.id))}),e.jsxs("div",{className:"bg-gray-800/50 backdrop-blur-sm rounded-2xl border border-gray-700/50 p-6",children:[r==="description"&&e.jsxs("div",{className:"prose prose-invert max-w-none",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Descripci√≥n"}),e.jsx("div",{className:"text-gray-300 leading-relaxed",dangerouslySetInnerHTML:{__html:((q=o==null?void 0:o.description)==null?void 0:q.replace(/\n/g,"<br>"))||N.description||"No hay descripci√≥n disponible para este contenido."}})]}),r==="gallery"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Galer√≠a de Im√°genes"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:[((o==null?void 0:o.screenshots)||[]).map((y,n)=>e.jsx("div",{className:"aspect-video bg-gradient-to-br from-gray-700 to-gray-800 rounded-xl overflow-hidden border border-gray-600/50 shadow-lg",children:e.jsx("img",{src:y.url,alt:y.title||`Galer√≠a ${n+1}`,className:"w-full h-full object-cover transition-transform duration-300 hover:scale-105",onError:E=>{const I=E.target;I.src=N.imageUrl}})},n)),(((se=o==null?void 0:o.screenshots)==null?void 0:se.length)===0||!(o!=null&&o.screenshots))&&e.jsx("div",{className:"col-span-full text-center text-gray-400 py-10",children:"No hay im√°genes disponibles en la galer√≠a."})]})]}),r==="changelog"&&N.platform==="modrinth"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Registro de Cambios"}),e.jsx("div",{className:"text-gray-300 prose prose-invert max-w-none",dangerouslySetInnerHTML:{__html:((X=o==null?void 0:o.changelog)==null?void 0:X.replace(/\n/g,"<br>").replace(/##/g,'<h4 class="text-lg font-bold text-white mt-4">').replace(/\n-/g,'</h4><ul class="list-disc list-inside ml-4"><li>'))+"</li></ul>"||"No hay registro de cambios disponible."}})]}),r==="versions"&&N.platform==="modrinth"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Versiones Disponibles"}),e.jsxs("div",{className:"space-y-3",children:[((o==null?void 0:o.versions)||[]).map((y,n)=>e.jsxs("div",{className:"p-4 bg-gray-700/30 rounded-xl border border-gray-600/30 hover:bg-gray-700/50 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-bold text-white",children:y.name}),e.jsx("span",{className:"text-sm text-blue-400 bg-blue-400/10 px-2 py-1 rounded capitalize",children:y.type})]}),e.jsxs("div",{className:"text-sm text-gray-400 mt-1",children:["Publicado: ",new Date(y.date).toLocaleDateString("es-ES")]})]},n)),(((O=o==null?void 0:o.versions)==null?void 0:O.length)===0||!o.versions)&&e.jsx("div",{className:"text-gray-400 text-center py-4",children:"No hay versiones disponibles."})]})]}),r==="comments"&&N.platform==="curseforge"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Comentarios"}),e.jsxs("div",{className:"space-y-4",children:[((o==null?void 0:o.comments)||[]).map((y,n)=>e.jsxs("div",{className:"p-4 bg-gray-700/30 rounded-xl border border-gray-600/30",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-blue-500 to-indigo-600 flex items-center justify-center text-white text-sm font-bold mr-3",children:n+1}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:y.username}),e.jsx("div",{className:"text-xs text-gray-400",children:new Date(y.date).toLocaleDateString("es-ES")})]})]}),e.jsx("p",{className:"text-gray-300 ml-11",children:y.content})]},n)),(((g=o==null?void 0:o.comments)==null?void 0:g.length)===0||!o.comments)&&e.jsx("div",{className:"text-gray-400 text-center py-4",children:"No hay comentarios disponibles."})]})]}),r==="files"&&N.platform==="curseforge"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Archivos Disponibles"}),e.jsxs("div",{className:"space-y-3",children:[((o==null?void 0:o.files)||[]).map((y,n)=>e.jsx("div",{className:"p-4 bg-gray-700/30 rounded-xl border border-gray-600/30 hover:bg-gray-700/50 transition-colors",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-white",children:y.name}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Versi√≥n: ",y.version," ¬∑ Tama√±o: ",y.size]})]}),e.jsx("button",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white py-2 px-4 rounded-lg text-sm font-medium transition-all",children:"Descargar"})]})},n)),(((x=o==null?void 0:o.files)==null?void 0:x.length)===0||!o.files)&&e.jsx("div",{className:"text-gray-400 text-center py-4",children:"No hay archivos disponibles."})]})]}),r==="relations"&&N.platform==="curseforge"&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Relaciones"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-blue-400 mb-3",children:"Dependencias Requeridas"}),e.jsxs("div",{className:"space-y-2",children:[((o==null?void 0:o.relations)||[]).filter(y=>y.type===3).map((y,n)=>e.jsxs("div",{className:"p-3 bg-gray-700/30 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"font-medium text-white",children:y.name}),e.jsx("div",{className:"text-sm text-gray-400",children:y.type===1?"Librer√≠a Incrustada":y.type===2?"Dependencia Opcional":y.type===3?"Dependencia Requerida":y.type===4?"Herramienta":y.type===5?"Incompatible":y.type===6?"Incluido":"Dependencia"})]},n)),(o==null?void 0:o.relations)&&o.relations.filter(y=>y.type===3).length===0&&e.jsx("div",{className:"text-gray-400 text-center py-2",children:"No hay dependencias requeridas."})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-emerald-400 mb-3",children:"Dependencias Opcionales"}),e.jsxs("div",{className:"space-y-2",children:[((o==null?void 0:o.relations)||[]).filter(y=>y.type===2).map((y,n)=>e.jsxs("div",{className:"p-3 bg-gray-700/30 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"font-medium text-white",children:y.name}),e.jsx("div",{className:"text-sm text-gray-400",children:y.type===1?"Librer√≠a Incrustada":y.type===2?"Dependencia Opcional":y.type===3?"Dependencia Requerida":y.type===4?"Herramienta":y.type===5?"Incompatible":y.type===6?"Incluido":"Sugerencia"})]},n)),(o==null?void 0:o.relations)&&o.relations.filter(y=>y.type===2).length===0&&e.jsx("div",{className:"text-gray-400 text-center py-2",children:"No hay dependencias opcionales."})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-amber-400 mb-3",children:"Otras Relaciones"}),e.jsxs("div",{className:"space-y-2",children:[((o==null?void 0:o.relations)||[]).filter(y=>![2,3].includes(y.type)).map((y,n)=>e.jsxs("div",{className:"p-3 bg-gray-700/30 rounded-lg border border-gray-600/30",children:[e.jsx("div",{className:"font-medium text-white",children:y.name}),e.jsx("div",{className:"text-sm text-gray-400",children:y.type===1?"Librer√≠a Incrustada":y.type===4?"Herramienta":y.type===5?"Incompatible":y.type===6?"Incluido":"Relaci√≥n"})]},n)),(o==null?void 0:o.relations)&&o.relations.filter(y=>![2,3].includes(y.type)).length===0&&e.jsx("div",{className:"text-gray-400 text-center py-2",children:"No hay otras relaciones."})]})]})]})]})]})]})},Ss=({children:N,content:r,position:s="top",delay:o=500})=>{const[p,H]=l.useState(!1),[f,G]=l.useState(null),T=()=>{const ee=setTimeout(()=>{H(!0)},o);G(ee)},Y=()=>{f&&clearTimeout(f),H(!1)},Q={top:"bottom-full left-1/2 transform -translate-x-1/2 mb-2",right:"top-1/2 left-full transform -translate-y-1/2 ml-2",bottom:"top-full left-1/2 transform -translate-x-1/2 mt-2",left:"top-1/2 right-full transform -translate-y-1/2 mr-2"}[s];return e.jsxs("div",{className:"relative inline-block",children:[e.jsx("div",{onMouseEnter:T,onMouseLeave:Y,onFocus:T,onBlur:Y,className:"cursor-pointer",children:N}),p&&e.jsx("div",{className:`absolute z-50 ${Q} w-64 p-3 bg-gray-900 text-white text-sm rounded-lg shadow-lg border border-gray-700/80`,children:e.jsxs("div",{className:"relative",children:[r,e.jsx("div",{className:`absolute w-0 h-0 border-8 ${s==="top"?"border-t-gray-900 border-r-gray-900/0 border-l-gray-900/0 border-b-gray-900/0 top-full left-1/2 transform -translate-x-1/2":s==="bottom"?"border-b-gray-900 border-r-gray-900/0 border-l-gray-900/0 border-t-gray-900/0 bottom-full left-1/2 transform -translate-x-1/2":s==="left"?"border-l-gray-900 border-t-gray-900/0 border-b-gray-900/0 border-r-gray-900/0 right-full top-1/2 transform -translate-y-1/2":"border-r-gray-900 border-t-gray-900/0 border-b-gray-900/0 border-l-gray-900/0 left-full top-1/2 transform -translate-y-1/2"}`})]})})]})},Ms=({isOpen:N,onClose:r,onSingleDownload:s,onMultipleDownload:o})=>N?e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:e.jsx("div",{className:"bg-gray-800/90 backdrop-blur-xl rounded-2xl border border-gray-700/80 shadow-2xl w-full max-w-md transform transition-all duration-300 scale-100",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Seleccionar Tipo de Descarga"}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("button",{onClick:()=>{s(),r()},className:"w-full bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white font-semibold py-4 px-6 rounded-xl transition-all duration-200 transform hover:scale-[1.02] focus:outline-none focus:ring-2 focus:ring-blue-500/50 shadow-lg shadow-blue-500/20 hover:shadow-blue-500/30",children:[e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Descarga Individual"]}),e.jsx("p",{className:"text-sm text-blue-200 mt-1",children:"Descargar un solo contenido con configuraci√≥n espec√≠fica"})]}),e.jsxs("button",{onClick:()=>{o(),r()},className:"w-full bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white font-semibold py-4 px-6 rounded-xl transition-all duration-200 transform hover:scale-[1.02] focus:outline-none focus:ring-2 focus:ring-purple-500/50 shadow-lg shadow-purple-500/20 hover:shadow-purple-500/30",children:[e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Descarga M√∫ltiple"]}),e.jsx("p",{className:"text-sm text-purple-200 mt-1",children:"Agregar m√∫ltiples contenidos a una cola de descargas"})]})]}),e.jsx("div",{className:"mt-6 text-center text-sm text-gray-400",children:"Selecciona el modo de descarga que mejor se adapte a tus necesidades"})]})})}):null,Ls=({isOpen:N,onClose:r,contentItem:s,availableVersions:o=[],availableLoaders:p=[],onDownloadStart:H})=>{const[f,G]=l.useState(""),[T,Y]=l.useState(""),[Q,ee]=l.useState(""),[q,se]=l.useState(o),[X,O]=l.useState(p),[g,x]=l.useState(p),[y,n]=l.useState(!1),[E,I]=l.useState(!1),[F,D]=l.useState(!1),[Z,_]=l.useState(!1);l.useEffect(()=>{se(o)},[o]),l.useEffect(()=>{O(p),f||x(p)},[p]),l.useEffect(()=>{(async()=>{if(!f||s.type!=="mods"&&s.type!=="modpacks"){x(X);return}_(!0);const P=[],M=["forge","fabric","quilt","neoforge"];for(const u of M)try{let $=[];s.platform==="modrinth"?($=await window.api.modrinth.getCompatibleVersions({projectId:s.id,mcVersion:f,loader:u}),Array.isArray($)&&$.length>0&&$.filter(w=>{const h=w.game_versions&&Array.isArray(w.game_versions)&&w.game_versions.includes(f),j=w.loaders&&Array.isArray(w.loaders)&&w.loaders.includes(u);return h&&j}).length>0&&P.push(u)):s.platform==="curseforge"&&($=await window.api.curseforge.getCompatibleVersions({projectId:s.id,mcVersion:f,loader:u}),Array.isArray($)&&$.length>0&&$.filter(w=>{const h=w.game_versions&&Array.isArray(w.game_versions)&&w.game_versions.includes(f)||w.gameVersion===f,j=w.loaders&&Array.isArray(w.loaders)&&w.loaders.includes(u)||w.modLoader&&w.modLoader.toLowerCase()===u.toLowerCase();return h&&j}).length>0&&P.push(u))}catch($){console.error(`Error verificando loader ${u}:`,$)}x(P),_(!1),T&&!P.includes(T)&&Y("")})()},[f,s.id,s.platform,s.type]);const oe=async()=>{if(!f||s.type==="mods"&&!T||!Q&&!y){await te("Campos requeridos","Por favor, completa todos los campos requeridos","warning");return}H({id:s.id,name:s.title,version:f,loader:T,targetPath:Q,platform:s.platform}),r()};return N?e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:e.jsx("div",{className:"bg-gray-800/90 backdrop-blur-xl rounded-2xl border border-gray-700/80 shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Descarga Individual"}),e.jsxs("p",{className:"text-gray-400",children:['Configura la descarga de "',s.title,'"']})]}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsx("div",{className:"md:col-span-1 flex justify-center",children:e.jsx("img",{src:s.imageUrl,alt:s.title,className:"w-32 h-32 object-cover rounded-xl border border-gray-600 shadow-lg",onError:U=>{const P=U.target;P.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjMWYyOTM3Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxOCIgZmlsbD0iIzljYTNhZiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk08L3RleHQ+PC9zdmc+"}})}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:s.title}),e.jsx("p",{className:"text-gray-300 mb-4",children:s.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Autor"}),e.jsx("p",{className:"text-white",children:s.author})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Tipo"}),e.jsx("p",{className:"text-white capitalize",children:s.type})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Descargas"}),e.jsx("p",{className:"text-white",children:s.downloads.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Plataforma"}),e.jsx("p",{className:"text-purple-400 capitalize",children:s.platform})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Versi√≥n de Minecraft"}),e.jsxs("span",{className:"text-xs text-gray-400",children:[q.length," disponibles"]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",className:`w-full bg-gray-700/80 backdrop-blur-sm border border-gray-600 rounded-xl py-3 px-4 text-left flex justify-between items-center ${f?"text-white":"text-gray-400"}`,onClick:()=>I(!E),children:[e.jsx("span",{children:f||"Selecciona una versi√≥n..."}),e.jsx("svg",{className:`w-5 h-5 transition-transform duration-200 ${E?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),E&&e.jsx("div",{className:"absolute z-10 w-full mt-2 bg-gray-700/90 backdrop-blur-sm border border-gray-600 rounded-xl shadow-lg max-h-60 overflow-y-auto",children:q.length>0?q.map(U=>e.jsxs("div",{className:`flex items-center px-4 py-3 cursor-pointer hover:bg-gray-600/50 ${f===U?"bg-blue-600/30":""}`,onClick:async()=>{G(U),I(!1),Y("")},children:[e.jsx("span",{className:"mr-3",children:f===U?e.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):e.jsx("div",{className:"w-5 h-5 border border-gray-400 rounded"})}),e.jsx("span",{className:f===U?"text-white font-medium":"text-gray-300",children:U})]},U)):e.jsx("div",{className:"px-4 py-3 text-gray-400",children:"No hay versiones disponibles"})})]})]}),(s.type==="mods"||s.type==="modpacks")&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Loader Compatible"}),e.jsx("span",{className:"text-xs text-gray-400",children:Z?"Verificando...":`${g.length} disponibles`})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",className:`w-full bg-gray-700/80 backdrop-blur-sm border border-gray-600 rounded-xl py-3 px-4 text-left flex justify-between items-center ${T?"text-white":"text-gray-400"}`,onClick:()=>D(!F),children:[e.jsx("span",{children:T?T.charAt(0).toUpperCase()+T.slice(1):"Selecciona un loader..."}),e.jsx("svg",{className:`w-5 h-5 transition-transform duration-200 ${F?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),F&&e.jsx("div",{className:"absolute z-10 w-full mt-2 bg-gray-700/90 backdrop-blur-sm border border-gray-600 rounded-xl shadow-lg",children:Z?e.jsx("div",{className:"px-4 py-3 text-gray-400 text-center",children:"Verificando loaders disponibles..."}):g.length>0?g.map(U=>e.jsxs("div",{className:`flex items-center px-4 py-3 cursor-pointer hover:bg-gray-600/50 ${T===U?"bg-blue-600/30":""}`,onClick:()=>{Y(U),D(!1)},children:[e.jsx("span",{className:"mr-3",children:T===U?e.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):e.jsx("div",{className:"w-5 h-5 border border-gray-400 rounded"})}),e.jsx("span",{className:T===U?"text-white font-medium":"text-gray-300",children:U.charAt(0).toUpperCase()+U.slice(1)})]},U)):f?e.jsxs("div",{className:"px-4 py-3 text-gray-400",children:["No hay loaders disponibles para ",f]}):e.jsx("div",{className:"px-4 py-3 text-gray-400",children:"Selecciona una versi√≥n primero"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Destino de la descarga"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"radio",id:"folder-custom",checked:y,onChange:()=>n(!0),className:"w-4 h-4 text-blue-600 bg-gray-700 border-gray-600 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"folder-custom",className:"ml-2 text-gray-300",children:"Carpeta personalizada"})]}),y&&e.jsxs("div",{className:"ml-6 space-y-2",children:[e.jsx("input",{type:"text",value:Q,onChange:U=>ee(U.target.value),placeholder:"Selecciona una carpeta...",className:"w-full bg-gray-700/80 backdrop-blur-sm border border-gray-600 rounded-xl py-3 px-4 text-white focus:outline-none focus:ring-2 focus:ring-blue-500/50 transition-all duration-200"}),e.jsxs("button",{className:"w-full bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white py-3 px-4 rounded-xl font-medium transition-all duration-200",onClick:async()=>{var U,P;try{if((P=(U=window.api)==null?void 0:U.dialog)!=null&&P.showOpenDialog){const M=await window.api.dialog.showOpenDialog({properties:["openDirectory"],title:"Seleccionar carpeta de destino",buttonLabel:"Seleccionar"});!M.canceled&&M.filePaths.length>0&&ee(M.filePaths[0])}else await te("Funci√≥n no disponible","La funci√≥n de selecci√≥n de carpetas no est√° disponible.","warning")}catch(M){console.error("Error al seleccionar carpeta:",M),await te("Error","Error al seleccionar la carpeta: "+M.message,"error")}},children:[e.jsx("svg",{className:"w-5 h-5 inline mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),"Seleccionar carpeta"]})]})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx("button",{onClick:oe,disabled:!f||s.type==="mods"&&!T||!Q&&!y,className:"w-full relative overflow-hidden rounded-xl transition-all duration-300 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-semibold py-4 shadow-lg shadow-blue-500/20 hover:shadow-blue-500/30",children:"Iniciar Descarga Individual"})})]})]})})}):null},Is=({isOpen:N,onClose:r,contentItems:s,availableVersions:o=[],availableLoaders:p=[],onAddToQueue:H})=>{const[f,G]=l.useState(new Set),[T,Y]=l.useState({}),[Q,ee]=l.useState({}),[q,se]=l.useState({}),[X,O]=l.useState(""),[g,x]=l.useState(!1),[y,n]=l.useState(!1),[E,I]=l.useState(new Set),[F,D]=l.useState(new Set),[Z,_]=l.useState({});l.useEffect(()=>{if(N){const u={},$={},W={};s.forEach(w=>{const h=o.length>0?o:w.minecraftVersions||[],j=p.length>0?p:w.type==="mods"||w.type==="modpacks"?["forge","fabric","quilt","neoforge"]:[];u[w.id]={version:h[0]||"",loader:"",targetPath:X||"",availableVersions:h,availableLoaders:j,filteredLoaders:j},$[w.id]=!1,W[w.id]=!1}),Y(u),ee($),se(W)}},[N,s,X,o,p]),l.useEffect(()=>{const u=$=>{$.target.closest(".dropdown-container")||(ee({}),se({}))};if(N)return document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[N]);const oe=u=>{const $=new Set(f);$.has(u)?$.delete(u):$.add(u),G($)},U=(u,$)=>{Y(W=>({...W,[u]:{...W[u],...$}}))},P=async(u,$)=>{const W=s.find(j=>j.id===u);if(!W||W.type!=="mods"&&W.type!=="modpacks"||!$)return;_(j=>({...j,[u]:!0}));const w=[],h=["forge","fabric","quilt","neoforge"];for(const j of h)try{let L=[];W.platform==="modrinth"?(L=await window.api.modrinth.getCompatibleVersions({projectId:W.id,mcVersion:$,loader:j}),Array.isArray(L)&&L.length>0&&L.filter(R=>{const ue=R.game_versions&&Array.isArray(R.game_versions)&&R.game_versions.includes($),J=R.loaders&&Array.isArray(R.loaders)&&R.loaders.includes(j);return ue&&J}).length>0&&w.push(j)):W.platform==="curseforge"&&(L=await window.api.curseforge.getCompatibleVersions({projectId:W.id,mcVersion:$,loader:j}),Array.isArray(L)&&L.length>0&&L.filter(R=>{const ue=R.game_versions&&Array.isArray(R.game_versions)&&R.game_versions.includes($)||R.gameVersion===$,J=R.loaders&&Array.isArray(R.loaders)&&R.loaders.includes(j)||R.modLoader&&R.modLoader.toLowerCase()===j.toLowerCase();return ue&&J}).length>0&&w.push(j))}catch(L){console.error(`Error verificando loader ${j} para ${W.title}:`,L)}Y(j=>({...j,[u]:{...j[u],filteredLoaders:w,loader:j[u].loader&&w.includes(j[u].loader||"")?j[u].loader:""}})),_(j=>({...j,[u]:!1}))},M=async()=>{n(!0);const u=[],$=[];for(const W of f){const w=s.find(L=>L.id===W),h=T[W];if(!w||!h)continue;let j="mod";w.type==="resourcepacks"?j="resourcepack":w.type==="shaders"?j="shader":w.type==="datapacks"?j="datapack":w.type==="modpacks"&&(j="modpack");try{let L=[];if(w.platform==="modrinth"?(L=await window.api.modrinth.getCompatibleVersions({projectId:w.id,mcVersion:h.version,loader:h.loader||void 0}),Array.isArray(L)&&L.length>0&&L.filter(R=>{const ue=R.game_versions&&Array.isArray(R.game_versions)&&R.game_versions.includes(h.version),J=!h.loader||R.loaders&&Array.isArray(R.loaders)&&R.loaders.includes(h.loader);return ue&&J}).length===0&&(L=[])):w.platform==="curseforge"&&(L=await window.api.curseforge.getCompatibleVersions({projectId:w.id,mcVersion:h.version,loader:h.loader||void 0}),Array.isArray(L)&&L.length>0&&L.filter(R=>{const ue=R.game_versions&&Array.isArray(R.game_versions)&&R.game_versions.includes(h.version)||R.gameVersion===h.version,J=!h.loader||R.loaders&&Array.isArray(R.loaders)&&R.loaders.includes(h.loader)||R.modLoader&&R.modLoader.toLowerCase()===h.loader.toLowerCase();return ue&&J}).length===0&&(L=[])),!L||L.length===0){const ie=h.loader?` y ${h.loader}`:"";$.push({name:w.title,reason:`No hay versiones disponibles para ${h.version}${ie}`});continue}u.push({originalId:w.id,name:w.title,version:h.version,loader:h.loader,targetPath:h.targetPath,platform:w.platform,contentType:j})}catch(L){console.error(`Error validando ${w.title}:`,L),$.push({name:w.title,reason:L instanceof Error?L.message:"Error al verificar compatibilidad"})}}if(n(!1),$.length>0){const W=$.map(w=>`‚Ä¢ ${w.name}: ${w.reason}`).join(`
`);await te("Items no agregados",`Los siguientes items no se pudieron agregar a la cola:

${W}

${u.length>0?"Los items v√°lidos se agregar√°n a la cola.":"Por favor, selecciona versiones y loaders compatibles."}`,"warning")}u.length!==0&&u.length>0&&(D(new Set(f)),u.forEach((W,w)=>{setTimeout(()=>{setTimeout(()=>{D(h=>{const j=new Set(h);return j.delete(W.originalId),j})},600)},w*50)}),setTimeout(()=>{H(u),G(W=>{const w=new Set(W);return u.forEach(h=>w.delete(h.originalId)),w}),$.length===0&&r()},u.length*50+300))};return N?e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
        @keyframes slideOut {
          0% {
            opacity: 1;
            transform: translateX(0) scale(1);
          }
          50% {
            opacity: 0.7;
            transform: translateX(20px) scale(0.98);
          }
          100% {
            opacity: 0;
            transform: translateX(100px) scale(0.95);
          }
        }
      `}),e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-gray-800/90 backdrop-blur-xl rounded-2xl border border-gray-700/80 shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-gray-700/50",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Descarga M√∫ltiple"}),e.jsx("p",{className:"text-gray-400 mt-1",children:"Selecciona m√∫ltiples items para descargar en cola"})]}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-4 bg-gradient-to-br from-gray-700/40 to-gray-800/40 rounded-xl border border-gray-600/50 shadow-lg",children:[e.jsxs("h3",{className:"font-semibold text-white mb-4 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})}),"Configuraci√≥n Global"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Carpeta de destino global"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:X,onChange:u=>O(u.target.value),placeholder:"Ruta predeterminada para descargas...",className:"flex-1 bg-gray-700/80 backdrop-blur-sm border border-gray-600 rounded-xl py-3 px-4 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 transition-all duration-200"}),e.jsx("button",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white py-3 px-4 rounded-xl font-medium transition-all duration-200 shadow-lg shadow-blue-500/20 hover:shadow-blue-500/30",onClick:async()=>{var u,$;try{if(($=(u=window.api)==null?void 0:u.dialog)!=null&&$.showOpenDialog){const W=await window.api.dialog.showOpenDialog({properties:["openDirectory"],title:"Seleccionar carpeta de destino global",buttonLabel:"Seleccionar"});!W.canceled&&W.filePaths.length>0&&O(W.filePaths[0])}else await te("Funci√≥n no disponible","La funci√≥n de selecci√≥n de carpetas no est√° disponible.","warning")}catch(W){console.error("Error al seleccionar carpeta:",W),await te("Error","Error al seleccionar la carpeta: "+W.message,"error")}},children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})})]})]}),e.jsx("button",{onClick:()=>{const u={...T};Object.keys(u).forEach($=>{u[$]={...u[$],targetPath:X}}),Y(u)},className:"w-full bg-gray-600/80 hover:bg-gray-500/80 text-white py-2.5 px-4 rounded-xl font-medium transition-all duration-200 border border-gray-500/50",children:"Aplicar destino global a todos los items seleccionados"})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:s.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-500 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("p",{className:"text-lg font-medium text-gray-300",children:"No hay elementos disponibles para descargar"})]}):e.jsx("div",{className:"space-y-4",children:s.map(u=>{const $=f.has(u.id),W=F.has(u.id),w=T[u.id]||{version:"",loader:"",targetPath:"",availableVersions:o.length>0?o:u.minecraftVersions,availableLoaders:p,filteredLoaders:p};return e.jsx("div",{className:`p-5 rounded-xl border transition-all duration-300 ${W?"animate-pulse bg-gradient-to-br from-green-900/60 to-emerald-900/60 border-green-500/80 shadow-lg shadow-green-500/30 transform scale-105":$?"bg-gradient-to-br from-blue-900/40 to-indigo-900/40 border-blue-500/60 shadow-lg shadow-blue-500/10":"bg-gray-700/30 border-gray-600/40 hover:bg-gray-700/40 hover:border-gray-500/50"}`,style:W?{animation:"slideOut 0.6s ease-out forwards"}:{},children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:e.jsx("input",{type:"checkbox",checked:$,onChange:()=>oe(u.id),className:"w-5 h-5 text-blue-600 bg-gray-700 border-gray-600 rounded focus:ring-blue-500 focus:ring-2 cursor-pointer"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[e.jsx("img",{src:u.imageUrl,alt:u.title,className:"w-16 h-16 object-cover rounded-lg border border-gray-600/50 flex-shrink-0",onError:h=>{const j=h.target;j.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iIzFmMjkzNyIvPjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGZpbGw9IiM5Y2EzYWYiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGR5PSIuM2VtIj5NPC90ZXh0Pjwvc3ZnPg=="}}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-white truncate text-lg",children:u.title}),e.jsxs("p",{className:"text-sm text-gray-400 mt-1",children:["por ",u.author]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-xs px-2 py-1 bg-gray-600/40 text-gray-300 rounded-full",children:u.platform}),e.jsx("span",{className:"text-xs px-2 py-1 bg-blue-600/20 text-blue-300 rounded-full capitalize",children:u.type})]})]})]})}),$&&e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-600/40 space-y-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"dropdown-container",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Versi√≥n de Minecraft"}),e.jsxs("span",{className:"text-xs text-gray-400",children:[(w.availableVersions||[]).length," disponibles"]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",className:`w-full bg-gray-700/80 backdrop-blur-sm border border-gray-600 rounded-xl py-2.5 px-4 text-left flex justify-between items-center transition-all duration-200 ${w.version?"text-white border-blue-500/50":"text-gray-400"}`,onClick:()=>{ee(h=>({...h,[u.id]:!h[u.id]})),se(h=>{const j={...h};return Object.keys(j).forEach(L=>{L!==u.id&&(j[L]=!1)}),j})},children:[e.jsx("span",{className:"truncate",children:w.version||"Selecciona una versi√≥n..."}),e.jsx("svg",{className:`w-5 h-5 flex-shrink-0 ml-2 transition-transform duration-200 ${Q[u.id]?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),Q[u.id]&&e.jsx("div",{className:"absolute z-20 w-full mt-2 bg-gray-700/95 backdrop-blur-sm border border-gray-600 rounded-xl shadow-2xl max-h-60 overflow-y-auto",children:(w.availableVersions||[]).length>0?(w.availableVersions||[]).map((h,j)=>e.jsxs("div",{className:`flex items-center px-4 py-3 cursor-pointer hover:bg-gray-600/60 transition-colors duration-150 ${w.version===h?"bg-blue-600/30":""}`,onClick:async()=>{U(u.id,{...w,version:h,loader:""}),ee(L=>({...L,[u.id]:!1})),await P(u.id,h)},children:[e.jsx("span",{className:"mr-3 flex-shrink-0",children:w.version===h?e.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 13l4 4L19 7"})}):e.jsx("div",{className:"w-5 h-5 border-2 border-gray-400 rounded transition-colors duration-150"})}),e.jsx("span",{className:`flex-1 ${w.version===h?"text-white font-medium":"text-gray-300"}`,children:h})]},j)):e.jsx("div",{className:"px-4 py-3 text-gray-400 text-sm",children:"No hay versiones disponibles"})})]})]}),(u.type==="mods"||u.type==="modpacks")&&e.jsxs("div",{className:"dropdown-container",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300",children:"Loader Compatible"}),e.jsx("span",{className:"text-xs text-gray-400",children:Z[u.id]?"Verificando...":`${(w.filteredLoaders||w.availableLoaders||[]).length} disponibles`})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",className:`w-full bg-gray-700/80 backdrop-blur-sm border border-gray-600 rounded-xl py-2.5 px-4 text-left flex justify-between items-center transition-all duration-200 ${w.loader?"text-white border-blue-500/50":"text-gray-400"}`,onClick:()=>{se(h=>({...h,[u.id]:!h[u.id]})),ee(h=>{const j={...h};return Object.keys(j).forEach(L=>{L!==u.id&&(j[L]=!1)}),j})},children:[e.jsx("span",{className:"truncate",children:w.loader?w.loader.charAt(0).toUpperCase()+w.loader.slice(1):"Selecciona un loader..."}),e.jsx("svg",{className:`w-5 h-5 flex-shrink-0 ml-2 transition-transform duration-200 ${q[u.id]?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),q[u.id]&&e.jsx("div",{className:"absolute z-20 w-full mt-2 bg-gray-700/95 backdrop-blur-sm border border-gray-600 rounded-xl shadow-2xl max-h-60 overflow-y-auto",children:Z[u.id]?e.jsx("div",{className:"px-4 py-3 text-gray-400 text-center text-sm",children:"Verificando loaders disponibles..."}):(w.filteredLoaders||w.availableLoaders||[]).length>0?(w.filteredLoaders||w.availableLoaders||[]).map((h,j)=>e.jsxs("div",{className:`flex items-center px-4 py-3 cursor-pointer hover:bg-gray-600/60 transition-colors duration-150 ${w.loader===h?"bg-blue-600/30":""}`,onClick:()=>{U(u.id,{...w,loader:h}),se(L=>({...L,[u.id]:!1}))},children:[e.jsx("span",{className:"mr-3 flex-shrink-0",children:w.loader===h?e.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 13l4 4L19 7"})}):e.jsx("div",{className:"w-5 h-5 border-2 border-gray-400 rounded transition-colors duration-150"})}),e.jsx("span",{className:`flex-1 ${w.loader===h?"text-white font-medium":"text-gray-300"}`,children:h.charAt(0).toUpperCase()+h.slice(1)})]},j)):w.version?e.jsxs("div",{className:"px-4 py-3 text-gray-400 text-sm",children:["No hay loaders disponibles para ",w.version]}):e.jsx("div",{className:"px-4 py-3 text-gray-400 text-sm",children:"Selecciona una versi√≥n primero"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Carpeta de destino"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:w.targetPath||"",onChange:h=>U(u.id,{...w,targetPath:h.target.value}),placeholder:X||"Usar destino global...",className:"flex-1 bg-gray-700/80 backdrop-blur-sm border border-gray-600 rounded-xl py-2.5 px-3 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 transition-all duration-200"}),e.jsx("button",{type:"button",className:"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white py-2.5 px-3 rounded-xl font-medium transition-all duration-200 shadow-lg shadow-blue-500/20 hover:shadow-blue-500/30 flex-shrink-0",onClick:async()=>{var h,j;try{if((j=(h=window.api)==null?void 0:h.dialog)!=null&&j.showOpenDialog){const L=await window.api.dialog.showOpenDialog({properties:["openDirectory"],title:"Seleccionar carpeta de destino",buttonLabel:"Seleccionar"});!L.canceled&&L.filePaths.length>0&&U(u.id,{...w,targetPath:L.filePaths[0]})}}catch(L){console.error("Error al seleccionar carpeta:",L)}},children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})})})]})]})]})})]})]})},u.id)})})}),e.jsx("div",{className:"p-6 border-t border-gray-700/50 bg-gray-800/50",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"text-sm text-gray-400 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),e.jsx("span",{className:"font-medium",children:f.size}),e.jsx("span",{children:"de"}),e.jsx("span",{className:"font-medium",children:s.length}),e.jsx("span",{children:"seleccionados"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:r,className:"px-5 py-2.5 rounded-xl bg-gray-700/80 hover:bg-gray-600/80 text-gray-200 font-medium transition-all duration-200 border border-gray-600/50",children:"Cancelar"}),e.jsxs("button",{onClick:M,disabled:f.size===0,className:"px-5 py-2.5 rounded-xl bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 disabled:from-gray-600 disabled:to-gray-600 disabled:cursor-not-allowed text-white font-medium transition-all duration-200 shadow-lg shadow-green-500/20 hover:shadow-green-500/30 disabled:shadow-none flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Agregar a cola (",f.size,")"]})]})]})})]})})]}):null},Vs=({isVisible:N,onClose:r})=>{const[s,o]=l.useState([]),[p,H]=l.useState(!1),[f,G]=l.useState("sequential");l.useEffect(()=>{if(!N)return;const x=le.subscribe(y=>{o(y)});return()=>{x()}},[N]);const T=x=>{le.removeFromQueue(x)},Y=x=>{le.toggleItemEnabled(x)},Q=async()=>{await be("Limpiar cola","¬øEst√°s seguro de que quieres limpiar los elementos completados y con error de la cola?","warning")&&le.clearCompletedAndErrors()},ee=async()=>{H(!0);const x=le.getEnabledItems(),y=async n=>{try{le.updateItemStatus(n.id,"downloading",0);const E=n.originalId||n.id.split("-")[0],I=n.contentType||"mod";let F=[];try{n.platform==="modrinth"?F=await window.api.modrinth.getCompatibleVersions({projectId:E,mcVersion:n.version,loader:n.loader||void 0}):n.platform==="curseforge"&&(F=await window.api.curseforge.getCompatibleVersions({projectId:E,mcVersion:n.version,loader:n.loader||void 0}))}catch(_){throw new Error(`Error al verificar versiones compatibles: ${_ instanceof Error?_.message:"Error desconocido"}`)}if(F.length===0){const _=n.loader?` y ${n.loader}`:"";throw new Error(`No hay versiones disponibles para ${n.version}${_}. Este contenido no est√° disponible para esta combinaci√≥n de versi√≥n y loader.`)}const D=`multiple-${n.id}-${Date.now()}`,Z=Date.now();ne.addDownloadToHistory({id:D,name:n.name,url:`content://${n.platform}/${E}`,status:"downloading",progress:0,downloadedBytes:0,totalBytes:1e6,startTime:Z,speed:0,path:n.targetPath,profileUsername:void 0}),le.updateItemStatus(n.id,"downloading",10),ne.addDownloadToHistory({id:D,name:n.name,url:`content://${n.platform}/${E}`,status:"downloading",progress:10,downloadedBytes:1e5,totalBytes:1e6,startTime:Z,speed:0,path:n.targetPath,profileUsername:void 0}),await window.api.instances.installContent({instancePath:n.targetPath,contentId:E,contentType:I,mcVersion:n.version,loader:n.loader||void 0,versionId:void 0});for(let _=30;_<100;_+=20)await new Promise(oe=>setTimeout(oe,100)),le.updateItemStatus(n.id,"downloading",_),ne.addDownloadToHistory({id:D,name:n.name,url:`content://${n.platform}/${E}`,status:"downloading",progress:_,downloadedBytes:Math.round(_/100*1e6),totalBytes:1e6,startTime:Z,speed:0,path:n.targetPath,profileUsername:void 0});le.updateItemStatus(n.id,"downloading",100),await new Promise(_=>setTimeout(_,300)),le.updateItemStatus(n.id,"completed",100),ne.addDownloadToHistory({id:D,name:n.name,url:`content://${n.platform}/${E}`,status:"completed",progress:100,downloadedBytes:1e6,totalBytes:1e6,startTime:Z,endTime:Date.now(),speed:0,path:n.targetPath,profileUsername:void 0})}catch(E){console.error(`Error descargando ${n.name}:`,E);const I=E instanceof Error?E.message:"Error desconocido";le.updateItemStatus(n.id,"error",void 0,I)}};if(f==="sequential")for(const n of x)await y(n);else{const n=x.map(E=>y(E));await Promise.all(n)}H(!1)},q=s.filter(x=>x.enabled&&x.status==="pending").length,se=s.some(x=>x.enabled&&x.status==="pending"),X=s.filter(x=>x.status==="completed").length,O=s.filter(x=>x.status==="error").length,g=s.length;return N?e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-[100] flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-gray-800/90 backdrop-blur-xl rounded-2xl border border-gray-700/80 shadow-2xl w-full max-w-4xl max-h-[80vh] flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-gray-700/50",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Cola de Descargas M√∫ltiples"}),e.jsxs("p",{className:"text-gray-400 mt-1",children:[s.length," elementos en la cola | ",X," completados"]})]}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:s.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("h3",{className:"mt-2 text-lg font-medium",children:"No hay descargas en cola"}),e.jsx("p",{className:"mt-1",children:"Agrega elementos desde la vista de contenido para iniciar descargas m√∫ltiples"})]}):e.jsx("div",{className:"space-y-3",children:s.map((x,y)=>e.jsxs("div",{className:`p-4 rounded-xl border transition-all duration-200 ${x.enabled?x.status==="completed"?"bg-gradient-to-r from-green-900/20 to-emerald-900/20 border-green-500/30":x.status==="error"?"bg-gradient-to-r from-red-900/20 to-rose-900/20 border-red-500/30":x.status==="downloading"?"bg-gradient-to-r from-blue-900/20 to-indigo-900/20 border-blue-500/30":"bg-gray-700/30 border-gray-600/30 hover:bg-gray-700/50":"opacity-50 bg-gray-800/30 border-gray-700/30"}`,children:[e.jsxs("div",{className:"flex justify-between items-start gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[e.jsx("button",{onClick:()=>Y(x.id),className:`mt-1 w-5 h-5 rounded border-2 flex items-center justify-center transition-all ${x.enabled?"bg-gradient-to-r from-green-500 to-emerald-500 border-green-400":"bg-gray-600 border-gray-500"}`,title:x.enabled?"Desactivar descarga":"Activar descarga",children:x.enabled&&e.jsx("svg",{className:"w-3 h-3 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:`font-medium truncate ${x.enabled?"text-white":"text-gray-500"}`,children:x.name}),e.jsxs("span",{className:`text-xs px-2 py-1 rounded-full flex-shrink-0 ${x.status==="completed"?"bg-green-500/20 text-green-300":x.status==="error"?"bg-red-500/20 text-red-300":x.status==="downloading"?"bg-blue-500/20 text-blue-300":"bg-gray-500/20 text-gray-300"}`,children:[x.status==="pending"&&"Pendiente",x.status==="downloading"&&"Descargando",x.status==="completed"&&"Completado",x.status==="error"&&"Error"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2 text-xs text-gray-400",children:[e.jsx("span",{className:"bg-gray-600/30 px-2 py-1 rounded",children:x.version}),x.loader&&e.jsx("span",{className:"bg-blue-500/20 text-blue-300 px-2 py-1 rounded",children:x.loader}),e.jsx("span",{className:"bg-purple-500/20 text-purple-300 px-2 py-1 rounded",children:x.platform})]}),x.error&&e.jsxs("div",{className:"mt-2 text-sm text-red-400 bg-red-900/20 p-2 rounded-lg",children:["Error: ",x.error]})]})]}),e.jsx("div",{className:"flex items-center gap-2 flex-shrink-0",children:(x.status==="pending"||x.status==="error")&&e.jsxs("button",{onClick:async()=>{await be("Eliminar de la cola",`¬øEst√°s seguro de que quieres eliminar "${x.name}" de la cola?`,x.status==="error"?"danger":"warning")&&T(x.id)},className:`px-3 py-2 rounded-lg font-medium transition-all duration-200 flex items-center gap-2 ${x.status==="error"?"bg-red-600/80 hover:bg-red-600 text-white":"text-gray-400 hover:text-red-400"}`,title:x.status==="error"?"Eliminar de la cola":"Remover de la cola",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),x.status==="error"&&e.jsx("span",{className:"text-sm",children:"Eliminar"})]})})]}),x.status==="downloading"&&x.progress!==void 0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"w-full bg-gray-600 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-indigo-600 h-2 rounded-full transition-all duration-300 ease-out",style:{width:`${x.progress}%`}})}),e.jsxs("div",{className:"text-right text-xs text-gray-400 mt-1",children:[Math.round(x.progress),"%"]})]})]},`queue-${x.id}-${y}`))})}),e.jsx("div",{className:"p-6 border-t border-gray-700/50 bg-gray-800/50",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Modo de descarga:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>G("sequential"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${f==="sequential"?"bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-sm":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"En Orden"}),e.jsx("button",{onClick:()=>G("parallel"),className:`px-4 py-2 rounded-lg text-sm font-medium transition-all ${f==="parallel"?"bg-gradient-to-r from-purple-600 to-pink-600 text-white shadow-sm":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:"En Paralelo"})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:[X," de ",g," completados | ",q," activos"]}),e.jsxs("div",{className:"flex gap-3",children:[s.length>0&&e.jsx("button",{onClick:Q,className:"px-4 py-2.5 rounded-xl bg-gray-700 hover:bg-gray-600 text-gray-200 font-medium transition-all duration-200",disabled:X===0&&O===0,children:"Limpiar completados"}),e.jsx("button",{onClick:r,className:"px-4 py-2.5 rounded-xl bg-gray-700 hover:bg-gray-600 text-gray-200 font-medium transition-all duration-200",children:"Cerrar"}),e.jsx("button",{onClick:ee,disabled:p||!se,className:"px-4 py-2.5 rounded-xl bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 disabled:from-gray-600 disabled:to-gray-600 text-white font-medium transition-all duration-200 shadow-lg shadow-green-500/20 hover:shadow-green-500/30 disabled:shadow-none",children:p?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2"}),"Descargando..."]}):`Descargar ${q} ${f==="sequential"?"en orden":"en paralelo"}`})]})]})]})})]})}):null},Ps=({isOpen:N,onClose:r})=>{const[s,o]=l.useState([]),[p,H]=l.useState([]),[f,G]=l.useState(""),[T,Y]=l.useState("all"),[Q,ee]=l.useState([]);l.useEffect(()=>{if(!N)return;const n=ne.subscribe(I=>{const F=I.filter(D=>{var U,P;const Z=D.name.toLowerCase(),_=((U=D.url)==null?void 0:U.toLowerCase())||"",oe=((P=D.id)==null?void 0:P.toLowerCase())||"";return oe.startsWith("content-")||oe.startsWith("multiple-")||Z.includes(".jar")&&(Z.includes("mod")||Z.includes("fabric")||Z.includes("forge")||Z.includes("quilt")||Z.includes("neoforge"))||Z.includes("resourcepack")||Z.includes("resource-pack")||Z.includes("texture")||Z.includes("shader")||Z.includes("datapack")||Z.includes("data-pack")||_.includes("/mod/")||_.includes("/resourcepack/")||_.includes("/shader/")||_.includes("/datapack/")||_.includes("modrinth.com")||_.includes("curseforge.com")||_.startsWith("content://")});o(F)}),E=le.subscribe(I=>{ee(I)});return()=>{n(),E()}},[N]),l.useEffect(()=>{let n=[...s];if(T==="completed"?n=n.filter(E=>E.status==="completed"):T==="error"&&(n=n.filter(E=>E.status==="error")),f.trim()){const E=f.toLowerCase();n=n.filter(I=>I.name.toLowerCase().includes(E)||I.path&&I.path.toLowerCase().includes(E))}n.sort((E,I)=>(I.endTime||I.startTime)-(E.endTime||E.startTime)),H(n)},[s,f,T]);const q=n=>{if(n===0)return"0 Bytes";const E=1024,I=["Bytes","KB","MB","GB"],F=Math.floor(Math.log(n)/Math.log(E));return parseFloat((n/Math.pow(E,F)).toFixed(2))+" "+I[F]},se=n=>new Date(n).toLocaleString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),X=n=>{switch(n){case"completed":return"text-green-400 bg-green-500/20 border-green-500/30";case"error":return"text-red-400 bg-red-500/20 border-red-500/30";case"downloading":return"text-blue-400 bg-blue-500/20 border-blue-500/30";case"paused":return"text-yellow-400 bg-yellow-500/20 border-yellow-500/30";default:return"text-gray-400 bg-gray-500/20 border-gray-500/30"}},O=n=>{switch(n){case"completed":return e.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})});case"error":return e.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})});default:return null}},g=async n=>{var E,I;if(n.path)try{(I=(E=window.api)==null?void 0:E.shell)!=null&&I.showItemInFolder?await window.api.shell.showItemInFolder(n.path):await te("Error","No se pudo abrir la carpeta. Ruta: "+n.path,"error")}catch(F){console.error("Error opening folder:",F),await te("Error","Error al abrir la carpeta: "+F.message,"error")}},x=async()=>{await be("Limpiar historial","¬øEst√°s seguro de que quieres limpiar el historial de descargas completadas y con error?","warning")&&ne.clearCompletedAndErrors()},y=async(n,E)=>{await be("Eliminar del historial",`¬øEst√°s seguro de que quieres eliminar "${E}" del historial?`,"danger")&&ne.removeFromHistory(n)};return N?e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-[200] flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-gray-800/95 backdrop-blur-xl rounded-2xl border border-gray-700/80 shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-gray-700/50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[e.jsx("svg",{className:"w-6 h-6 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Historial de Descargas"]}),e.jsxs("p",{className:"text-gray-400 mt-1 text-sm",children:[p.length," descarga",p.length!==1?"s":""," encontrada",p.length!==1?"s":""]})]}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-white transition-colors p-2",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",placeholder:"Buscar descargas...",value:f,onChange:n=>G(n.target.value),className:"block w-full pl-10 pr-3 py-2 bg-gray-700/50 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("select",{value:T,onChange:n=>Y(n.target.value),className:"bg-gray-700/50 border border-gray-600 rounded-xl text-white px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todos"}),e.jsx("option",{value:"completed",children:"Completadas"}),e.jsx("option",{value:"error",children:"Con error"})]}),e.jsx("button",{onClick:x,className:"px-4 py-2 bg-red-600/80 hover:bg-red-600 text-white rounded-xl font-medium transition-all duration-200",children:"Limpiar historial"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:p.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-400",children:[e.jsx("svg",{className:"mx-auto h-16 w-16 text-gray-500 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("p",{className:"text-lg font-medium text-gray-300",children:f||T!=="all"?"No se encontraron descargas":"No hay historial de descargas"}),e.jsx("p",{className:"text-sm mt-2",children:f||T!=="all"?"Intenta con otros filtros":"Las descargas completadas aparecer√°n aqu√≠"})]}):e.jsx("div",{className:"space-y-3",children:p.map(n=>e.jsx("div",{className:`bg-gray-700/40 rounded-xl p-4 border transition-all ${n.status==="completed"?"border-green-500/20 hover:border-green-500/40":n.status==="error"?"border-red-500/20 hover:border-red-500/40":"border-gray-600/30 hover:border-gray-500/50"}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[O(n.status),e.jsx("h4",{className:`font-medium truncate ${n.status==="completed"?"text-green-400":n.status==="error"?"text-red-400":"text-white"}`,children:n.name}),e.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full border ${X(n.status)}`,children:n.status==="completed"?"Completada":n.status==="error"?"Error":n.status==="downloading"?"Descargando":n.status==="paused"?"Pausada":"Pendiente"})]}),e.jsxs("div",{className:"text-sm text-gray-400 space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{children:["Iniciada: ",se(n.startTime)]}),n.endTime&&e.jsxs("span",{children:["Completada: ",se(n.endTime)]})]}),n.path&&e.jsx("div",{className:"text-gray-500 truncate",children:n.path}),e.jsxs("div",{className:"flex items-center gap-4",children:[n.totalBytes>0&&e.jsxs("span",{children:["Tama√±o: ",q(n.totalBytes)]}),n.progress>0&&e.jsxs("span",{children:["Progreso: ",Math.round(n.progress),"%"]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[n.path&&n.status==="completed"&&e.jsxs("button",{onClick:()=>g(n),className:"px-4 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white rounded-xl font-medium transition-all duration-200 flex items-center gap-2",title:"Abrir carpeta",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"})}),"Abrir"]}),n.status==="error"&&e.jsxs("button",{onClick:()=>y(n.id,n.name),className:"px-4 py-2 bg-red-600/80 hover:bg-red-600 text-white rounded-xl font-medium transition-all duration-200 flex items-center gap-2",title:"Eliminar del historial",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Eliminar"]})]})]})},n.id))})})]})}):null},Bs=()=>{const{type:N="modpacks",id:r}=ps(),s=xs(),o=fs(),[p,H]=l.useState(""),[f,G]=l.useState("all"),[T,Y]=l.useState("all"),[Q,ee]=l.useState("popular"),[q,se]=l.useState(""),[X,O]=l.useState(""),[g,x]=l.useState(""),[y,n]=l.useState(""),[E,I]=l.useState([]),[F,D]=l.useState([]),[Z,_]=l.useState(0),[oe,U]=l.useState([]),[P,M]=l.useState(!1),[u,$]=l.useState(""),[W,w]=l.useState([]),[h,j]=l.useState(!0),[L,ie]=l.useState({}),[R,ue]=l.useState({}),[J,Ce]=l.useState(null),[Se,Oe]=l.useState(new Set),[ae,Ee]=l.useState(1),[re,De]=l.useState("modrinth");l.useEffect(()=>{const m=new URLSearchParams(o.search).get("platform");(m==="curseforge"||m==="modrinth")&&De(m)},[o.search]);const[Ae,Es]=l.useState(null),[$e,Ds]=l.useState(null),[Te,We]=l.useState(!1),[Be,Me]=l.useState([]),[Fe,Le]=l.useState([]),he=20;l.useEffect(()=>{const t=async()=>{var k;j(!0);try{if((k=window.api)!=null&&k.instances){const d=await window.api.instances.list();U(d)}let v=[];re==="modrinth"?(console.log(`Buscando ${N} en Modrinth con t√©rmino:`,p),v=await window.api.modrinth.search({contentType:N,search:p}),console.log("Resultados de Modrinth:",v),v=v.map(d=>({...d,platform:"modrinth"}))):re==="curseforge"&&(console.log(`Buscando ${N} en CurseForge con t√©rmino:`,p),v=await window.api.curseforge.search({contentType:N,search:p}),console.log("Resultados de CurseForge:",v),v=v.map(d=>({...d,platform:"curseforge"}))),w(v),Ee(1)}catch(v){console.error("Error al obtener datos:",v),v.message&&v.message.includes("tiempo")?await te("Tiempo de espera agotado","La solicitud ha tardado demasiado. Por favor, verifica tu conexi√≥n e int√©ntalo de nuevo.","warning"):await te("Error de conexi√≥n","No se pudieron cargar los datos. Por favor, verifica tu conexi√≥n e int√©ntalo de nuevo.","error"),w([])}finally{j(!1)}},m=setTimeout(()=>{t()},500);return()=>clearTimeout(m)},[N,p,re]);const[ze,pe]=l.useState([]),[ge,Qe]=l.useState([]),ye=Pe.useRef(new Map),[Je,we]=l.useState(!1),[Ye,je]=l.useState(!1),[Xe,ve]=l.useState(!1),[Ke,Ie]=l.useState(!1),[z,es]=l.useState(null),[ss,Ve]=l.useState(!1),rs=t=>{es(t),we(!0)},ts=async()=>{var t,m,k,v;if(z){we(!1);try{let d=[],S=[];if(re==="modrinth"&&((m=(t=window.api)==null?void 0:t.modrinth)!=null&&m.getCompatibleVersions))try{console.log("Solicitando versiones de Modrinth para:",z.id,"Tipo:",z.type);const c=await window.api.modrinth.getCompatibleVersions({projectId:z.id,mcVersion:z.minecraftVersions[0]||"1.20.1"});if(console.log("Respuesta de Modrinth:",c),c&&Array.isArray(c)){const C=new Set;for(const a of c)if(a.game_versions&&Array.isArray(a.game_versions))for(const i of a.game_versions)typeof i=="string"&&i.startsWith("1.")&&!i.includes("w")&&!i.includes("pre")&&!i.includes("rc")&&!i.includes("snapshot")&&C.add(i);else if(a.game_version&&typeof a.game_version=="string")a.game_version.startsWith("1.")&&!a.game_version.includes("w")&&!a.game_version.includes("pre")&&!a.game_version.includes("rc")&&!a.game_version.includes("snapshot")&&C.add(a.game_version);else if(Array.isArray(a.versions))for(const i of a.versions)typeof i=="string"&&i.startsWith("1.")&&!i.includes("w")&&!i.includes("pre")&&!i.includes("rc")&&!i.includes("snapshot")&&C.add(i);const V=new Set([...C,...z.minecraftVersions]);d=Array.from(V).filter(a=>typeof a=="string"&&a.startsWith("1.")&&!a.includes("w")&&!a.includes("pre")&&!a.includes("rc")&&!a.includes("snapshot")).sort((a,i)=>{const B=a.split(".").map(Number),A=i.split(".").map(Number);for(let K=0;K<Math.min(B.length,A.length);K++)if(B[K]!==A[K])return A[K]-B[K];return A.length-B.length}),console.log("Versiones extra√≠das de Modrinth (antes de ordenar):",Array.from(C)),console.log("Todas las posibles versiones combinadas:",Array.from(V)),console.log("Versiones filtradas finales:",d);const b=new Set;for(const a of c)if(a.loaders&&Array.isArray(a.loaders))for(const i of a.loaders)typeof i=="string"&&(z.type==="modpacks"||z.type==="mods"?["forge","fabric","quilt","neoforge"].includes(i)&&b.add(i):b.add(i));else a.loader&&typeof a.loader=="string"&&(z.type==="modpacks"||z.type==="mods"?["forge","fabric","quilt","neoforge"].includes(a.loader)&&b.add(a.loader):b.add(a.loader));S=Array.from(b),console.log("Loaders extra√≠dos de Modrinth:",S)}}catch(c){console.error("Error obteniendo datos de Modrinth:",c)}else if(re==="curseforge"&&((v=(k=window.api)==null?void 0:k.curseforge)!=null&&v.getCompatibleVersions))try{console.log("Solicitando versiones de CurseForge para:",z.id,"Tipo:",z.type);const c=await window.api.curseforge.getCompatibleVersions({projectId:z.id,mcVersion:z.minecraftVersions[0]||"1.20.1"});if(console.log("Respuesta de CurseForge:",c),c&&Array.isArray(c)){const C=new Set;for(const a of c)if(a.game_versions&&Array.isArray(a.game_versions))for(const i of a.game_versions)typeof i=="string"&&i.startsWith("1.")&&!i.includes("w")&&!i.includes("pre")&&!i.includes("rc")&&!i.includes("snapshot")&&C.add(i);else if(a.gameVersion&&typeof a.gameVersion=="string")a.gameVersion.startsWith("1.")&&!a.gameVersion.includes("w")&&!a.gameVersion.includes("pre")&&!a.gameVersion.includes("rc")&&!a.gameVersion.includes("snapshot")&&C.add(a.gameVersion);else if(Array.isArray(a.versions))for(const i of a.versions)typeof i=="string"&&i.startsWith("1.")&&!i.includes("w")&&!i.includes("pre")&&!i.includes("rc")&&!i.includes("snapshot")&&C.add(i);const V=new Set([...C,...z.minecraftVersions]);d=Array.from(V).filter(a=>typeof a=="string"&&a.startsWith("1.")&&!a.includes("w")&&!a.includes("pre")&&!a.includes("rc")&&!a.includes("snapshot")).sort((a,i)=>{const B=a.split(".").map(Number),A=i.split(".").map(Number);for(let K=0;K<Math.min(B.length,A.length);K++)if(B[K]!==A[K])return A[K]-B[K];return A.length-B.length}),console.log("Versiones extra√≠das de CurseForge (antes de ordenar):",Array.from(C)),console.log("Todas las posibles versiones combinadas:",Array.from(V)),console.log("Versiones filtradas finales:",d);const b=new Set;for(const a of c)if(a.loaders&&Array.isArray(a.loaders))for(const i of a.loaders)typeof i=="string"&&(z.type==="modpacks"||z.type==="mods"?["forge","fabric","quilt","neoforge"].includes(i)&&b.add(i):b.add(i));else if(a.loader&&typeof a.loader=="string")z.type==="modpacks"||z.type==="mods"?["forge","fabric","quilt","neoforge"].includes(a.loader)&&b.add(a.loader):b.add(a.loader);else if(a.modLoader&&typeof a.modLoader=="string"){const i=a.modLoader.toLowerCase();z.type==="modpacks"||z.type==="mods"?["forge","fabric","quilt","neoforge"].includes(i)&&b.add(i):b.add(i)}S=Array.from(b),console.log("Loaders extra√≠dos de CurseForge:",S)}}catch(c){console.error("Error obteniendo datos de CurseForge:",c)}d.length===0&&(d=z.minecraftVersions.filter(c=>c.startsWith("1.")&&!c.includes("w")&&!c.includes("pre")&&!c.includes("rc")&&!c.includes("snapshot")).sort((c,C)=>{const[V,b,a]=c.split(".").slice(1).map(Number),[i,B,A]=C.split(".").slice(1).map(Number);return V!==i?i-V:b!==B?B-b:(A||0)-(a||0)})),S.length===0&&(S=z.type==="modpacks"||z.type==="mods"?["forge","fabric","quilt","neoforge"]:[]),Me(d),Le(S),console.log("Datos cargados para el modal:",{versions:d,loaders:S}),je(!0)}catch(d){console.error("Error general en handleSingleDownload:",d),Me(z.minecraftVersions.filter(S=>S.startsWith("1."))||[]),Le(["forge","fabric","quilt","neoforge"]),je(!0)}}},as=async()=>{var t,m,k,v;if(z){we(!1);try{let d=[],S=[];if(re==="modrinth"&&((m=(t=window.api)==null?void 0:t.modrinth)!=null&&m.getCompatibleVersions))try{const c=await window.api.modrinth.getCompatibleVersions({projectId:z.id,mcVersion:z.minecraftVersions[0]||"1.20.1"});if(c&&Array.isArray(c)){const C=new Set;for(const a of c)if(a.game_versions&&Array.isArray(a.game_versions))for(const i of a.game_versions)typeof i=="string"&&i.startsWith("1.")&&!i.includes("w")&&!i.includes("pre")&&!i.includes("rc")&&!i.includes("snapshot")&&C.add(i);else if(a.game_version&&typeof a.game_version=="string")a.game_version.startsWith("1.")&&!a.game_version.includes("w")&&!a.game_version.includes("pre")&&!a.game_version.includes("rc")&&!a.game_version.includes("snapshot")&&C.add(a.game_version);else if(Array.isArray(a.versions))for(const i of a.versions)typeof i=="string"&&i.startsWith("1.")&&!i.includes("w")&&!i.includes("pre")&&!i.includes("rc")&&!i.includes("snapshot")&&C.add(i);const V=new Set([...C,...z.minecraftVersions]);d=Array.from(V).filter(a=>typeof a=="string"&&a.startsWith("1.")&&!a.includes("w")&&!a.includes("pre")&&!a.includes("rc")&&!a.includes("snapshot")).sort((a,i)=>{const B=a.split(".").map(Number),A=i.split(".").map(Number);for(let K=0;K<Math.min(B.length,A.length);K++)if(B[K]!==A[K])return A[K]-B[K];return A.length-B.length});const b=new Set;for(const a of c)if(a.loaders&&Array.isArray(a.loaders))for(const i of a.loaders)typeof i=="string"&&(z.type==="modpacks"||z.type==="mods"?["forge","fabric","quilt","neoforge"].includes(i)&&b.add(i):b.add(i));else a.loader&&typeof a.loader=="string"&&(z.type==="modpacks"||z.type==="mods"?["forge","fabric","quilt","neoforge"].includes(a.loader)&&b.add(a.loader):b.add(a.loader));S=Array.from(b)}}catch(c){console.error("Error obteniendo datos de Modrinth para download m√∫ltiple:",c)}else if(re==="curseforge"&&((v=(k=window.api)==null?void 0:k.curseforge)!=null&&v.getCompatibleVersions))try{const c=await window.api.curseforge.getCompatibleVersions({projectId:z.id,mcVersion:z.minecraftVersions[0]||"1.20.1"});if(c&&Array.isArray(c)){const C=Ge(c),V=new Set([...C.gameVersions,...z.minecraftVersions]);d=Array.from(V).filter(b=>typeof b=="string"&&b.startsWith("1.")&&!b.includes("w")&&!b.includes("pre")&&!b.includes("rc")&&!b.includes("snapshot")).sort((b,a)=>{const i=b.split(".").map(Number),B=a.split(".").map(Number);for(let A=0;A<Math.min(i.length,B.length);A++)if(i[A]!==B[A])return B[A]-i[A];return B.length-i.length}),z.type==="modpacks"||z.type==="mods"?S=C.modLoaders.filter(b=>["forge","fabric","quilt","neoforge"].includes(b)):S=C.modLoaders}}catch(c){console.error("Error obteniendo datos de CurseForge para download m√∫ltiple:",c)}d.length===0&&(d=z.minecraftVersions.filter(c=>c.startsWith("1.")&&!c.includes("w")&&!c.includes("pre")&&!c.includes("rc")&&!c.includes("snapshot")).sort((c,C)=>{const[V,b,a]=c.split(".").slice(1).map(Number),[i,B,A]=C.split(".").slice(1).map(Number);return V!==i?i-V:b!==B?B-b:(A||0)-(a||0)})),S.length===0&&(S=z.type==="modpacks"||z.type==="mods"?["forge","fabric","quilt","neoforge"]:[]),Me(d),Le(S),console.log("Datos cargados para el modal m√∫ltiple:",{versions:d,loaders:S}),ve(!0)}catch(d){console.error("Error general en handleMultipleDownload:",d),ve(!0)}}},os=async t=>{var k;const m=W.find(v=>v.id===t.id);if(!m){console.error("No se encontr√≥ el √≠tem para descargar:",t.id);return}if(console.log("Iniciando descarga individual con:",t),t.targetPath)if(oe.some(v=>v.path===t.targetPath)){const v=(k=oe.find(d=>d.path===t.targetPath))==null?void 0:k.id;se(v||"")}else se("custom"),$(t.targetPath);else se("");await cs(m,t.version,t.loader,t.targetPath),je(!1)},ns=t=>{console.log("Agregando a cola m√∫ltiple:",t),bs(async()=>{const{multipleDownloadQueueService:m}=await Promise.resolve().then(()=>Ns);return{multipleDownloadQueueService:m}},void 0).then(({multipleDownloadQueueService:m})=>{m.addToQueue(t)}),ve(!1),Ie(!0)};l.useEffect(()=>{Qe(W),pe(W)},[W,N,re]),l.useEffect(()=>{(async()=>{if(ye.current.clear(),!X&&f==="all"){pe([...ge]);return}if(ge.length>0&&(N==="modpacks"||N==="mods")){j(!0);try{const m=f!=="all"?f:null,k=ge.map(async S=>{var c;try{const C=`${S.id}-${S.platform}-${m||"any"}-${X||"any"}`;if(ye.current.has(C))return ye.current.get(C)?S:null;let V=[];const b=m||((c=S.minecraftVersions)==null?void 0:c[0])||"1.20.1";S.platform==="modrinth"?V=await ke.getCompatibleVersions({projectId:S.id,mcVersion:b,loader:X||void 0}):S.platform==="curseforge"&&(V=await window.api.curseforge.getCompatibleVersions({projectId:S.id,mcVersion:b,loader:X||void 0}));const a=V.length>0;return ye.current.set(C,a),a?S:null}catch(C){return console.error(`Error checking compatibility for item ${S.id}:`,C),null}}),d=(await Promise.all(k)).filter(S=>S!==null);pe(d)}catch(m){console.error("Error en verificaci√≥n de compatibilidad:",m),pe([...ge])}finally{j(!1)}}else if(f!=="all"){const m=ge.filter(k=>{var v;return(v=k.minecraftVersions)==null?void 0:v.includes(f)});pe(m)}else pe([...ge])})()},[X,f,re,ge,N]);const me=Pe.useMemo(()=>{let t=[...ze];if(T!=="all"&&(t=t.filter(m=>m.categories&&m.categories.includes(T))),p.trim()){const m=p.toLowerCase();t=t.filter(k=>{var v,d;return k.title.toLowerCase().includes(m)||((v=k.description)==null?void 0:v.toLowerCase().includes(m))||((d=k.author)==null?void 0:d.toLowerCase().includes(m))})}return t.sort((m,k)=>{switch(Q){case"popular":return(k.downloads||0)-(m.downloads||0);case"recent":return new Date(k.lastUpdated||0).getTime()-new Date(m.lastUpdated||0).getTime();case"name":return m.title.localeCompare(k.title);default:return 0}}),t},[ze,T,Q,p]),is=Pe.useMemo(()=>{const t=(ae-1)*he,m=t+he;return me.slice(t,m)},[me,ae,he]),de=Math.ceil(me.length/he),Ne=t=>{t>=1&&t<=de&&(Ee(t),window.scrollTo({top:0,behavior:"smooth"}))},He=()=>{ae<de&&Ne(ae+1)},_e=()=>{ae>1&&Ne(ae-1)};l.useEffect(()=>{const t=new AbortController;return(async()=>{if(r){let k=W.find(v=>v.id===r);if(k){const v={...k};if(k.platform==="curseforge")try{const d=parseInt(k.id,10);if(!isNaN(d)){const S=(V,b)=>Promise.race([V,new Promise((a,i)=>setTimeout(()=>i(new Error("Request timeout")),b))]),c=S(fe.getMod(d),1e4),C=S(fe.getModFiles(d),1e4);try{const V=await c,b=await C,a=new Set;b.forEach(B=>{B.gameVersions&&Array.isArray(B.gameVersions)&&B.gameVersions.forEach(A=>a.add(A))});const i=Array.from(a);v.minecraftVersions=i,v.description=V.summary||V.description||k.description}catch(V){console.error("CurseForge request timed out or failed:",V)}}}catch(d){console.error("Error processing CurseForge item:",d)}else if(k.platform==="modrinth")try{const d=k.id,S=(c,C)=>Promise.race([c,new Promise((V,b)=>setTimeout(()=>b(new Error("Request timeout")),C))]);try{const c=await S(ke.getProject(d),1e4);v.description=c.description||c.body||k.description}catch(c){console.error("Modrinth request timed out or failed:",c)}}catch(d){console.error("Error processing Modrinth item:",d)}Ce(v),await Ze(v)}else Ce(null),D([]),I([])}else Ce(null),D([]),I([])})(),()=>{t.abort()}},[r,W]);const Ze=async t=>{try{if(re==="modrinth"&&window.api.modrinth.getCompatibleVersions){let m=[],k=[];m=[...new Set(t.minecraftVersions)];try{const v=await window.api.modrinth.getCompatibleVersions({projectId:t.id,mcVersion:t.minecraftVersions[0]||"1.20.1"}),d=new Set;v.forEach(c=>{c.game_versions&&c.game_versions.forEach(C=>d.add(C))}),m=Array.from(new Set([...m,...d])).filter(c=>{const C=/^1\.\d{1,2}(\.\d{1,2})?$/.test(c),V=!c.includes("pre"),b=!c.includes("rc"),a=!c.includes("snapshot"),i=!c.includes("w"),B=!c.includes("infinite"),A=!c.includes("-");return C&&V&&b&&a&&i&&B&&A}).sort((c,C)=>{const[V,b,a]=c.split(".").map(Number),[i,B,A]=C.split(".").map(Number);return V!==i?i-V:b!==B?B-b:(A||0)-(a||0)});const S=new Set;v.forEach(c=>{c.loaders&&c.loaders.forEach(C=>S.add(C))}),k=Array.from(S)}catch(v){console.error("Error obteniendo versiones compatibles de Modrinth:",v),m=t.minecraftVersions.filter(d=>{const S=/^1\.\d{1,2}(\.\d{1,2})?$/.test(d),c=!d.includes("pre"),C=!d.includes("rc"),V=!d.includes("snapshot"),b=!d.includes("w"),a=!d.includes("infinite"),i=!d.includes("-");return S&&c&&C&&V&&b&&a&&i}).sort((d,S)=>{const[c,C,V]=d.split(".").map(Number),[b,a,i]=S.split(".").map(Number);return c!==b?b-c:C!==a?a-C:(i||0)-(V||0)}),k=["forge","fabric","quilt","neoforge"]}D(m),I(k)}else if(re==="curseforge"&&window.api.curseforge.getCompatibleVersions){let m=[],k=[];m=[...new Set(t.minecraftVersions)],console.log("DEBUG - CurseForge: Iniciando carga de compatibilidad para item:",t),console.log("DEBUG - CurseForge: projectId:",t.id),console.log("DEBUG - CurseForge: mcVersions disponibles:",t.minecraftVersions),(!t.minecraftVersions||t.minecraftVersions.length===0)&&(console.log("DEBUG - CurseForge: No hay versiones en el item original, usando versiones comunes como fallback"),m=["1.21.1","1.21","1.20.6","1.20.5","1.20.4","1.20.3","1.20.2","1.20.1","1.19.4","1.19.3","1.19.2","1.18.2","1.17.1","1.16.5","1.15.2","1.14.4","1.13.2","1.12.2","1.11.2","1.10.2","1.9.4","1.8.9"]);try{console.log("DEBUG - CurseForge: Intentando llamar a la API para compatibilidad...");const v=t.minecraftVersions&&t.minecraftVersions.length>0?t.minecraftVersions[0]:"1.20.1";console.log("DEBUG - CurseForge: Llamando API con projectId:",t.id,"y mcVersion:",v);const d=await window.api.curseforge.getCompatibleVersions({projectId:t.id,mcVersion:v});if(console.log("DEBUG - CurseForge: Respuesta de la API:",d),d&&Array.isArray(d)&&d.length>0){console.log("DEBUG - CurseForge: Procesando",d.length,"elementos de la respuesta");const S=Ge(d);console.log("DEBUG - CurseForge: Informaci√≥n procesada:",S),m=S.gameVersions.filter(c=>{const C=/^1\.\d{1,2}(\.\d{1,2})?$/.test(c),V=!c.includes("pre"),b=!c.includes("rc"),a=!c.includes("snapshot"),i=!c.includes("w"),B=!c.includes("infinite"),A=!c.includes("-");return C&&V&&b&&a&&i&&B&&A}).sort((c,C)=>{const[V,b,a]=c.split(".").map(Number),[i,B,A]=C.split(".").map(Number);return V!==i?i-V:b!==B?B-b:(A||0)-(a||0)}),k=S.modLoaders,console.log("DEBUG - CurseForge: Versiones finales (filtradas):",m),console.log("DEBUG - CurseForge: Loaders finales:",k)}else console.log("DEBUG - CurseForge: No se recibieron datos compatibles, usando info del item original"),m=t.minecraftVersions.filter(S=>{const c=/^1\.\d{1,2}(\.\d{1,2})?$/.test(S),C=!S.includes("pre"),V=!S.includes("rc"),b=!S.includes("snapshot"),a=!S.includes("w"),i=!S.includes("infinite"),B=!S.includes("-");return c&&C&&V&&b&&a&&i&&B}).sort((S,c)=>{const[C,V,b]=S.split(".").map(Number),[a,i,B]=c.split(".").map(Number);return C!==a?a-C:V!==i?i-V:(B||0)-(b||0)}),t.type==="modpacks"||t.type==="mods"?k=["forge","fabric","quilt","neoforge"]:k=[]}catch(v){console.error("ERROR - CurseForge: Error obteniendo compatibilidad de CurseForge, usando datos del item:",v),console.error("ERROR - CurseForge: Detalles del error:",v instanceof Error?v.message:"Error desconocido"),m=t.minecraftVersions.filter(d=>{const S=/^1\.\d{1,2}(\.\d{1,2})?$/.test(d),c=!d.includes("pre"),C=!d.includes("rc"),V=!d.includes("snapshot"),b=!d.includes("w"),a=!d.includes("infinite"),i=!d.includes("-");return S&&c&&C&&V&&b&&a&&i}).sort((d,S)=>{const[c,C,V]=d.split(".").map(Number),[b,a,i]=S.split(".").map(Number);return c!==b?b-c:C!==a?a-C:(i||0)-(V||0)}),t.type==="modpacks"||t.type==="mods"?k=["forge","fabric","quilt","neoforge"]:k=[]}D(m),I(k)}else{const m=t.minecraftVersions.filter(v=>{const d=/^1\.\d{1,2}(\.\d{1,2})?$/.test(v),S=!v.includes("pre"),c=!v.includes("rc"),C=!v.includes("snapshot"),V=!v.includes("w"),b=!v.includes("infinite"),a=!v.includes("-");return d&&S&&c&&C&&V&&b&&a}).sort((v,d)=>{const[S,c,C]=v.split(".").map(Number),[V,b,a]=d.split(".").map(Number);return S!==V?V-S:c!==b?b-c:(a||0)-(C||0)});D(m);let k=[];(t.type==="modpacks"||t.type==="mods")&&(k=["forge","fabric","quilt","neoforge"]),I(k)}}catch(m){console.error("Error al cargar versiones y loaders compatibles:",m);const k=t.minecraftVersions.filter(d=>{const S=/^1\.\d{1,2}(\.\d{1,2})?$/.test(d),c=!d.includes("pre"),C=!d.includes("rc"),V=!d.includes("snapshot"),b=!d.includes("w"),a=!d.includes("infinite"),i=!d.includes("-");return S&&c&&C&&V&&b&&a&&i}).sort((d,S)=>{const[c,C,V]=d.split(".").map(Number),[b,a,i]=S.split(".").map(Number);return c!==b?b-c:C!==a?a-C:(i||0)-(V||0)});D(k);let v=[];(t.type==="modpacks"||t.type==="mods")&&(v=["forge","fabric","quilt","neoforge"]),I(v)}};l.useEffect(()=>{q&&J&&Se.has(`${q}-${J.id}`)},[q,J,Se]),l.useEffect(()=>{J&&Ze(J)},[J,re]);const ls=t=>{const m=W.find(k=>k.id===t);m&&s(`/contenido/${N}/${m.id}`)},ds=()=>{s(`/contenido/${N}`)},cs=async(t,m,k,v)=>{ie(d=>({...d,[t.id]:!0})),_(0);try{let d;switch(t.type){case"resourcepacks":d="resourcepack";break;case"shaders":d="shader";break;case"datapacks":d="datapack";break;case"modpacks":d="modpack";break;default:d="mod"}const S=v&&v.trim()!=="";if(!q&&!S){if(!await be("Sin instancia seleccionada",`No has seleccionado una instancia.
¬øQuieres descargar "${t.title}" directamente a la zona de descargas?

Cancela para seleccionar una instancia en su lugar.`,"info")){await te("Informaci√≥n","Por favor, selecciona una instancia para instalar el contenido.","info");return}let C=[];if(re==="modrinth"?C=await window.api.modrinth.getCompatibleVersions({projectId:t.id,mcVersion:m||t.minecraftVersions[0]||"1.20.1",loader:k}):re==="curseforge"&&(C=await window.api.curseforge.getCompatibleVersions({projectId:t.id,mcVersion:m||t.minecraftVersions[0]||"1.20.1",loader:k})),C.length===0){alert("No se encontraron versiones compatibles para descargar");return}const V=C[0];let b=null;if(re==="modrinth"?b=V.files.find(a=>a.primary)||V.files[0]:re==="curseforge"&&(b=V.files?V.files[0]:null),!b){await te("Sin archivos","No se encontraron archivos para descargar","warning");return}ne.downloadFile(b.url||b.downloadUrl,b.filename||b.fileName,t.title),await te("Descarga iniciada",`${t.title} se est√° descargando en la zona de descargas.`,"success")}else{if(S){if(!m||m==="all"||m===""){await te("Campo requerido","Por favor, selecciona una versi√≥n de Minecraft.","warning");return}if((d==="mod"||d==="modpack")&&!k){await te("Campo requerido","Por favor, selecciona un loader compatible.","warning");return}let A=[];if(re==="modrinth"&&window.api.modrinth.getCompatibleVersions?A=await window.api.modrinth.getCompatibleVersions({projectId:t.id,mcVersion:m,loader:k||void 0}):re==="curseforge"&&window.api.curseforge.getCompatibleVersions&&(A=await window.api.curseforge.getCompatibleVersions({projectId:t.id,mcVersion:m,loader:k||void 0})),A.length===0){await te("Versi√≥n no compatible",`No se encontr√≥ una versi√≥n compatible para ${m} y ${k||"cualquier loader"}. Por favor selecciona combinaciones diferentes.`,"warning");return}}else{if(q&&q!=="custom"&&J&&Se.has(`${q}-${J.id}`)){await te("Ya instalado",`El contenido "${t.title}" ya est√° instalado en la instancia seleccionada.`,"info");return}if(!m||m==="all"||m===""){await te("Campo requerido","Por favor, selecciona una versi√≥n de Minecraft.","warning");return}if((d==="mod"||d==="modpack")&&!k){await te("Campo requerido","Por favor, selecciona un loader compatible.","warning");return}let A=[];if(re==="modrinth"&&window.api.modrinth.getCompatibleVersions?A=await window.api.modrinth.getCompatibleVersions({projectId:t.id,mcVersion:m,loader:k||void 0}):re==="curseforge"&&window.api.curseforge.getCompatibleVersions&&(A=await window.api.curseforge.getCompatibleVersions({projectId:t.id,mcVersion:m,loader:k||void 0})),A.length===0){await te("Versi√≥n no compatible",`No se encontr√≥ una versi√≥n compatible para ${m} y ${k||"cualquier loader"}. Por favor selecciona combinaciones diferentes.`,"warning");return}if(d==="modpack"){let K=!1;if(re==="modrinth"?K=A.some(xe=>xe.game_versions.includes(m)&&(!k||xe.loaders.includes(k))):re==="curseforge"&&(K=A.length>0),!K){await te("Versi√≥n no compatible",`El modpack no tiene una versi√≥n compatible para ${m} y ${k||"cualquier loader"}. Por favor selecciona combinaciones diferentes.`,"warning");return}}}let c="";if(S)c=v;else if(q==="custom")if(u)c=u;else{alert("Por favor, selecciona una carpeta personalizada.");return}else{const A=oe.find(K=>K.id===q);A&&(c=A.path)}if(!c&&!S){alert("No se pudo encontrar la instancia seleccionada.");return}const C=m&&m!=="all"&&m!==""?m:t.minecraftVersions[0]||"1.20.1",b=(d==="mod"||d==="modpack")&&k?k:void 0,a=`content-${t.id}-${Date.now()}`,i=Date.now();ne.addDownloadToHistory({id:a,name:t.title,url:`content://${t.platform}/${t.id}`,status:"downloading",progress:0,downloadedBytes:0,totalBytes:1e6,startTime:i,speed:0,path:c,profileUsername:void 0});const B=setInterval(()=>{_(A=>{const K=A>=95?95:A+1,xe=ne.getAllDownloads().find(hs=>hs.id===a);return xe&&ne.addDownloadToHistory({...xe,progress:K,downloadedBytes:Math.round(K/100*(xe.totalBytes||1e6))}),K})},200);try{await window.api.instances.installContent({instancePath:c,contentId:t.id,contentType:d,mcVersion:C,loader:b,versionId:void 0}),q!=="custom"&&Oe(A=>new Set(A).add(`${q}-${t.id}`)),_(100),clearInterval(B),ne.addDownloadToHistory({id:a,name:t.title,url:`content://${t.platform}/${t.id}`,status:"completed",progress:100,downloadedBytes:1e6,totalBytes:1e6,startTime:i,endTime:Date.now(),speed:0,path:c,profileUsername:void 0}),await new Promise(A=>setTimeout(A,300)),await te("¬°Contenido instalado!",`${t.title} ha sido instalado en la ubicaci√≥n seleccionada.`,"success")}catch(A){throw clearInterval(B),_(0),ne.addDownloadToHistory({id:a,name:t.title,url:`content://${t.platform}/${t.id}`,status:"error",progress:0,downloadedBytes:0,totalBytes:0,startTime:i,endTime:Date.now(),speed:0,path:c,profileUsername:void 0}),A}}}catch(d){console.error("Error al manejar el contenido:",d),await te("Error",d instanceof Error?d.message:"Error desconocido","error")}finally{ie(d=>({...d,[t.id]:!1})),_(0)}};[...Array.from(new Set(W.flatMap(t=>t.minecraftVersions)))],[...Array.from(new Set(W.flatMap(t=>t.categories)))];const us=`
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    ::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }
    ::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.2);
      border-radius: 4px;
      transition: all 0.2s ease;
    }
    ::-webkit-scrollbar-thumb:hover {
      background: rgba(255, 255, 255, 0.3);
    }
  `;return l.useEffect(()=>{const t=ne.subscribe(m=>{setTimeout(()=>{const k={},v={};m.forEach(d=>{k[d.id]=d.progress,(d.status==="downloading"||d.status==="pending")&&(v[d.id]=!0)}),ue(k),ie(v)},0)});return()=>{t()}},[]),h?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsx("style",{dangerouslySetInnerHTML:{__html:us}}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-900/30 to-purple-900/30 rounded-2xl -z-10 blur-xl opacity-50"}),e.jsx("div",{className:"flex flex-wrap gap-2 overflow-x-auto pb-2",children:["modpacks","mods","resourcepacks","datapacks","shaders"].map(t=>e.jsxs("button",{onClick:()=>s(`/contenido/${t}`),className:`px-5 py-2.5 rounded-xl font-medium transition-all duration-300 whitespace-nowrap relative overflow-hidden group ${N===t?"bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-lg shadow-blue-500/30":"bg-gray-800/70 text-gray-300 hover:bg-gray-700/80 hover:text-white"}`,children:[e.jsx("span",{className:"relative z-10",children:t.charAt(0).toUpperCase()+t.slice(1).replace("packs"," Packs").replace("mods","Mods")}),e.jsx("span",{className:`absolute inset-0 bg-gradient-to-r from-blue-500/20 to-purple-500/20 transition-opacity duration-300 ${N===t?"opacity-100":"opacity-0 group-hover:opacity-100"}`})]},t))})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[!J&&e.jsx("div",{className:"lg:w-72 flex-shrink-0",children:e.jsxs("div",{className:"bg-gray-800/50 backdrop-blur-sm rounded-2xl p-5 border border-gray-700/50 shadow-lg",children:[e.jsxs("div",{className:"flex flex-col items-center gap-3 mb-6 overflow-x-auto pb-2 relative",children:[["modrinth","curseforge"].map(t=>e.jsx("button",{onClick:()=>De(t),className:`flex items-center px-4 py-2 rounded-xl font-medium transition-all duration-300 relative overflow-hidden group w-full ${re===t?"bg-gradient-to-r from-blue-600 to-purple-600 text-white shadow-lg shadow-blue-500/30":"bg-gray-800/70 text-gray-300 hover:bg-gray-700/80 hover:text-white"}`,children:e.jsxs("span",{className:"flex items-center justify-center relative z-10 w-full",children:[e.jsx("img",{src:t==="modrinth"?"https://cdn.modrinth.com/static/logo-cubeonly.5f38e9dd.png":"https://www.curseforge.com/themes/custom/cf/images/logos/curseforge.svg",alt:t==="modrinth"?"Modrinth":"CurseForge",className:"w-5 h-5 mr-2",onError:m=>{const k=m.target;k.onerror=null,t==="modrinth"?k.src="https://modrinth.com/favicon.ico":k.src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/21/CurseForge_Logo.svg/640px-CurseForge_Logo.svg.png"}}),t==="modrinth"?"Modrinth":"CurseForge"]})},t)),e.jsx("div",{className:"absolute top-0 right-0",children:e.jsx(Ss,{content:`Gu√≠a de instalaci√≥n:

1. Selecciona una plataforma (Modrinth o CurseForge)
2. Elige el tipo de contenido
3. Usa los filtros para encontrar lo que necesitas
4. Haz clic en "Detalles" para ver informaci√≥n adicional
5. Haz clic en "Descargar" para iniciar el proceso
6. En la ventana modal, selecciona la versi√≥n y destino
7. Confirma la descarga`,position:"left",children:e.jsx("button",{className:"text-gray-400 hover:text-white p-1 rounded-full bg-gray-700/50",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})})})]}),e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"})}),"Filtros"]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Buscar"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("input",{type:"text",placeholder:"Buscar contenido...",value:p,onChange:t=>H(t.target.value),className:"block w-full pl-10 pr-3 py-2.5 bg-gray-700/50 border border-gray-600 rounded-xl text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Versi√≥n de Minecraft"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:f,onChange:t=>G(t.target.value),className:"appearance-none w-full bg-gray-700/50 border border-gray-600 rounded-xl text-white pl-3 pr-8 py-2.5 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",children:[e.jsx("option",{value:"all",children:"Todas las versiones"}),e.jsx("option",{value:"1.21.10",children:"1.21.10"}),e.jsx("option",{value:"1.21.9",children:"1.21.9"}),e.jsx("option",{value:"1.21.8",children:"1.21.8"}),e.jsx("option",{value:"1.21.7",children:"1.21.7"}),e.jsx("option",{value:"1.21.6",children:"1.21.6"}),e.jsx("option",{value:"1.21.5",children:"1.21.5"}),e.jsx("option",{value:"1.21.4",children:"1.21.4"}),e.jsx("option",{value:"1.21.3",children:"1.21.3"}),e.jsx("option",{value:"1.21.2",children:"1.21.2"}),e.jsx("option",{value:"1.21.1",children:"1.21.1"}),e.jsx("option",{value:"1.21",children:"1.21"}),e.jsx("option",{value:"1.20.6",children:"1.20.6"}),e.jsx("option",{value:"1.20.5",children:"1.20.5"}),e.jsx("option",{value:"1.20.4",children:"1.20.4"}),e.jsx("option",{value:"1.20.3",children:"1.20.3"}),e.jsx("option",{value:"1.20.2",children:"1.20.2"}),e.jsx("option",{value:"1.20.1",children:"1.20.1"}),e.jsx("option",{value:"1.19.4",children:"1.19.4"}),e.jsx("option",{value:"1.19.3",children:"1.19.3"}),e.jsx("option",{value:"1.19.2",children:"1.19.2"}),e.jsx("option",{value:"1.18.2",children:"1.18.2"}),e.jsx("option",{value:"1.17.1",children:"1.17.1"}),e.jsx("option",{value:"1.16.5",children:"1.16.5"}),e.jsx("option",{value:"1.15.2",children:"1.15.2"}),e.jsx("option",{value:"1.14.4",children:"1.14.4"}),e.jsx("option",{value:"1.13.2",children:"1.13.2"}),e.jsx("option",{value:"1.12.2",children:"1.12.2"}),e.jsx("option",{value:"1.11.2",children:"1.11.2"}),e.jsx("option",{value:"1.10.2",children:"1.10.2"}),e.jsx("option",{value:"1.9.4",children:"1.9.4"}),e.jsx("option",{value:"1.8.9",children:"1.8.9"})]}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 20 20",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),N==="modpacks"||N==="mods"?e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Loader"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:X,onChange:t=>O(t.target.value),className:"appearance-none w-full bg-gray-700/50 border border-gray-600 rounded-xl text-white pl-3 pr-8 py-2.5 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",children:[e.jsx("option",{value:"",children:"Todos los loaders"}),e.jsx("option",{value:"forge",children:"Forge"}),e.jsx("option",{value:"fabric",children:"Fabric"}),e.jsx("option",{value:"quilt",children:"Quilt"}),e.jsx("option",{value:"neoforge",children:"NeoForge"})]}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 20 20",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}):null,e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Ordenar por"}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:Q,onChange:t=>ee(t.target.value),className:"appearance-none w-full bg-gray-700/50 border border-gray-600 rounded-xl text-white pl-3 pr-8 py-2.5 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",children:[e.jsx("option",{value:"popular",children:"M√°s populares"}),e.jsx("option",{value:"recent",children:"M√°s recientes"}),e.jsx("option",{value:"name",children:"Por nombre (A-Z)"})]}),e.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 20 20",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]})]})}),e.jsxs("div",{className:"flex-1 relative",children:[e.jsxs("div",{className:"absolute top-0 right-0 z-10 flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Ve(!0),className:"relative w-12 h-12 rounded-full bg-gradient-to-r from-purple-600 to-pink-600 shadow-lg flex items-center justify-center hover:from-purple-700 hover:to-pink-700 transition-all duration-300 group",title:"Historial de Descargas",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("button",{onClick:()=>Ie(!0),className:"relative w-12 h-12 rounded-full bg-gradient-to-r from-green-600 to-emerald-600 shadow-lg flex items-center justify-center hover:from-green-700 hover:to-emerald-700 transition-all duration-300 group",title:"Iniciar Descargas M√∫ltiples",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})}),e.jsx(ks,{position:"top-right",onShowHistory:()=>Ve(!0)})]}),J?e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 mt-16",children:[e.jsxs("button",{onClick:ds,className:"mb-4 flex items-center text-blue-400 hover:text-blue-300 transition-colors",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Volver a la lista"]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl overflow-hidden border border-gray-700/50 shadow-2xl",children:e.jsxs("div",{className:"md:flex",children:[e.jsx("div",{className:"md:w-1/3",children:e.jsx("img",{src:J.imageUrl,alt:J.title,className:"w-full h-64 md:h-full object-cover",loading:"lazy",onError:t=>{const m=t.target;m.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAwIiBoZWlnaHQ9IjQwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjMWYyOTM3Ii8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIyNCIgZmlsbD0iIzljYTNhZiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPk1pbmVjcmFmdDwvdGV4dD48L3N2Zz4="}})}),e.jsxs("div",{className:"md:w-2/3 p-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:J.title}),e.jsxs("p",{className:"text-blue-400 mb-4",children:["por ",J.author]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[J.categories.slice(0,5).map((t,m)=>e.jsx("span",{className:"bg-blue-500/20 text-blue-300 text-sm px-3 py-1 rounded-full",children:t},`${t}-${m}-${J.id}`)),J.categories.length>5&&e.jsxs("span",{className:"bg-gray-600/30 text-gray-400 text-sm px-3 py-1 rounded-full",children:["+",J.categories.length-5]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Versi√≥n"}),e.jsx("p",{className:"text-white font-medium",children:J.version})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Actualizado"}),e.jsx("p",{className:"text-white font-medium",children:new Date(J.lastUpdated).toLocaleDateString("es-ES")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Descargas"}),e.jsx("p",{className:"text-white font-medium",children:J.downloads.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400",children:"Plataforma"}),e.jsx("p",{className:"text-purple-400 font-medium capitalize",children:J.platform})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-300 mb-2",children:"Loaders Compatibles"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:E.slice(0,6).map((t,m)=>e.jsx("span",{className:`px-3 py-1.5 rounded-full text-sm ${J.platform==="modrinth"?"bg-indigo-500/20 text-indigo-300 border border-indigo-500/30":"bg-emerald-500/20 text-emerald-300 border border-emerald-500/30"}`,children:t.charAt(0).toUpperCase()+t.slice(1)},`${t}-${m}`))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-300 mb-2",children:"Versiones de Minecraft"}),e.jsx("div",{className:"flex flex-wrap gap-2 max-h-20 overflow-y-auto",children:J.minecraftVersions.slice(0,10).map((t,m)=>e.jsx("span",{className:"bg-gray-700/40 text-gray-300 px-2 py-1 rounded-lg text-sm border border-gray-600/30",children:t},m))})]})]})]})]})}),e.jsx("div",{className:"mt-6",children:e.jsx(Cs,{selectedContent:J})})]})]}):e.jsx("div",{className:"w-full mt-16",children:me.length===0?e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-8 text-center",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("h3",{className:"mt-2 text-lg font-medium text-white",children:"No se encontraron resultados"}),e.jsx("p",{className:"mt-1 text-gray-400",children:"Intenta con otros filtros o t√©rminos de b√∫squeda."}),e.jsx("button",{onClick:()=>{H(""),G("all"),Y("all")},className:"mt-4 text-blue-400 hover:text-blue-300 text-sm font-medium",children:"Limpiar filtros"})]}):e.jsxs("div",{className:"w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4 gap-2",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Mostrando ",(ae-1)*he+1,"-",Math.min(ae*he,me.length)," de ",me.length," resultados"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:_e,disabled:ae===1,className:`px-3 py-1.5 rounded-lg ${ae===1?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-gray-700 hover:bg-gray-600 text-white"}`,children:"Anterior"}),e.jsx("div",{className:"flex gap-1",children:de<=7?Array.from({length:de},(t,m)=>m+1).map(t=>e.jsx("button",{onClick:()=>Ne(t),className:`w-10 h-10 rounded-full ${ae===t?"bg-blue-600 text-white":"bg-gray-700 hover:bg-gray-600 text-white"}`,children:t},t)):(()=>{const t=[],m=Math.max(1,ae-2),k=Math.min(de,ae+2);m>1&&(t.push(1),m>2&&t.push(-1));for(let v=m;v<=k;v++)t.push(v);return k<de&&(k<de-1&&t.push(-1),t.push(de)),t.map((v,d)=>v===-1?e.jsx("span",{className:"w-10 h-10 flex items-center justify-center text-white",children:"..."},`dots-${d}`):e.jsx("button",{onClick:()=>Ne(v),className:`w-10 h-10 rounded-full ${ae===v?"bg-blue-600 text-white":"bg-gray-700 hover:bg-gray-600 text-white"}`,children:v},v))})()}),e.jsx("button",{onClick:He,disabled:ae===de,className:`px-3 py-1.5 rounded-lg ${ae===de?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-gray-700 hover:bg-gray-600 text-white"}`,children:"Siguiente"})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:is.map(t=>e.jsx(ys,{id:t.id,title:t.title,description:t.description,author:t.author,downloads:t.downloads,lastUpdated:t.lastUpdated,imageUrl:t.imageUrl,type:t.type,platform:t.platform,onDownload:()=>rs(t),onDetails:ls,isDownloading:L[t.id],downloadProgress:R[t.id]},t.id))}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mt-4 gap-2",children:[e.jsxs("div",{className:"text-sm text-gray-400",children:["Mostrando ",(ae-1)*he+1,"-",Math.min(ae*he,me.length)," de ",me.length," resultados"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:_e,disabled:ae===1,className:`px-3 py-1.5 rounded-lg ${ae===1?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-gray-700 hover:bg-gray-600 text-white"}`,children:"Anterior"}),e.jsx("button",{onClick:He,disabled:ae===de,className:`px-3 py-1.5 rounded-lg ${ae===de?"bg-gray-700 text-gray-500 cursor-not-allowed":"bg-gray-700 hover:bg-gray-600 text-white"}`,children:"Siguiente"})]})]})]})})]})]}),e.jsx(Ms,{isOpen:Je,onClose:()=>we(!1),onSingleDownload:ts,onMultipleDownload:as}),z&&e.jsx(Ls,{isOpen:Ye,onClose:()=>je(!1),contentItem:z,availableVersions:Be,availableLoaders:Fe,onDownloadStart:os}),z&&e.jsx(Is,{isOpen:Xe,onClose:()=>ve(!1),contentItems:[z],availableVersions:Be,availableLoaders:Fe,onAddToQueue:ns}),e.jsx(Vs,{isVisible:Ke,onClose:()=>Ie(!1)}),Ae&&e.jsx(ws,{isOpen:Te,onClose:()=>We(!1),project:Ae,onDownloadComplete:()=>console.log("Download completed")}),$e&&e.jsx(js,{isOpen:Te,onClose:()=>We(!1),mod:$e,onDownloadComplete:()=>console.log("Download completed")}),e.jsx(Ps,{isOpen:ss,onClose:()=>Ve(!1)})]})};export{Bs as default};
