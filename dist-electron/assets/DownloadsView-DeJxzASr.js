import{r as n,j as e}from"./index-DgCEkpSk.js";import{C as B}from"./Card-DzRJb4Ll.js";import{B as E}from"./Button-B4xMDwMH.js";import{i as c}from"./integratedDownloadService-Den5n4pl.js";const z=()=>{const[m,j]=n.useState([]),[u,p]=n.useState([]),[v,f]=n.useState([]),[o,D]=n.useState(""),[d,h]=n.useState("active"),[x,N]=n.useState(null),[g,w]=n.useState(null);n.useEffect(()=>{$();const t=setInterval(async()=>{try{const a=(await c.getDownloadStatuses()).filter(l=>l.status==="in-progress"||l.status==="pending");j(a);const i=await c.getOverallProgress();N(i);const b=await c.getLogStats();w(b)}catch(s){console.error("Error updating progress:",s)}},1e3),r=setInterval(async()=>{try{const s=await c.getRecentLogs(50);f(s);const a=s.filter(i=>i.type==="download"||i.type==="install"||i.type==="success");p(a)}catch(s){console.error("Error updating logs:",s)}},2e3);return()=>{clearInterval(t),clearInterval(r)}},[]);const $=async()=>{try{const r=(await c.getDownloadStatuses()).filter(l=>l.status==="in-progress"||l.status==="pending");j(r);const s=await c.getOverallProgress();N(s);const a=await c.getRecentLogs(50);f(a);const i=await c.getLogStats();w(i);const b=a.filter(l=>l.type==="download"||l.type==="install"||l.type==="success");p(b)}catch(t){console.error("Error loading initial data:",t)}},C=v.filter(t=>t.message.toLowerCase().includes(o.toLowerCase())||t.target&&t.target.toLowerCase().includes(o.toLowerCase())),L=u.filter(t=>t.message.toLowerCase().includes(o.toLowerCase())||t.target&&t.target.toLowerCase().includes(o.toLowerCase())),k=()=>{p([])},T=t=>{if(t===0)return"0 B/s";const r=1024,s=["B/s","KB/s","MB/s","GB/s"],a=Math.floor(Math.log(t)/Math.log(r));return parseFloat((t/Math.pow(r,a)).toFixed(2))+" "+s[a]},M=t=>{if(!t||t<=0)return"";const r=Math.floor(t/1e3);if(r<60)return`${r}s`;const s=Math.floor(r/60);return s<60?`${s}m`:`${Math.floor(s/60)}h ${s%60}m`},R=t=>{switch(t){case"completed":return"text-green-500";case"error":return"text-red-500";case"in-progress":return"text-blue-500";case"pending":return"text-yellow-500";case"cancelled":return"text-gray-500";default:return"text-gray-500"}},y=t=>{switch(t){case"success":return"text-green-500";case"error":return"text-red-500";case"warning":return"text-yellow-500";case"info":return"text-blue-500";case"progress":return"text-purple-500";case"download":return"text-cyan-500";case"install":return"text-emerald-500";case"launch":return"text-orange-500";default:return"text-gray-500"}},S=t=>{switch(t){case"success":return"âœ…";case"error":return"âŒ";case"warning":return"âš ï¸";case"info":return"â„¹ï¸";case"progress":return"ðŸ”„";case"download":return"ðŸ“¥";case"install":return"âš™ï¸";case"launch":return"ðŸš€";default:return"ðŸ“„"}};return e.jsx("div",{className:"space-y-6",children:e.jsxs(B,{children:[e.jsxs("div",{className:"flex flex-col gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-200 flex items-center gap-2",children:["Progreso y Descargas",e.jsxs("span",{className:"text-xs font-semibold text-gray-400 bg-gray-800/80 px-2 py-0.5 rounded-full",children:[m.length," activas Â· ",u.length," completadas"]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Seguimiento en tiempo real de todas las operaciones"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"text",placeholder:"Buscar en registros...",value:o,onChange:t=>D(t.target.value),className:"px-4 py-2 rounded-lg bg-gray-800/80 text-white border border-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"}),e.jsx(E,{variant:"secondary",onClick:k,disabled:u.length===0,children:"Limpiar historial"})]})]}),x&&e.jsxs("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-gray-700/50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-300",children:"Progreso general:"}),e.jsxs("span",{className:"text-sm font-semibold text-blue-400",children:[Math.round(x.progress*100),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-3",children:e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 h-3 rounded-full transition-all duration-300 ease-out",style:{width:`${x.progress*100}%`}})}),e.jsxs("div",{className:"mt-2 text-xs text-gray-400 flex justify-between",children:[e.jsx("span",{children:x.statusText}),e.jsxs("span",{children:[x.activeOperations," operaciones activas"]})]})]}),g&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"bg-gray-800/40 p-3 rounded-lg border border-gray-700/50 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-blue-400",children:g.totalLogs}),e.jsx("div",{className:"text-xs text-gray-400",children:"Registros"})]}),e.jsxs("div",{className:"bg-gray-800/40 p-3 rounded-lg border border-gray-700/50 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-purple-400",children:g.activeDownloads}),e.jsx("div",{className:"text-xs text-gray-400",children:"Descargas activas"})]}),e.jsxs("div",{className:"bg-gray-800/40 p-3 rounded-lg border border-gray-700/50 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-emerald-400",children:g.recentLogs}),e.jsx("div",{className:"text-xs text-gray-400",children:"Recientes"})]}),e.jsxs("div",{className:"bg-gray-800/40 p-3 rounded-lg border border-gray-700/50 text-center",children:[e.jsx("div",{className:"text-lg font-bold text-amber-400",children:g.totalProgressUpdates}),e.jsx("div",{className:"text-xs text-gray-400",children:"Actualizaciones"})]})]}),e.jsxs("div",{className:"inline-flex items-center bg-gray-900/80 border border-gray-700/70 rounded-2xl p-1 text-xs text-gray-300 self-start",children:[e.jsx("button",{onClick:()=>h("active"),className:`px-3 py-1 rounded-xl transition-all ${d==="active"?"bg-gradient-to-r from-blue-500 to-indigo-600 text-black shadow-sm":"text-gray-400 hover:text-gray-200"}`,children:"Activas"}),e.jsx("button",{onClick:()=>h("completed"),className:`ml-1 px-3 py-1 rounded-xl transition-all ${d==="completed"?"bg-gradient-to-r from-emerald-500 to-teal-600 text-black shadow-sm":"text-gray-400 hover:text-gray-200"}`,children:"Completadas"}),e.jsx("button",{onClick:()=>h("logs"),className:`ml-1 px-3 py-1 rounded-xl transition-all ${d==="logs"?"bg-gradient-to-r from-purple-500 to-pink-600 text-black shadow-sm":"text-gray-400 hover:text-gray-200"}`,children:"Registros"})]})]}),d==="active"&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-200 mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“¥"})," Descargas Activas",e.jsx("span",{className:"ml-2 text-sm text-gray-400 bg-gray-700/50 py-0.5 px-2 rounded-full",children:m.length})]}),m.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500 bg-gray-800/30 rounded-xl border border-dashed border-gray-700/50",children:"No hay descargas activas en este momento"}):e.jsx("div",{className:"space-y-4",children:m.map(t=>e.jsxs("div",{className:"p-4 bg-gray-800/60 backdrop-blur-sm rounded-xl border border-gray-700/50 transition-all duration-300",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium text-gray-100 truncate",children:t.target||t.operation}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${R(t.status)} bg-opacity-20`,children:t.status})]}),t.details&&e.jsx("div",{className:"text-sm text-gray-400 mt-1 truncate",children:t.details})]}),e.jsx("div",{className:"text-right text-sm text-gray-400 whitespace-nowrap ml-4",children:t.speed&&T(t.speed)})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-3",children:e.jsx("div",{className:`h-3 rounded-full ${t.status==="completed"?"bg-green-500":t.status==="error"?"bg-red-500":t.status==="pending"?"bg-yellow-500":"bg-gradient-to-r from-blue-500 to-indigo-600"}`,style:{width:`${t.progress*100}%`}})}),e.jsxs("div",{className:"text-right text-xs text-gray-400 mt-1",children:[Math.round(t.progress*100),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center text-xs text-gray-500",children:[e.jsxs("div",{children:[t.current," / ",t.total," - ",t.operation]}),e.jsx("div",{className:"flex gap-2",children:t.estimatedTimeRemaining&&e.jsxs("span",{className:"text-gray-400",children:["Quedan: ",M(t.estimatedTimeRemaining)]})})]})]},t.id))})]}),d==="completed"&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-200 mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"âœ…"})," Tareas Completadas",e.jsx("span",{className:"ml-2 text-sm text-gray-400 bg-gray-700/50 py-0.5 px-2 rounded-full",children:u.length})]}),L.length===0?e.jsx("div",{className:"text-center py-10 text-gray-500 border border-dashed border-gray-700/70 rounded-2xl bg-gray-900/40",children:"No hay tareas completadas todavÃ­a."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:L.map(t=>e.jsxs("div",{className:"p-4 bg-gray-800/60 backdrop-blur-sm rounded-2xl border border-gray-700/70 shadow-sm flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("div",{className:"min-w-0",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-lg",children:S(t.type)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-100 truncate",title:t.message,children:t.message}),t.target&&e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["Objetivo: ",t.target]})]})]})}),e.jsx("span",{className:`inline-flex items-center justify-center w-6 h-6 rounded-full ${y(t.type)}/20 ${y(t.type)} text-xs`,children:"âœ“"})]}),e.jsx("div",{className:"flex items-center justify-between text-xs text-gray-500",children:e.jsx("span",{children:new Date(t.timestamp).toLocaleString()})})]},t.id))})]}),d==="logs"&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-200 mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸ“‹"})," Registros de Actividad",e.jsx("span",{className:"ml-2 text-sm text-gray-400 bg-gray-700/50 py-0.5 px-2 rounded-full",children:v.length})]}),C.length===0?e.jsx("div",{className:"text-center py-10 text-gray-500 border border-dashed border-gray-700/70 rounded-2xl bg-gray-900/40",children:"No hay registros de actividad todavÃ­a."}):e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:C.map(t=>e.jsx("div",{className:`p-3 rounded-lg border-l-4 ${t.type==="error"?"border-red-500 bg-red-900/20":t.type==="success"?"border-green-500 bg-green-900/20":t.type==="warning"?"border-yellow-500 bg-yellow-900/20":t.type==="info"?"border-blue-500 bg-blue-900/20":t.type==="progress"?"border-purple-500 bg-purple-900/20":t.type==="download"?"border-cyan-500 bg-cyan-900/20":t.type==="install"?"border-emerald-500 bg-emerald-900/20":t.type==="launch"?"border-orange-500 bg-orange-900/20":"border-gray-500 bg-gray-900/20"}`,children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("span",{className:"mr-3 text-lg",children:S(t.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:`font-medium ${y(t.type)}`,children:t.message}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(t.timestamp).toLocaleTimeString()})]}),t.target&&e.jsx("div",{className:"text-sm text-gray-400 mt-1",children:t.target}),t.details&&e.jsx("div",{className:"text-xs text-gray-500 mt-1 bg-black/20 p-2 rounded",children:e.jsx("pre",{className:"whitespace-pre-wrap break-words",children:JSON.stringify(t.details,null,2)})})]})]})},t.id))})]})]})})};export{z as default};
