class v{async getMinecraftVersions(){var e,o;if(!((o=(e=window.api)==null?void 0:e.versions)!=null&&o.list))throw new Error("API de versiones no disponible");return await window.api.versions.list()}async createInstance(e){var o,n;if(!((n=(o=window.api)==null?void 0:o.instance)!=null&&n.createFull))throw new Error("API de creación de instancias no disponible");return await window.api.instance.createFull(e)}async getRecentLogs(e=50){var o;if(!window.api)throw new Error("API de Electron no disponible");return await((o=window.api.logs)==null?void 0:o.getRecent(e))||[]}async getLogsByType(e,o=50){var n;if(!window.api)throw new Error("API de Electron no disponible");return await((n=window.api.logs)==null?void 0:n.getByType({type:e,count:o}))||[]}async getLogStats(){var e;if(!window.api)throw new Error("API de Electron no disponible");return await((e=window.api.logs)==null?void 0:e.getStats())||{}}async getAllProgressStatuses(){var e;if(!window.api)throw new Error("API de Electron no disponible");return await((e=window.api.progress)==null?void 0:e.getAllStatuses())||[]}async getOverallProgress(){var e;if(!window.api)throw new Error("API de Electron no disponible");return await((e=window.api.progress)==null?void 0:e.getOverall())||{progress:0,statusText:"No disponible",activeOperations:0}}async getDownloadStatuses(){var e;if(!window.api)throw new Error("API de Electron no disponible");return await((e=window.api.progress)==null?void 0:e.getDownloadStatuses())||[]}async getJavaInstallations(){var e,o;return(e=window.api)!=null&&e.java?await((o=window.api.java)==null?void 0:o.getAll())||[]:[]}async detectJava(){var e,o;return(e=window.api)!=null&&e.java?await((o=window.api.java)==null?void 0:o.detect())||[]:[]}async getRecommendedJavaForVersion(e){return"17"}async getFabricVersions(e){try{const o=await fetch(`https://meta.fabricmc.net/v2/versions/loader/${e}`);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){return console.error("Error al obtener versiones de Fabric:",o),[]}}async getForgeVersions(e){try{console.log(`[Forge] Obteniendo versiones para Minecraft ${e}`);const o=["https://maven.minecraftforge.net/net/minecraftforge/forge/maven-metadata.xml","https://files.minecraftforge.net/net/minecraftforge/forge/maven-metadata.xml"];let n=null,a=null;for(const t of o)try{console.log(`[Forge] Intentando URL: ${t}`);const r=await fetch(t,{headers:{"User-Agent":"DRK-Launcher/1.0"}});if(!r.ok){console.warn(`[Forge] URL ${t} devolvió ${r.status}`);continue}if((r.headers.get("content-type")||"").includes("xml")||t.includes(".xml")){const i=await r.text(),d=new DOMParser().parseFromString(i,"text/xml").getElementsByTagName("version"),p=[];for(let f=0;f<d.length;f++){const u=d[f].textContent;u&&p.push(u)}n={versioning:{versions:p}},console.log(`[Forge] Datos XML recibidos, ${p.length} versiones encontradas`);break}else{n=await r.json(),console.log("[Forge] Datos JSON recibidos:",n);break}}catch(r){console.warn(`[Forge] Error al obtener desde ${t}:`,r.message),a=r;continue}if(!n){console.log("[Forge] Intentando API alternativa de Forge (promociones)...");try{const t=await fetch("https://files.minecraftforge.net/net/minecraftforge/forge/promotions_slim.json",{headers:{"User-Agent":"DRK-Launcher/1.0"}});if(t.ok){const r=await t.json();console.log("[Forge] Datos de promociones recibidos:",r);const s=[];if(r.promos)for(const i in r.promos)i.startsWith(`${e}-`)&&s.push(i);n={versioning:{versions:s}},console.log(`[Forge] ${s.length} versiones extraídas de promociones`)}}catch(t){console.error("[Forge] Error al obtener promociones:",t)}}if(!n||!n.versioning||!n.versioning.versions||!Array.isArray(n.versioning.versions)){if(console.error("[Forge] No se pudieron obtener versiones de ninguna fuente"),a)throw a;return[]}const l=n.versioning.versions.filter(t=>t&&typeof t=="string"&&t.startsWith(`${e}-`));if(console.log(`[Forge] Versiones compatibles encontradas: ${l.length}`,l),l.length===0)return console.warn(`[Forge] No se encontraron versiones compatibles para Minecraft ${e}`),[];const g=l.sort((t,r)=>{const s=t.split("-")[1]||"";return(r.split("-")[1]||"").localeCompare(s,void 0,{numeric:!0,sensitivity:"base"})}).map(t=>({version:t,mcversion:e,type:"release"}));return console.log("[Forge] Versiones procesadas:",g),g}catch(o){return console.error("[Forge] Error al obtener versiones de Forge:",o),[]}}async getQuiltVersions(e){try{const o=await fetch(`https://meta.quiltmc.org/v3/versions/loader/${e}`);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){return console.error("Error al obtener versiones de Quilt:",o),[]}}async getNeoForgeVersions(e){try{console.log(`[NeoForge] Obteniendo versiones para Minecraft ${e}`);const o=await fetch("https://maven.neoforged.net/api/maven/versions/releases/net/neoforged/neoforge",{headers:{"User-Agent":"DRK-Launcher/1.0"}});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const n=await o.json();console.log("[NeoForge] Datos recibidos:",n);let a=[];if(Array.isArray(n))a=n;else if(n&&n.versions&&Array.isArray(n.versions))a=n.versions,console.log(`[NeoForge] Versiones extraídas del objeto: ${a.length}`);else return console.error("[NeoForge] Estructura de datos inválida:",n),[];if(a.length>0){const r=a.slice(0,5).map(s=>typeof s=="string"?s:s.version||s.id||String(s));console.log("[NeoForge] Ejemplos de versiones (primeras 5):",r)}const l=a.filter(r=>{let s="";if(typeof r=="string"?s=r:r&&r.version?s=r.version:r&&typeof r=="object"&&(s=r.version||r.id||""),!s)return!1;if(s.startsWith(`${e}-`))return!0;const i=e.split(".");if(i.length>=2){const c=`${i[0]}.${i[1]}`;if(s.startsWith(`${c}.`)||s.startsWith(`${e}-`))return!0}if(i.length>=3){const c=`${i[1]}.${i[2]}`;if(s.startsWith(c))return!0}return!1});if(console.log(`[NeoForge] Versiones compatibles encontradas: ${l.length}`,l),l.length===0)return console.warn(`[NeoForge] No se encontraron versiones compatibles para Minecraft ${e}`),[];const t=l.map(r=>typeof r=="string"?{version:r}:r&&!r.version?{version:r.id||r.name||String(r)}:r).sort((r,s)=>{const i=r.version||"",c=s.version||"",w=i.split("-")[1]||"";return(c.split("-")[1]||"").localeCompare(w,void 0,{numeric:!0,sensitivity:"base"})}).map(r=>({version:r.version||"",mcversion:e,type:r.type||"release"}));return console.log("[NeoForge] Versiones procesadas:",t),t}catch(o){return console.error("[NeoForge] Error al obtener versiones de NeoForge:",o),[]}}}const y=new v;export{y as i};
